<%@page import="com.dogma.EnvParameters"%><%@page import="biz.statum.apia.web.bean.BasicBeanStatic"%><%@page import="com.dogma.UserData"%><%@page import="com.dogma.Parameters"%><% UserData usrData = BasicBeanStatic.getUserDataStatic(request); %><script type="text/javascript">
	var DEFAULT_DOC_TYPE_ID 			= '<system:edit show="constant" from="com.dogma.vo.DocTypeVo" field="DEFAULT_DOC_TYPE_ID"/>';
	var MSG_METADATA_TITLE_UNIQUE 		= '<system:label show="text" label="msgDocMetaUniq" forScript="true" />';
	var MSG_NO_UP_DOC_TYPE_DIS 			= '<system:label show="text" label="msgNoUpDocTypeDis" forScript="true" />';
	var MSG_NO_EXI_DOC_TYPE_ENA_AND_PER = '<system:label show="text" label="msgNoExiDocTypeEnaAndPer" forScript="true" />';
	var PRIMARY_SEPARATOR				= new Element('div').set('html', '<system:edit show="constant" from="com.st.util.StringUtil" field="PRIMARY_SEPARATOR"/>').get('text');
	var AUXILIAR_SEPARATOR				= new Element('div').set('html', '<system:edit show="constant" from="com.st.util.StringUtil" field="AUXILIAR_SEPARATOR"/>').get('text');
	var DOCUMENT_EVERYONE_PERMISSION	= "<system:edit show="constant" from="com.dogma.Parameters" field="DOCUMENT_EVERYONE_PERMISSION"/>";
	var DOCUMENT_OWNER_PRIVILEGES		= "<system:edit show="constant" from="com.dogma.Parameters" field="DOCUMENT_OWNER_PRIVILEGES"/>";
	var GLOBAL_PARAM_ALLOW_MON_DOCUMENT	= toBoolean("<system:edit show="constant" from="com.dogma.Parameters" field="DOCUMENT_ALLW_SEL_DOC_FRM_DOC_MON"/>");
	var GLOBAL_PARAM_ALLOW_FLD_STRC_DOC	= toBoolean("<system:edit show="constant" from="com.dogma.Parameters" field="DOCUMENT_ALLW_SEL_DOC_FRM_FLD_STRCT"/>");
	var GLOBAL_PARAM_ALLOW_FLD_STRC_VW	= toBoolean("<system:edit show="constant" from="com.dogma.Parameters" field="DOCUMENT_ALLOW_FLD_STRCT_VIEW"/>");
	var ENV_PARAM_ALLOW_MON_DOCUMENT	= <%= EnvParameters.getEnvParameter(usrData.getEnvironmentId(), EnvParameters.ENV_ALLOW_DOC_MONITOR) %>;
	var ENV_PARAM_DOC_MON_ID			= <%= EnvParameters.getEnvParameter(usrData.getEnvironmentId(), EnvParameters.ENV_SEL_DOC_IN_SYSTEM) %>;
	var ENV_PARAM_ALLOW_FLD_STRC_DOC	= <%= EnvParameters.getEnvParameter(usrData.getEnvironmentId(), EnvParameters.ENV_ALLOW_FLD_STR_DOC_SEL) %>;
	var ENV_PARAM_ALLOW_FLD_STRC_VW		= <%= EnvParameters.getEnvParameter(usrData.getEnvironmentId(), EnvParameters.ENV_ALLOW_FLD_STR_VIEW) %>;

	var LBL_ACCEPTED_DC_TYPE			= '<system:label show="text" label="lblAccepDocType" forScript="true" />';
	var LBL_NOT_ACCEP_DC_TYPE			= '<system:label show="text" label="lblNotAccpDocType" forScript="true" />';
	var MSG_ALL_DC_TYPE_ACCEPTED		= '<system:label show="text" label="lblAllDcTypeAcc" forScript="true" />';
	var MSG_NO_ARE_FORBIDDEN_DC_TYPES	= '<system:label show="text" label="lblNotExDcTyNotAllw" forScript="true" />';
	var LBL_MAX_SIZE					= '<system:label show="text" label="lblMaxSize" forScript="true" />';
	var SEL_ONLY_ONE_DOC				= '<system:label show="text" label="msgSelOnlyOne" forScript="true" />';
	var LBL_DROP_FILE_ERR				= '<system:label show="text" label="msgDropFileErr" forScript="true" />';
	var MSG_LAST_MOD_DATE 				= '<system:label show="text" label="lblFecUltMod" forScript="true" forHtml="true"/>';
	var MSG_NO_SELECT_FOLDER			= '<system:label show="text" label="lblUnSelDir" forScript="true" forHtml="true"/>';
	var LBL_DROP_FILE_DELETED			= '<system:label show="text" label="msgDropFileDel" forScript="true" />';
	var LBL_DROP_FILE_REPEATED			= '<system:label show="text" label="msgDropFileRep" forScript="true" />';
	var LBL_DROP_FILE_NAMES_NOT_MATCH	= '<system:label show="text" label="msgDocDiffFilename" forScript="true" />';
	
	var NEW_TAB_ID 						= new Date().getTime();
	var NEW_TOKEN_ID 					= "<system:util show='tokenIdRequest'/>";
	var CURRENT_USR_ID 					= '<system:util show="currentLogin"/>';
	var CURRENT_USR_NAME				= '<system:util show="currentLoginName"/>';
	var USE_CURRENT_USR_PERMS			= <%= Parameters.DOCUMENT_OWNER_PRIVILEGES %>;
	
	
</script><script type="text/javascript" src="<system:util show="context" />/page/includes/droppedDocuments.js"></script><system:edit show="ifModalNotLoaded" field="documents.jsp"><system:edit show="markModalAsLoaded" field="documents.jsp" /><div id="mdlDocumentContainer" class="mdlContainer hiddenModal documentMdl" tabIndex="0"><div class="mdlHeader"><system:label show="text" label="titDoc" /></div><iframe title="uploadIframe" style="display:none;" id="documentIframeUpload" name="documentIframeUpload"></iframe><form id="frmModalDocumentUpload" target="documentIframeUpload" enctype="multipart/form-data" method="post"><button type="submit" aria-label="submit" id="btnDocumentSubmitIfr" style="display: none;"></button><div class="mdlBody"><div class="leftSectDocMdl" id="leftSectDocMdl"><table aria-label="<system:label show="tooltip" label="titDoc" /> modal left" style="width:99%;"><!--   title="<system:label show="text" label="titDoc" />">--><thead><tr><th id="mdlDocsTableCol1"></th><th id="mdlDocsTableCol2"></th><th id="mdlDocsTableCol3"></th></tr></thead><tbody id="leftBodyTable"><tr><td headers="mdlDocsTableCol1" class="text" style="width: 30%;"><label for="cmbDocType"><system:label show="text" label="lblDocType" />:&nbsp;</label></td><td headers="mdlDocsTableCol2" class="content" colspan="2"><select title="<system:label show="text" label="lblDocType" />" id="cmbDocType" name="cmbDocType" style="width: 90% !important;" class="validate['required']"></select><div class="imgInfoDocType" id="mdlInfoDocType"></div><span id="spanDocType" style="display: none;"></span></td></tr><!-- nuevo documento --><tr class="btnSelDocToHide"><td headers="mdlDocsTableCol1" class="text"><label for="documentModalDocFile"><system:label show="text" label="lblDoc" />:</label></td><td headers="mdlDocsTableCol2" class="content fileMdlContainer" style="width: 37%;padding: 0px !important;height: 0px;vertical-align: middle;"><div class="modalOptionsContainer" id="mdlDocumentAddNewDc"><span class="option optionAdd mdlDocOption" tabIndex="0"><system:label show="text" label="lblSelNewDoc"/></span></div><input type="file" name="docFile" id="documentModalDocFile" title="<system:label show="text" label="lblNueDoc" />" class="validate['required']"></td><!-- drag and drop --><td headers="mdlDocsTableCol3" class="content" rowspan="3"><div class="modalOptionsContainer"><span class="option optionAdd dropIcon"  id="mdlDropArea" tabIndex="0" style="width:89%; text-align: center; display: none; height: 54px;"></span></div></td></tr><!-- default document monitor --><tr class="btnSelDocToHide" style="display: none"><td headers="mdlDocsTableCol1" class="text"></td><td headers="mdlDocsTableCol2"><div class="modalOptionsContainer" id="btnOpenMonDoc"><span class="option optionAdd mdlDocOption" tabIndex="0"><system:label show="text" label="btnMonDoc" /></span></div></td></tr><!-- custom document monitor --><tr class="btnSelDocToHide" style="display: none"><td headers="mdlDocsTableCol1" class="text"></td><td headers="mdlDocsTableCol2"><div class="modalOptionsContainer" id="btnOpenCusMonDoc"><span class="option optionAdd mdlDocOption"  tabIndex="0"><system:label show="text" label="btnMonDoc" /></span></div></td></tr><!-- seleccionar documento desde carpeta --><tr class="btnSelDocToHide" style="display: none"><td headers="mdlDocsTableCol1" class="text"></td><td headers="mdlDocsTableCol2"><div class="modalOptionsContainer" id="btnOpenDocFldMdl"><span class="option optionAdd mdlDocOption" tabIndex="0"><system:label show="text" label="btnSelDcFrmTree" /></span></div></td></tr><tr><td></td><td headers="mdlDocsTableCol1" colspan="2"><div class="progressBarContainer" id="documentProgressBarContainer" style="width: 100%;"><div class="progressBar" id="documentProgressBar"></div></div><div id="documentProgressMessages"></div></td></tr><tr><td headers="mdlDocsTableCol1" class="text"><label for="documentModalDocDesc"><system:label show="text" label="lblDesc" />:</label></td><td headers="mdlDocsTableCol2" class="content" colspan="2"><textarea title="<system:label show="text" label="lblDesc" />" name="docDesc" id="documentModalDocDesc" style="width: 99%; resize: none;" maxlength="255"></textarea></td></tr><tr><td headers="mdlDocsTableCol1" class="text"><label for="docExpDate"><system:label show="text" label="lblExpDate" />:</label></td><td headers="mdlDocsTableCol2" class="content" colspan="2"><input type="text" name="docExpDate" id="docExpDate" class="datePickerCustom"></td></tr></tbody></table><br><div class="fieldGroup" id="documentInfoContainer" style="display: none; max-height: 170px;"><!-- 						<div id="documentInfoContainer" style="display:none;"> --><div class="collapseMdlDocSection"></div><div class="title"><system:label show="text" label="lblPrevDocsToAdd" /></div><div class="modalOptionsContainer scrollContainer" id="docsNamesContainer" style="min-height: 42px; max-height: 165px; width: 100%; overflow:auto;"></div></div><div class="fieldGroup" id="permission"><div class="collapseMdlDocSection"></div><div class="title"><system:label show="text" label="lblPer" /></div><table title="permissionTable"><thead><tr><th id="mdlRightDocsTableCol1" style="width:30%"></th><th id="mdlRightDocsTableCol2" style="width:70%"></th></tr></thead><tbody><tr id="permissions"><td headers="mdlRightDocsTableCol1" class="text" style="width: 30%"><system:label show="text" label="sbtPerAccDoc" />:</td><td headers="mdlRightDocsTableCol2" class="content" colspan="2"><div class="modalOptionsContainer scrollContainer" id="mdlDocumentPoolContainter"><span class="option"><label for="selDocAllPoolPerm"><system:label show="text" label="lblTod" />:</label><select name="docAllowAllType" id="selDocAllPoolPerm" title="<system:label show="text" label="sbtPerAccDoc" />"><option value="M"><system:label show="text" label="lblPerMod" /></option><option value="R"><system:label show="text" label="lblPerVer" /></option><option value=""><system:label show="text" label="lblAccessDenied" /></option></select></span><div id="scrollOptions" class="scrollContainer" style="max-height:105px;overflow:auto"></div><hr id="mdlDocumentPoolContainterDivider" style="clear: both;"><span class="option optionAdd" id="mdlDocumentAddPool" tabIndex="0"><system:label show="text" label="btnAgrGru" /></span><span class="option optionAdd" id="mdlDocumentAddUser" tabIndex="0"><system:label show="text" label="btnAgrUsu" /></span></div></td></tr></tbody></table></div><div class="fieldGroup" id="folders" style="display: none;"><div class="collapseMdlDocSection"></div><div class="title"><system:label show="text" label="sbtFolders" /></div><!-- 						<div id="folders" class="foldersStruct scrollContainer" style="max-height: 135px;"> --><div class="foldersStruct scrollContainer" style="max-height: 135px;"><ul id="foldersStruct"></ul></div></div><!-- METADATA --><div class="fieldGroup" id="metadata"><div class="collapseMdlDocSection"></div><div class="title"><system:label show="text" label="titMetadata" /></div><div class="gridContainer" style="margin: 0px;" id="gridMetadata"><div class="gridHeader" style="width: 100%;"><table title="<system:label show="tooltip" label="titMetadata" /> header"><thead><tr class="header"><th id="tableMetadataCol1Head" title="<system:label show="tooltip" label="lblTit" />" style="width: 50%"><div style="width: 100%"><system:label show="text" label="lblTit" /></div></th><th id="tableMetadataCol2Head" title="<system:label show="tooltip" label="lblVal" />" style="width: 50%"><div style="width: 100%"><system:label show="text" label="lblVal" /></div></th></tr></thead><tbody><tr><td headers="tableMetadataCol1Head"></td><td headers="tableMetadataCol2Head"></td></tr></tbody></table></div><div class="gridBody" style="height: 135px; overflow: hidden !important;"><table title="<system:label show="tooltip" label="titMetadata" />"><thead><tr><th id="tableMetadataCol1"></th><th id="tableMetadataCol2"></th></tr></thead><tbody class="tableData" id="tableMetadata"><tr><td headers="tableMetadataCol1"></td><td headers="tableMetadataCol2"></td></tr></tbody></table></div><div class="gridFooter listActionButtons" style="margin-top: 0px;"><div class="listAddDel" id="buttonsMetadata" ><div class="actSeparator">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="btnAdd navButton" id="btnAddMeta" style="margin-top: 5px;"><system:label show="text" label="btnAgr" /></div><div class="actSeparator">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="btnDelete navButton" id="btnDeleteMeta" style="margin-top: 5px;"><system:label show="text" label="btnEli" /></div></div></div></div></div><br></div></div><div class="mdlFooter"><div class="close" id="btnCloseDocumentModal" tabIndex="0"><system:label show="text" label="btnCer" /></div><div class="modalButton" id="btnConfirmDocumentModal" tabIndex="0"><system:label show="text" label="btnCon" /></div></div></form></div><!-- modal de informacion de documentos --><div id="mdlDocumentInfo" class="mdlDocContainer mdlContainer hiddenModal"><div class="mdlHeader"><system:label show="text" label="lblInfo" /></div><div class="mdlBody"><!-- GENERAL INFO --><table class="generalInfo" title="<system:label show="text" label="lblInfo" />"><tbody ><tr><td class="text"><system:label show="text" label="lblDocType" />:&nbsp;</td><td class="content"><span id="docTypeLabel"></span></td></tr><tr><td class="text"><system:label show="text" label="lblNom" />:&nbsp;</td><td class="content largeText"><span id="lblNom"></span></td></tr><tr><td class="text"><system:label show="text" label="lblDesc" />:&nbsp;</td><td class="content largeText"><span id="docDesc"></span></td></tr><tr><td class="text"><system:label show="text" label="lblExpDate" />:&nbsp;</td><td class="content"><span id="docExpDateInfo"></span></td></tr><tr><td class="text"><system:label show="text" label="lblDwnLink" />:&nbsp;</td><td class="content largeText"><span id="docDwn" style="width:100%;"></span></td></tr><tr id="permissionInfo"><td class="text"><system:label show="text" label="sbtPerAccDoc" />:</td><td class="content"><div class="modalOptionsContainer" id="mdlDocumentPoolContainterInfo"><span class="option"><label for="selDocAllPoolPermInfo"><system:label show="text" label="lblTod" />:</label><select title="<system:label show="text" label="sbtPerAccDoc" />" name="docAllowAllType" id="selDocAllPoolPermInfo" class="readonly" disabled><option value="M" selected><system:label show="text" label="lblPerMod" /></option><option value="R"><system:label show="text" label="lblPerVer" /></option><option value=""><system:label show="text" label="lblAccessDenied" /></option></select></span><div id="scrollOptionsInfo" style="max-height:105px;overflow:auto"></div><br><hr id="mdlDocumentPoolContainterDividerInfo" style="clear: both;display:none;"></div></td></tr></tbody></table><!-- HISTORY --><table class="history" title="<system:label show="tooltip" label="lblDocVers" />"><thead><tr><td id="docHistCol1"><system:label show="text" label="lblVer" /></td><td id="docHistCol2"><system:label show="text" label="lblUsu" /></td><td id="docHistCol3"><system:label show="text" label="lblFecUpl" /></td></tr></thead><tbody id="tblDocHistory"><!-- 					<tr style="Display : none"> --><!-- 						<td headers="docHistCol1"></td> --><!-- 						<td headers="docHistCol2"></td> --><!-- 						<td headers="docHistCol3"></td> --><!-- 					</tr> --></tbody></table></div><br><br><!-- METADATA --><div class="fieldGroup" id="metadataInfo"><div class="gridMetadataTitle"><system:label show="text" label="titMetadata" /></div><div class="gridContainer" style="margin: 0px;" id="gridMetadataInfo"><div class="gridHeader"><table title="<system:label show="tooltip" label="titMetadata" /> info header"><thead><tr class="header"><th id="<system:label show="tooltip" label="titMetadata" />InfoHeader1" title="<system:label show="tooltip" label="lblTit" />" style="width: 50%"><div style="width: 100%"><system:label show="text" label="lblTit" /></div></th><th id="<system:label show="tooltip" label="titMetadata" />InfoHeader2" title="<system:label show="tooltip" label="lblVal" />" style="width: 50%"><div style="width: 100%"><system:label show="text" label="lblVal" /></div></th></tr></thead><tbody><tr style="display: none"><th headers="<system:label show="tooltip" label="titMetadata" />InfoHeader1"></th><th headers="<system:label show="tooltip" label="titMetadata" />InfoHeader2"></th></tr></tbody></table></div><div class="gridBody" style="height: 135px"><table title="<system:label show="tooltip" label="titMetadata" /> Info body"><thead><tr><th id="<system:label show="tooltip" label="titMetadata" />InfoBody1" ></th><th id="<system:label show="tooltip" label="titMetadata" />InfoBody2" ></th></tr></thead><tbody class="tableData" id="tableMetadataInfo"><tr style="display: none"><th headers="<system:label show="tooltip" label="titMetadata" />InfoBody1"></th><th headers="<system:label show="tooltip" label="titMetadata" />InfoBody2"></th></tr></tbody></table></div><div class="gridFooter listActionButtons"></div></div></div><div class="mdlFooter"><div class="close" id="btnCloseDocumentInfo"><system:label show="text" label="btnCer" /></div></div></div><div class="" id="mdlTmpDivDocInfo"></div></system:edit><%@include file="pools.jsp" %><%@include file="users.jsp" %><%@include file="foldersDocuments.jsp" %>
