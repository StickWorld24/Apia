/*! For license information please see index.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t){},1:function(e,t){},OMi8:function(e,t,s){},sYyW:function(e,t){e.exports=/(Edge\/(79(?:\.0)?|79(?:\.([1-9]|\d{2,}))?|([8-9]\d|\d{3,})(?:\.\d+)?))|(HeadlessChrome((?:\/50\.0\.\d+)?|(?:\/50\.([1-9]|\d{2,})\.\d+)?|(?:\/(5[1-9]|[6-9]\d|\d{3,})\.\d+\.\d+)?))|((Chromium|Chrome)\/(50\.0|50\.([1-9]|\d{2,})|(5[1-9]|[6-9]\d|\d{3,})\.\d+)(?:\.\d+)?)|(Version\/(10\.0|10\.([1-9]|\d{2,})|(1[1-9]|[2-9]\d|\d{3,})\.\d+|11\.0|11\.([1-9]|\d{2,})|(1[2-9]|[2-9]\d|\d{3,})\.\d+|12\.0|12\.([1-9]|\d{2,})|(1[3-9]|[2-9]\d|\d{3,})\.\d+|13\.0|13\.([1-9]|\d{2,})|(1[4-9]|[2-9]\d|\d{3,})\.\d+)(?:\.\d+)? Safari\/)|(Firefox\/(60\.0|60\.([1-9]|\d{2,})|(6[1-9]|[7-9]\d|\d{3,})\.\d+)\.\d+)|(Firefox\/(60\.0|60\.([1-9]|\d{2,})|(6[1-9]|[7-9]\d|\d{3,})\.\d+)(pre|[ab]\d+[a-z]*)?)/},tjUo:function(e,t,s){"use strict";s.r(t);s("OMi8");var i={ELEMENT_SELECT_SIZE:20,GRID_SIZE:20,TASK_SIZE:{width:120,height:80},DATA_SIZE:{width:40,height:40},GATEWAY_SIZE:{width:40,height:40},EVENT_SIZE:{radius:20},GROUP_SIZE:{width:300,height:300},TEXT_SIZE:{width:120,height:80},POOL_SIZE:{width:640,height:480},HAND_MODE:"hand_mode",CONNECTOR_MODE:"connector_mode",LASSO_MODE:"lasso_mode",DELETE:"Delete",TASK:"Task",SUBPROCESS:"Subprocess",GATEWAY:"Gateway",END_EVENT:"EndEvent",START_EVENT:"StartEvent",INTERMEDIATE_EVENT:"IntermediateEvent",POOL:"Pool",LANE:"Lane",GROUP:"Group",TEXT:"TextAnnotation",DATA_OBJECT:"DataObject",DATA_STORE:"DataStore",DATA_INPUT:"DataInput",DATA_OUTPUT:"DataOutput",WORKFLOW:"Workflow",CONNECTOR:"Connector",CONNECTOR_TYPE_ASSOCIATION:"association",CONNECTOR_TYPE_TRANSITION:"transition",OPEN_SUBPROCESS:"openSubprocess",VERSION:"2020",DEFAULT_SUBP_COLOR:"#d6f6ff",DEFAULT_TASK_COLOR:"#ffffff",START_ID_REMAPPING:500};function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=window.top.TAB_ID_REQUEST,l=window.top.CONTEXT,h="".concat(l),c="task",p="group",d="roles",u="form",_="classes",m="events",g="bindings",v="status",b="attributes",T="xmlCalendars",y="subProcess",E="xmlProcTasks",S="xmlClassesDescription",f="getTaskFormDoc",I="&action=findElement",C=window.parent.document.getElementById("cmbEntAsoc").value,P="".concat(h,"/apia.design.BPMNProcessAction.run?"),A=n(n(n({},{DATE_FORMAT:window.parent.APIA_DATE_FORMAT,NEW_TASK_URL:"".concat(P,"type=").concat(c).concat(o,"&action=addElement"),TASK_URL:"".concat(P,"type=").concat(c).concat(o).concat(I,"&name="),WORKFLOW_EVENTS_URL:"".concat(P,"action=").concat(m).concat(o,"&evtScope=P"),WORKFLOW_ACTIONS_URL:"".concat(P,"action=").concat(_).concat(o),WORKFLOW_ATTRS_URL:"".concat(P,"type=").concat(b).concat(o).concat(I),NEW_WORKFLOW_ATTRS_URL:"".concat(P,"type=").concat(b).concat(o,"&action=addElement&name="),WORKFLOW_BINDINGS_URL:"".concat(P,"action=").concat(g).concat(o,"&clsId="),PARTICIPANTS_URL:"".concat(P,"type=").concat(p).concat(o).concat(I,"&name="),NEW_PARTICIPANT_URL:"".concat(P,"type=").concat(p).concat(o,"&action=addElement"),TASK_SCHEDULE:"".concat(P,"action=").concat(T).concat(o),SUBPROCESS_URL:"".concat(P,"type=").concat(y).concat(o).concat(I,"&name="),SUBPROCESS_TASKS_URL:"".concat(P,"action=").concat(E).concat(o,"&proc_id="),SUBPROCESS_OPEN_NEW_TAB_URL:"".concat(P,"action=update&readOnly=true"),ROLES_URL:"".concat(P,"type=").concat(d).concat(o).concat(I,"&name="),NEW_ROLE_URL:"".concat(P,"type=").concat(d).concat(o,"&action=addElement"),STATES_EVENTS_URL:"".concat(P,"action=").concat(m).concat(o,"&evtScope=T"),STATES_STATUS_URL:"".concat(P,"action=").concat(v).concat(o,"&busEntId=").concat(C),TASK_EVENTS_URL:"".concat(P,"action=").concat(m).concat(o,"&evtScope=T"),TASK_BUSCLAS_EVENTS_URL:"".concat(P,"action=").concat(_).concat(o),TASK_BINDINGS_URL:"".concat(P,"action=").concat(g).concat(o,"&clsId="),TASK_BINDINGS_ATTR_URL:"".concat(P,"type=").concat(b).concat(o).concat(I,"&name="),NEW_BINDINGS_ATTR_URL:"".concat(P,"type=").concat(b).concat(o,"&action=addElement"),NEW_ENT_FORM_URL:"".concat(P,"type=").concat(u).concat(o,"&action=addElement&busEntId=").concat(C),NEW_PROC_FORM_URL:"".concat(P,"type=").concat(u).concat(o,"&action=addElement"),TASK_ENT_FORMS_URL:"".concat(P,"type=").concat(u).concat(o,"&busEntId=").concat(C).concat(I,"&name="),TASK_PROC_FORMS_URL:"".concat(P,"type=").concat(u).concat(o).concat(I,"&name="),TASK_INPUT_MSG_REF:"".concat(P,"type=").concat(b).concat(o).concat(I,"&name="),NEW_TASK_INPUT_MSG_ATTR:"".concat(P,"type=").concat(b).concat(o,"&action=addElement&name="),TASK_OUTPUT_WS_URL:"".concat(P,"action=").concat(_,"&wsClasses=true").concat(o),TASK_MULTIINSTANCE_URL:"".concat(P,"type=").concat(b,"&attType=N").concat(o).concat(I,"&name="),NEW_NUMERIC_ATTR_URL:"".concat(P,"type=").concat(b,"&attType=N").concat(o,"&action=addElement&name="),SUBP_REUSABLE_ENT_URL:"".concat(P,"type=").concat(b,"&attType=N").concat(o).concat(I,"&name="),SUBP_REUSABLE_PROC_FORMS_URL:"".concat(P,"type=").concat(u).concat(o).concat(I,"&name="),SUBP_REUSABLE_ENT_FORMS_URL:"".concat(P,"type=").concat(u).concat(o,"&busEntId=").concat(C).concat(I,"&name="),SUBP_MULTIINSTANCE_URL:"".concat(P,"type=").concat(b,"&attType=N").concat(o).concat(I,"&name="),SUBP_NAME_URL:"".concat(P,"type=").concat(y).concat(o).concat(I,"&name="),NEW_SUBP_URL:"".concat(P,"type=").concat(y).concat(o,"&action=addElement"),EVT_MSG_ATTRS_URL:"".concat(P,"type=").concat(b).concat(o,"&attType=S-N-D").concat(I,"&name="),EVT_MSG_WS_URL:"".concat(P,"action=").concat(_,"&wsClasses=true").concat(o),EVT_MSG_WS_ATTR_URL:"".concat(P,"type=").concat(b).concat(o).concat(I,"&name="),EVT_TIMER_ATTR_URL:"".concat(P,"type=").concat(b,"&attType=N-D").concat(o).concat(I,"&name="),EVT_MSG_NEW_ATTRS_URL:"".concat(P,"type=").concat(b).concat(o,"&action=addElement&name="),EVT_MSG_WS_BINDINGS_URL:"".concat(P,"action=").concat(g).concat(o,"&clsId="),VALIDATE_COND_URL:"".concat(P,"action=xmlValCondition").concat(o,"&value="),CLASSES_DESCRIPTION_URL:"".concat(P,"action=").concat(S).concat(o),TASK_FORM_DOC:"".concat(P,"action=").concat(f).concat(window.parent.TAB_ID_REQUEST),DEFAULT_ATTRS_URL:"".concat(P,"type=").concat(b).concat(o).concat(I),LOCALIZATION_URL:"".concat(h,"/page/design/bpmn/svg/i18n/labels.jsp"),LOCALIZATION_DEBUG:"false",ENV:"Production"}),i),{},{TAB_KEYS:o}),k=s("obfP"),w=s("7O5W"),M=s("XzT5"),L=s("AyIz"),x=s.n(L),N=s("27lf"),O=s("3W10"),D=s("/83O"),R=s("GvDV"),B=s("cRoA"),V=s("7/4q"),F=s("zQZ7"),U=s("Gt99"),W=s("DuTs"),z=s("ogY5"),H=s("nlIe"),G=s("zKLB"),j=s("4+EV"),q=s("2jRn"),Y=s("7e8U"),K=s("RBsE"),Z=s("hWBJ"),X=s("rby6"),J=s("DAfx"),Q=s("ewk2"),$=s("Qjxm"),ee=s("efGH"),te=s("TIhO"),se=s("6d2W"),ie=s("EZMA"),ae=s("fAtr"),ne=s("B3wY"),re=s("H4st"),oe=s("DyUz"),le=s("vDqi"),he=s.n(le),ce=s("DzJC"),pe=s.n(ce),de=s("QczR"),ue=s.n(de),_e=s("uhBA"),me=s.n(_e),ge=s("BM93"),ve=s.n(ge);SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(e){return e.getScreenCTM().inverse().multiply(this.getScreenCTM())},de.plugin((e,t,s,i)=>{function a(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(event),e.cancelBubble=!0,e.returnValue=!1}function n(t,s){return e.matrix().translate(t.x,t.y).scale(s).translate(-t.x,-t.y)}function r(e,t,s){this.resetStates().parent().ftGetElement().resetStates();var i=this.parent().ftGetElement().getTransformedBB();this.storeScaleFactor(l(this.getBBox().cx,this.getBBox().cy,i.x,i.y));var a=this.getEventPoint(s);return this.storeDragStart(a.x,a.y).storeStartAngle(this.getStartAngle()+ +this.getLastAngle()||0)}function o(t,s,i,a,n){this.panMove(n);var r=this.parent().ftGetElement(),o=this.getBBox();this.parent().ftGetJoins().forEach(e=>{e.ftUpdateJoin(o.cx,o.cy)});var h=r.getTransformedBB(),c=e.angle(h.x,h.y,this.getBBox().cx,this.getBBox().cy)-180-this.getStartAngle();this.storeLastAngle(c);var p=l(h.x,h.y,this.getBBox().cx,this.getBBox().cy);r.storeNewRotate(c).scaleBy(p/this.getScaleFactor())}function l(e,t,s,i){return Math.sqrt(Math.pow(e-s,2)+Math.pow(t-i,2))}function h(e,t){for(var s in t)void 0===e[s]&&(e[s]=t[s]);return e}t.prototype.handleScroll=function(e){e||(e=event),a(e);var t=e.detail<0||e.wheelDelta>0?1.1:.9,s=this.getMousePoint(e);return this.node.viewBox?this.viewBoxZoom(s,t):this.elementZoom(s,t),this.ftUpdateHandlesIfExist()},t.prototype.elementZoom=function(e,t){return this.storeInitialTransform().transform(this.getInitialTransform().toTransformString()+n(e,t).toTransformString())},t.prototype.zoomCenter=function(e){if(!this.node.viewBox){var t=this.getBoundingCenter();this.elementZoom(t,e)}},t.prototype.globalToLocal=function(e){var t=this.node.getTransformToElement(this.paper.node).inverse();return t.e=t.f=0,e.matrixTransform(t)},t.prototype.getCursorPoint=function(e,t){var s=this.paper.node.createSVGPoint();return s.x=e,s.y=t,s.matrixTransform(this.paper.node.getScreenCTM().inverse())},t.prototype.viewBoxZoom=function(e,t){var s=this.getViewboxInfo(),i=n(e,t),a=i.x(s.x,s.y),r=i.y(s.x,s.y),o="".concat(a," ").concat(r," ").concat(s.width*t," ").concat(s.height*t);return this.paper.attr({viewBox:o})},t.prototype.getViewBox=function(){return this.paper.attr("viewBox")||{x:this.paper.node.x.baseVal.value,y:this.paper.node.y.baseVal.value,width:this.paper.node.width.baseVal.value,height:this.paper.node.height.baseVal.value}},t.prototype.createPoint=function(e,t){var s=this.paper.node.createSVGPoint();return s.x=e,s.y=t,s},t.prototype.getInverseScreenPoint=function(e,t){return this.createPoint(e,t).matrixTransform(this.node.getScreenCTM().inverse())},t.prototype.getMousePoint=function(e,t,s){var i=t||e.clientX||e.center.x,a=s||e.clientY||e.center.y;return this.getInverseScreenPoint(i,a)},t.prototype.getEventPoint=function(e){var t=this.createPoint(e.clientX,e.clientY);return e.srcEvent?(t.x=e.center.x||e.srcEvent.clientX,t.y=e.center.y||e.srcEvent.clientY):(t.x=e.clientX||e.center.x,t.y=e.clientY||e.center.y),t.matrixTransform(this.paper.node.getScreenCTM().inverse())},t.prototype.getBoundingCenter=function(e){var t=this.paper.node.createSVGPoint(),s=this.getBBox();return t.x=s.cx,t.y=s.cy,t},t.prototype.storeNewRotate=function(e){return this.data("newrotate",e)},t.prototype.createNewViewbox=function(){var e=this.getNewPan(),t=this.getOriginalViewbox(),s=t.width/this.getNewScale(),i=t.height/this.getNewScale();return{x:t.x-(s-t.width)/2+ +e.dx,y:t.y-(i-t.height)/2+ +e.dy,width:s,height:i}},t.prototype.updateTransform=function(){if("svg"===this.type){var e=this.createNewViewbox();this.attr({viewBox:"".concat(e.x," ").concat(e.y," ").concat(e.width," ").concat(e.height)})}else{var t="".concat(this.getInitialTransform().toTransformString(),"r").concat(this.getNewRotation(),"s").concat(this.getNewScale()).concat(this.getNewPanString());this.transform(t).resetNewTransforms()}return this.ftUpdateHandlesIfExist()},t.prototype.getViewboxInfo=function(){var e=this.getViewBox(),t=e.width||this.paper.node.width.baseVal.value,s=e.height||this.paper.node.height.baseVal.value,i=e.x||0,a=e.y||0;return{cx:i+t/2,cy:a+s/2,x:i,y:a,width:t,height:s}},t.prototype.resetNewTransforms=function(){for(var e=["newrotate","newscale","newtx","newty"],t=0;t<e.length;t++)this.removeData(e[t])},t.prototype.addTransform=function(e){return this.transform(this.transform().localMatrix.toTransformString()+e)},t.prototype.storeNewScale=function(e){return this.data("newscale",e)},t.prototype.getNewScale=function(){return this.data("newscale")||"1"},t.prototype.getCurrentRotation=function(){return this.transform().localMatrix.split().rotate},t.prototype.getStartRotation=function(){return this.getInitialTransform().split().rotate||0},t.prototype.getCurrentScale=function(){return this.transform().localMatrix.split().scalex},t.prototype.getNewRotation=function(){return this.data("newrotate")||0},t.prototype.getCurrentTranslate=function(){var e=this.transform().localMatrix.split();return{dx:e.dx,dy:e.dy}},t.prototype.storeInitialTransform=function(){return this.data("ovb",this.paper.getViewboxInfo()).data("itm",this.transform().localMatrix)},t.prototype.getInitialTransform=function(){return this.data("itm")||e.matrix()},t.prototype.pinchMove=function(e){return a(e),this.storeNewRotate(e.rotation).storeNewScale(e.scale).updateTransform()},t.prototype.resetStates=function(e){return this.resetNewTransforms(),this.storeInitialTransform()},t.prototype.getOriginalViewbox=function(){return this.data("ovb")},t.prototype.getNewPan=function(){return{dx:this.data("newtx")||0,dy:this.data("newty")||0}},t.prototype.getNewPanString=function(e,t){var s=this.getNewPan();return"t".concat(s.dx,",").concat(s.dy)},t.prototype.storeDragStart=function(e,t){return this.data("ox",e),this.data("oy",t),this},t.prototype.getDragStart=function(){return{x:this.data("ox"),y:this.data("oy")}},t.prototype.storeNewPan=function(e,t){return this.data("newtx",e),this.data("newty",t),this},t.prototype.onPanStart=function(e){this.resetStates(),this.storeInitialTransform();var t=this.getEventPoint(e);return this.storeDragStart(t.x,t.y)},t.prototype.panMove=function(e){a(e);this.getEventPoint(e);var t=this.getDragStart(),s=this.getEventPoint(e),i=this.createPoint();i.x=s.x-t.x,i.y=s.y-t.y;var n=this.globalToLocal(i);return this.storeNewPan(n.x,n.y),this.updateTransform()},t.prototype.panInc=function(e,t){return this.storeInitialTransform(),this.storeNewPan(e,t),this.updateTransform()},t.prototype.panBy=function(e,t){return this.storeNewPan(e,t),this.updateTransform()},t.prototype.rotateInc=function(e){return this.storeInitialTransform(),this.storeNewRotate(e),this.updateTransform()},t.prototype.rotateBy=function(e){return this.storeNewRotate(e),this.updateTransform()},t.prototype.scaleInc=function(e){return this.storeInitialTransform(),this.storeNewScale(e),this.updateTransform()},t.prototype.scaleBy=function(e){return this.storeNewScale(e),this.updateTransform()},t.prototype.animateFunc=function(t,s,i,a,n,r){return this.storeInitialTransform(),e.animate(t,s,i.bind(this),a,n,r)},t.prototype.addMouseWheelHandler=function(){return this.node.addEventListener("DOMMouseScroll",this.handleScroll.bind(this,null)),this.node.addEventListener("mousewheel",this.handleScroll.bind(this,null)),this},t.prototype.svgFocus=function(){var e=this.getBBox();return this.paper.attr({viewBox:"".concat(e.x," ").concat(e.y," ").concat(e.width," ").concat(e.height)})},t.prototype.animateSvgFocus=function(e,t,s){var i=this.getViewboxInfo(),a=this.getBBox(0);return this.animateFunc([i.x,i.y,i.width,i.height],[a.x,a.y,a.width,a.height],(function(e){this.paper.attr({viewBox:e.join(" ")})}),e,t,s)},t.prototype.getFtHandles=function(){return this.data("ftHandles")},t.prototype.ftSetHandle=function(e){return this.data("ftHandles",e)},t.prototype.ftGetElement=function(){return this.data("ftElement")},t.prototype.ftSetElement=function(e){return this.data("ftElement",e)},t.prototype.ftUpdateHandlesIfExist=function(){return this.getFtHandles()&&this.getFtHandles().ftUpdateHandlePosition(),this},t.prototype.ftCreateHandles=function(){var e=this.getBBox(),t=this.paper.circle(e.cx+e.width,e.cy,5).attr({class:"handle"}).drag(o,r),s=(this.paper.circle(e.cx,e.cy,1).attr({class:"handle"}),this.paper.line(e.cx,e.cy,e.cx+e.width,e.cy).attr({fill:"blue",stroke:"blue",class:"join",strokeDasharray:"5,5"})),i=this.paper.g(t,s).ftSetElement(this);return this.data("hbb",this.highlightBBox()),this.ftSetHandle(i)},t.prototype.getTransformedBB=function(t){var s=this.getBBox(1),i=this.node.getTransformToElement(t?this.node.farthestViewportElement:this.paper.node),a=e.matrix(i);return{x:a.x(s.cx,s.cy),y:a.y(s.cx,s.cy)}},t.prototype.transformedBoundingBox=function(e){var t=this.node.getBBox(),s=this.node.ownerSVGElement,i=this.node.getTransformToElement(e?this.node.farthestViewportElement:this.node.parentNode),a=[s.createSVGPoint(),s.createSVGPoint(),s.createSVGPoint(),s.createSVGPoint()];a[0].x=t.x,a[0].y=t.y,a[1].x=t.x+t.width,a[1].y=t.y,a[2].x=t.x+t.width,a[2].y=t.y+t.height,a[3].x=t.x,a[3].y=t.y+t.height;var n=1/0,r=-1/0,o=1/0,l=-1/0;return a.forEach(e=>{e=e.matrixTransform(i),n=Math.min(n,e.x),r=Math.max(r,e.x),o=Math.min(o,e.y),l=Math.max(l,e.y)}),t.x=n,t.width=r-n,t.y=o,t.height=l-o,t},t.prototype.ftUpdateHandlePosition=function(){var e,t,s=this.ftGetElement().getTransformedBB();this.ftGetJoins().forEach(i=>{e=i.attr("x1")-s.x,t=i.attr("y1")-s.y,i.attr({x1:s.x,y1:s.y,x2:i.attr("x2")-(i.attr("x1")-s.x),y2:i.attr("y2")-(i.attr("y1")-s.y)})}),this.ftGetHandles().forEach(s=>{s.attr({cx:s.attr("cx")-e,cy:s.attr("cy")-t})}),this.ftGetElement().highlightBBox()},t.prototype.storeScaleFactor=function(e){return this.data("scaleFactor",e)},t.prototype.getScaleFactor=function(e){return this.data("scaleFactor")},t.prototype.storeStartAngle=function(e){return this.data("startangle",e)},t.prototype.getStartAngle=function(){return this.data("startangle")},t.prototype.storeLastAngle=function(e){return this.data("lastangle",e)},t.prototype.getLastAngle=function(){return this.data("lastangle")},t.prototype.ftUpdateJoin=function(e,t){return this.attr({x2:e,y2:t})},t.prototype.ftGetJoins=function(){return this.parent().selectAll(".join")},t.prototype.ftGetHandles=function(){return this.parent().selectAll(".handle")},t.prototype.highlightBBox=function(){this.getBBox(0);this.data("hbb")&&this.data("hbb").remove();var e=this.transformedBoundingBox(1),t=this.paper.rect(e.x,e.y,e.width,e.height).attr({fill:"none",stroke:"green",strokeWidth:4,opacity:.3,strokeDasharray:"5,5"});return this.data("hbb",t),t},s.prototype.markupAnimate=function(e){return this.el("animate").attr(h(e,{attributeType:"CSS",repeatCount:"indefinite"}))},s.prototype.markupAnimateTransform=function(e){return this.el("animateTransform").attr(h(e,{attributeName:"transform",attributeType:"XML",additive:"replace"}))},s.prototype.markupAnimateColor=function(e){return this.el("animateColor").attr(h(e,{attributeName:"fill",attributeType:"XML",repeatCount:"indefinite"}))},s.prototype.markupAnimateMotion=function(e){return this.el("animateMotion",h(e,{repeatCount:"indefinite"}))},s.prototype.markupMpath=function(e){return this.el("mpath",h(e,{}))},t.prototype.markupAnimateMotion=function(e,t){var s=e.path;delete e.path;var i=this.paper.markupAnimateMotion(e);return s&&i.node.setAttribute("path",s),t&&i.append(t),this.append(i),i},t.prototype.markupAnimateColor=function(e){return this.append(this.paper.markupAnimateColor(e))},t.prototype.markupAnimateTransform=function(e){return this.append(this.paper.markupAnimateTransform(e))},t.prototype.markupAnimate=function(e){return this.append(this.paper.markupAnimate(e))},t.prototype.animateFrames=function(e){!function e(t,s){s>=t.length||("function"==typeof t[s].startFunc&&t[s].startFunc.call(t[s].el),t[s].el.animate(t[s].animation,t[s].dur,t[s].easing,e.bind(null,t,s+1)))}(e,0)}});class be extends me.a{constructor(e,t){super(),this._editor=e,this._paper=e._paper,this._viewport=null,this._lastX=0,this._lastY=0,this._MAX_ZOOM_OUT=.2,this._MAX_ZOOM_IN=2,this._ZOOM_SCALE=.1,this._PAN_FACTOR_SCALE=.1,this._PAN_FACTOR_INIT=1.5,this._pan_factor=this._PAN_FACTOR_INIT,this._pos={x:0,y:0},this._ZOOM_INIT=1,this._zoom=this._ZOOM_INIT,this._mousemoveHandler=this._mousemoveHandler.bind(this),this._mouseupHandler=this._mouseupHandler.bind(this),this._paper.node.addEventListener("wheel",this._onWheel.bind(this)),t&&this.enablePanning(!0)}init(){this._viewport=this._editor._viewport,this.resetViewPort()}resetViewPort(){this._pos.x=0,this._pos.y=0,this._zoom=this._ZOOM_INIT,this._pan_factor=this._PAN_FACTOR_INIT,this._viewport.transform("T0,0 S1")}enablePanning(e){this._paper.removeClass("hand"),this._paper.unmousedown(this._mousedownHandler),e?(this._paper.removeClass("selectionable"),this._paper.removeClass("connectionable"),this._paper.addClass("hand"),this._paper.mousedown(this._mousedownHandler,this)):this._mouseupHandler()}_mousedownHandler(e){e.target===this._paper.node&&(this._paper.removeClass("hand"),this._paper.addClass("draggable"),this._lastX=e.clientX,this._lastY=e.clientY,window.addEventListener("mousemove",this._mousemoveHandler,!1),window.addEventListener("mouseup",this._mouseupHandler,!1))}_mousemoveHandler(e){this._paper.removeClass("draggable"),this._paper.addClass("dragging"),e.preventDefault(),this._pan(e.clientX-this._lastX,e.clientY-this._lastY),this._lastX=e.clientX,this._lastY=e.clientY}_pan(e,t){this._pos.x+=e*this._pan_factor,this._pos.y+=t*this._pan_factor,this._viewport.transform("T".concat(this._pos.x," ").concat(this._pos.y," S").concat(this._zoom)),this.emit("panned")}_mouseupHandler(){this._paper.removeClass("dragging"),this._paper.removeClass("draggable"),this._paper.addClass("hand"),window.removeEventListener("mousemove",this._mousemoveHandler),window.removeEventListener("mouseup",this._mouseupHandler)}zoomIn(){this._zoom<this._MAX_ZOOM_IN&&(this._zoom+=this._ZOOM_SCALE,this._pan_factor+=this._PAN_FACTOR_SCALE,this._zoomIt())}zoomOut(){this._zoom>this._MAX_ZOOM_OUT&&(this._zoom-=this._ZOOM_SCALE,this._pan_factor-=this._PAN_FACTOR_SCALE,this._zoomIt())}_zoomIt(){this._viewport.transform("T".concat(this._pos.x," ").concat(this._pos.y," S").concat(this._zoom)),this.emit("zoomed")}_onWheel(e){e.preventDefault(),this._editor._keyManager._isCtrlPressed?e.deltaY<0?this.zoomIn():this.zoomOut():this._pan(-1*e.deltaX,-1*e.deltaY)}}var Te=s("h8tw"),ye=s.n(Te),Ee=s("BkRI"),Se=s.n(Ee),fe=s("9gO0"),Ie=s.n(fe),Ce=s("TKrE"),Pe=s.n(Ce);function Ae(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ke(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(s),!0).forEach((function(t){we(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ae(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function we(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Me(e,t){var s=e.getBoundingClientRect(),i=t.getBoundingClientRect();return!(i.left>s.right||i.right<s.left||i.top>s.bottom||i.bottom<s.top)}function Le(e){for(var t,s=0,i=e.length;s<i;s++)"Pool"===e[s].elementType&&(t=e[s]);return t}function xe(e){for(var t=[],s=0,i=e.length;s<i;s++){var a=e[s];"Lane"===a.elementType&&t.push(a)}return t}function Ne(e,t){for(var s=e.length,i=0;i<s;i++)if(e[i].y>t)return e[i-1]||e[0];return e[s-1]}function Oe(e,t){for(var s=e.length,i=0;i<s;i++)if(e[i].y>t)return e[i]||e[s-1];return e[s-1]}function De(e){for(var t,s=[],i=0,a=e.length;i<a;i++)(t=e[i]).selected&&s.push(t);return s}function Re(e){return De(e).length}function Be(e){return e.reduce((e,t)=>e.x<t.x?e:t)}function Ve(e){return e.reduce((e,t)=>e.selectionBox.node.getBoundingClientRect().right>t.selectionBox.node.getBoundingClientRect().right?e:t)}function Fe(e){return e.reduce((e,t)=>e.y<t.y?e:t)}function Ue(e){return e.reduce((e,t)=>e.selectionBox.node.getBoundingClientRect().bottom>t.selectionBox.node.getBoundingClientRect().bottom?e:t)}function We(e,t){return[Math.floor(e/t)*t,Math.ceil(e/t)*t].reduce((t,s)=>Math.abs(s-e)<Math.abs(t-e)?s:t)}function ze(e,t){for(var s=[],i=0,a=t.length;i<a;i++)t[i].elementType===e&&s.push(t[i]);return s}function He(e,t){for(var s=0,i=t.length;s<i;s++)if(parseInt(t[s].id,10)===parseInt(e,10))return t[s];return null}function Ge(e,t){return He(e.substr(e.indexOf("_")+1),t)}function je(e,t,s){var i=[];return s.forEach(a=>{if(a.elementType===A.CONNECTOR&&parseInt(a.properties.from,10)===parseInt(e.id,10)){var n=He(a.properties.to,s);n.elementType===t&&i.push(n)}if(a.elementType===A.CONNECTOR&&parseInt(a.properties.to,10)===parseInt(e.id,10)){var r=He(a.properties.from,s);r.elementType===t&&i.push(r)}}),i}function qe(e,t,s,i,a,n){return Math.abs(t/e)<n/a?[Math.round(s+(e>0?a:-a)),Math.round(i+t*a/Math.abs(e))]:[Math.round(s+e*n/Math.abs(t)),Math.round(i+(t>0?n:-n))]}function Ye(e){for(var t=ue.a.set(),s=0,i=e.length;s<i;s++)t.push(e[s].graphic);return t.getBBox()}function Ke(e){for(var t=e.children(),s=ue.a.set(),i=0,a=t.length;i<a;i++){var n=t[i];n.hasClass("grid_bg")||s.push(n)}return s.getBBox()}function Ze(e){return e?Pe()(e).replace(/\s/g,"_"):"Untitled"}function Xe(e,t){for(var s="",i=new Uint8Array(e),a=i.byteLength,n=0;n<a;n++)s+=String.fromCharCode(i[n]);var r=document.createElement("a");r.href="data:text/plain;base64,".concat(window.btoa(s)),r.download=t,r.click()}function Je(e,t){return t.filter(t=>t.elementType===A.CONNECTOR&&t.type===A.CONNECTOR_TYPE_TRANSITION&&t.from===e.id)}function Qe(e,t,s){var i=[];return t.forEach(t=>{t.elementType===A.CONNECTOR&&t[s]===e.id&&i.push(t)}),i}function $e(e,t){var s=Je(e,t),i=e.selectionBox.node.getBoundingClientRect(),a={y:0};return s.forEach(e=>{var s=He(e.to,t).selectionBox.node.getBoundingClientRect();s.y>a.y&&s.left>i.right&&(a=s)}),0===a.y?null:a}function et(e,t){e.setAttribute("data-visible",t)}function tt(e){var t={input:"IN",output:"OUT","input-output":"IN-OUT"};return e.map(e=>ke(ke({},e),{},{inout:t[e.inout]}))}function st(e=[],t){return e.reduce((e,s)=>ke(ke({},e),{},{[s[t]]:s}),{})}class it extends me.a{constructor(e){super(),this._editor=e,this._history=null}init(){this._history=ye.a.create({maxUndos:100}),this._checkUndoSize(),this._checkRedoSize()}save(){this._history=this._history.push(this._getElementsData()),this._checkUndoSize(),this._checkRedoSize()}undo(){if(this._history.canUndo){var e=this._history.previous;this._history=this._history.undo(this._getElementsData()),this._updateElementsFromHistory(e.elements)}this._checkUndoSize(),this._checkRedoSize()}redo(){if(this._history.redo(this._getElementsData()),this._history.canRedo){var e=this._history.next;this._history=this._history.redo(this._getElementsData()),this._updateElementsFromHistory(e.elements)}this._checkUndoSize(),this._checkRedoSize()}_checkUndoSize(){0===this._history.undos.size?this.emit("undo",!1):this.emit("undo",!0)}_checkRedoSize(){0===this._history.redos.size?this.emit("redo",!1):this.emit("redo",!0)}_getElementsData(){var e=[];return this._editor.elements.forEach(t=>{e.push({id:t.id,type:t.elementType,props:Se()(t.properties),x:t.x,y:t.y})}),{elements:e}}_updateElementsFromHistory(e){var t=Ie()(e,this._getElementsData().elements,"id",{updatedValues:Ie.a.updatedValues.first});if(t.removed){var s=[];t.removed.forEach(e=>{e.type!==A.CONNECTOR?this._createEl(e):s.push(e)}),s.forEach(e=>{this._createEl(e)})}t.updated&&t.updated.forEach(e=>{var t=this._editor._viewport.select("#".concat(e.type,"_").concat(e.id)),s=this._editor._paper.select("#ctx_".concat(e.id));e.type!==A.WORKFLOW&&(t.remove(),s.remove()),this._removeFromElementsArray(e);var i=this._createEl(e);e.type!==A.CONNECTOR&&(this._editor._connections.forEach(e=>{e._toEl.id===i.id&&(e._toEl=i),e._fromEl.id===i.id&&(e._fromEl=i)}),this._editor.updateElementConnectors(i))}),t.added&&t.added.forEach(e=>{this._editor._viewport.select("#".concat(e.type,"_").concat(e.id)).remove(),this._editor._paper.select("#ctx_".concat(e.id)).remove(),this._removeFromElementsArray(e)}),this.emit("history_done")}_createEl(e){return this._editor.createElement(e.type,e.x,e.y,e.props,!1)}_removeFromElementsArray(e){for(var t=He(e.id,this._editor.elements),s=0,i=this._editor.elements.length;s<i;s++)this._editor.elements[s]===t&&this._editor.elements.splice(s,1);if(t.elementType===A.CONNECTOR)for(var a=0,n=this._editor._connections.length;a<n;a++)this._editor._connections[a]===t&&this._editor._connections.splice(a,1)}}class at{constructor(e){this._editor=e,this._poolElements=[],this._laneElements=[],this._LANE_MIN_HEIGHT=160,this._isFirstMove=!0}moveStart(e){if(e.elementType===A.POOL){this._poolElements=[];for(var t=this._editor.elements.length,s=0;s<t;s++){var i=this._editor.elements[s],a=i.selectionBox;if(i.elementType!==A.POOL)if(a)Me(e.selectionBox.node,a.node)&&this._poolElements.push(i)}}}moving(e){if(e.elementType===A.POOL){for(var t,s=0,i=this._poolElements.length;s<i;s++)(t=this._poolElements[s]).elementType!==A.CONNECTOR&&t.moveElement(Math.round(e.mx+t.x),Math.round(e.my+t.y));this._isFirstMove&&(this._editor.toggleElementConnectorsVisibility(!1),this._isFirstMove=!1)}}moveEnd(e){if(e.elementType===A.POOL){for(var t,s=0,i=this._poolElements.length;s<i;s++)(t=this._poolElements[s]).elementType!==A.CONNECTOR&&(t.moveElementEnd(Math.round(e.mx+t.x),Math.round(e.my+t.y)),this._editor.updateElementConnectors(t,{x:e.mx,y:e.my},!1,!0),this._editor.updateElementConnectors(t,{x:0,y:0},!1,!0)),t.elementType===A.CONNECTOR&&t.resetMovingPointSegment();this._editor.toggleElementConnectorsVisibility(!0),this._isFirstMove=!0}}noMoveEnd(e){e.elementType===A.POOL&&(this._editor.toggleElementConnectorsVisibility(!0),this._isFirstMove=!0)}onElementDelete(){for(var e=this._editor.elements.length;e--;)this._editor.elements[e].elementType===A.LANE&&(this._editor.elements[e].delete(),this._editor.elements.splice(e,1))}onResizeStart(){this._laneElements=xe(this._editor.elements)}onResize(e,t,s){for(var i,a=0,n=s,r=this._laneElements.length,o=0;o<r;o++){var l=this._laneElements[o];i=l._nameBoxWidth,l.resizeWidth(t-i),o<r-1&&(n-=l.height),a+=l.height}r>=1?n>=this._LANE_MIN_HEIGHT?(e.minHeight=0,this._laneElements[r-1].resizeHeight(n),e.resize(t,s)):(e.minHeight=s,e.resize(this._laneElements[0].width+i,a)):(e.minHeight=0,e.resize(t,s))}onResizeEnd(){for(var e=0;e<this._laneElements.length;e++){var t=this._laneElements[e];t.properties.size={width:t.width,height:t.height}}this._laneElements=[]}}class nt{constructor(e){this._editor=e,this._laneElements=[],this._pool=null,this._nextLane=null,this._DEFAULT_LANE_HEIGHT=160,this._LANE_MIN_HEIGHT=160,this._LANE_NAME_BAR_WIDTH=30}createLane(e){var t=++this._editor.idIndex,s=xe(this._editor.elements).length,i=e.height,a=null;return s>0?(a=this._editor.createElement(A.LANE,e.x,e.y+i,{id:t,size:{width:e.width-this._LANE_NAME_BAR_WIDTH,height:this._DEFAULT_LANE_HEIGHT}},!1),i+=this._DEFAULT_LANE_HEIGHT,e.resize(e.width,i)):a=this._editor.createElement(A.LANE,e.x,e.y,{id:t,size:{width:e.width-this._LANE_NAME_BAR_WIDTH,height:e.height}},!1),a}onLaneDeleted(e){var t=xe(this._editor.elements),s=Ne(t,e.y);s&&(s.resizeHeight(s.height+e.height),s.properties.size={width:s.width,height:s.height});for(var i=Le(this._editor.elements),a=0;a<t.length;a++)t[a].y=a>0?t[a-1].y+t[a-1].height:i.y}resizeStart(e){this._laneElements=xe(this._editor.elements),this._pool=Le(this._editor.elements),this._nextLane=Oe(this._laneElements,e.y)}resize(e,t){e.resizeHeight(t);for(var s=0,i=0,a=this._laneElements.length,n=0;n<a;n++){var r=this._laneElements[n],o=r.height;s+=o,r!==e&&r!==this._nextLane&&(i+=o)}var l=this._nextLane.height+(this._pool.height-s);1===a||e===this._laneElements[a-1]?(e.maxHeight=Number.POSITIVE_INFINITY,this._pool.resize(e.width+e._nameBoxWidth,s)):a>1&&(e.maxHeight=this._pool.height-i-this._LANE_MIN_HEIGHT,this._nextLane.y=e.y+e.height,this._nextLane.resizeHeight(l))}resizeEnd(){for(var e=this._laneElements.length,t=0;t<e;t++)this._laneElements[t].properties.size={height:this._laneElements[t].height,width:this._laneElements[t].width};this._laneElements=[],this._pool=null,this._nextLane=null}}class rt{constructor(e,t){this._editor=e,this._historyManager=t}alignLeft(){var e=this._getSelected(this._editor.elements);if(e.length>1){for(var t=Be(e),s=[],i=[],a=0,n=e.length-1;a<n;a++){var r=e[a];r.selectionBox.node.getBoundingClientRect().x===e[a+1].selectionBox.node.getBoundingClientRect().x?s[a]=!0:s[a]=!1,this._checkIsValid(i,a,r)}if(s.includes(!1)&&!i.includes(!1)){this._historyManager.save();for(var o=0,l=e.length;o<l;o++){var h=e[o],c=h.x;h.x=t.x,this._editor.updateElementConnectors(h),this._updateHorizontalBoundaryEventsPos(h,c)}}}}alignRight(){var e=this._getSelected(this._editor.elements);if(e.length>1){for(var t=Ve(e),s=[],i=[],a=0,n=e.length-1;a<n;a++){var r=e[a];r.selectionBox.node.getBoundingClientRect().right===e[a+1].selectionBox.node.getBoundingClientRect().right?s[a]=!0:s[a]=!1,this._checkIsValid(i,a,r)}if(s.includes(!1)&&!i.includes(!1)){this._historyManager.save();for(var o=0,l=e.length;o<l;o++){var h=e[o];if(t!==h){var c=h.x;h.x=t.x+(t.width-h.width),this._editor.updateElementConnectors(h),this._updateHorizontalBoundaryEventsPos(h,c)}}}}}alignTop(){var e=this._getSelected(this._editor.elements);if(e.length>1){for(var t=Fe(e),s=[],i=[],a=0,n=e.length-1;a<n;a++){var r=e[a];r.selectionBox.node.getBoundingClientRect().top===e[a+1].selectionBox.node.getBoundingClientRect().top?s[a]=!0:s[a]=!1,this._checkIsValid(i,a,r)}if(s.includes(!1)&&!i.includes(!1)){this._historyManager.save();for(var o=0,l=e.length;o<l;o++){var h=e[o],c=h.y;h.y=t.y,this._editor.updateElementConnectors(h),this._updateVerticalBoundaryEventsPos(h,c)}}}}alignBottom(){var e=this._getSelected(this._editor.elements);if(e.length>1){for(var t=Ue(e),s=[],i=[],a=0,n=e.length-1;a<n;a++){var r=e[a];r.selectionBox.node.getBoundingClientRect().bottom===e[a+1].selectionBox.node.getBoundingClientRect().bottom?i[a]=!0:i[a]=!1,this._checkIsValid(s,a,r)}if(i.includes(!1)&&!s.includes(!1)){this._historyManager.save();for(var o=0,l=e.length;o<l;o++){var h=e[o];if(t!==h){var c=h.y,p=t.y+(t.height-h.height);h.y=p,this._editor.updateElementConnectors(h),this._updateVerticalBoundaryEventsPos(h,c)}}}}}alignHorizontalCenter(e,t){var s=[],i=[],a=e.filter(e=>e.elementType!==A.CONNECTOR);if(a.length>1){for(var n=Ue(a),r=Fe(a),o=n.y+n.height,l=(r.y+o)/2,h=0,c=a.length;h<c;h++){var p=a[h];p.y===Math.round(l-p.height/2)?s[h]=!0:s[h]=!1,this._checkIsValid(i,h,p)}if(s.includes(!1)&&!i.includes(!1)){t&&this._historyManager.save();for(var d=0,u=a.length;d<u;d++){var _=a[d],m=Math.round(l-_.height/2),g=_.y;this._editor._isSnapToGridOn?_.y=We(m,A.GRID_SIZE)+A.ELEMENT_SELECT_SIZE/2:_.y=m,this._editor.updateElementConnectors(_),this._updateVerticalBoundaryEventsPos(_,g)}}}}alignVerticalCenter(){var e=[],t=[],s=this._getSelected(this._editor.elements).filter(e=>e.elementType!==A.CONNECTOR);if(s.length>1){for(var i=Ve(s),a=Be(s),n=i.x+i.width,r=(a.x+n)/2,o=0,l=s.length;o<l;o++){var h=s[o];h.x===Math.round(r-h.width/2)?e[o]=!0:e[o]=!1,this._checkIsValid(t,o,h)}if(e.includes(!1)&&!t.includes(!1)){this._historyManager.save();for(var c=0,p=s.length;c<p;c++){var d=s[c],u=Math.round(r-d.width/2),_=d.x;this._editor._isSnapToGridOn?d.x=We(u,A.GRID_SIZE)+A.ELEMENT_SELECT_SIZE/2:d.x=u,this._editor.updateElementConnectors(d),this._updateHorizontalBoundaryEventsPos(d,_)}}}}distVertical(){var e=[],t=this._getSelected(this._editor.elements);if(t.sort((e,t)=>e.y-t.y),t.length>2){for(var s=t[t.length-1],i=t[0],a=i.y-A.ELEMENT_SELECT_SIZE/2,n=s.y-A.ELEMENT_SELECT_SIZE/2,r=n-a-i.height,o=0,l=1;l<t.length-1;l++)o+=t[l].height;var h=(r-o)/(t.length-1),c=h>=0;h<0&&(h=(n-a)/(t.length-1));for(var p=[],d=1;d<t.length-1;d++){var u=t[d],_=u.y-(t[d-1].y+t[d-1].height);e[d]=_===h,this._checkIsValid(p,d,u)}if(e.includes(!1)&&!p.includes(!1)){this._historyManager.save();for(var m=1;m<t.length-1;m++){var g=t[m],v=g.y,b=t[m-1].y+(c?t[m-1].height:0)+h;this._editor._isSnapToGridOn?g.y=We(b,A.GRID_SIZE)+A.ELEMENT_SELECT_SIZE/2:g.y=b,this._editor.updateElementConnectors(g),this._updateVerticalBoundaryEventsPos(g,v)}}}}distHorizontal(){var e=[],t=this._getSelected(this._editor.elements);if(t.sort((e,t)=>e.x-t.x),t.length>2){for(var s=t[t.length-1],i=t[0],a=i.x-A.ELEMENT_SELECT_SIZE/2,n=s.x-A.ELEMENT_SELECT_SIZE/2,r=n-a-i.width,o=0,l=1;l<t.length-1;l++)o+=t[l].width;var h=(r-o)/(t.length-1),c=h>=0;h<0&&(h=(n-a)/(t.length-1));for(var p=[],d=1;d<t.length-1;d++){var u=t[d],_=u.x-(t[d-1].x+t[d-1].width);e[d]=_===h,this._checkIsValid(p,d,u)}if(e.includes(!1)&&!p.includes(!1)){this._historyManager.save();for(var m=1;m<t.length-1;m++){var g=t[m],v=g.x,b=t[m-1].x+(c?t[m-1].width:0)+h;this._editor._isSnapToGridOn?g.x=We(b,A.GRID_SIZE)+A.ELEMENT_SELECT_SIZE/2:g.x=b,this._editor.updateElementConnectors(g),this._updateHorizontalBoundaryEventsPos(g,v)}}}}_checkIsValid(e,t,s){s.elementType===A.POOL||s.elementType===A.LANE||s.elementType===A.CONNECTOR?e[t]=!1:e[t]=!0}_updateHorizontalBoundaryEventsPos(e,t){if(e.elementType===A.TASK||e.elementType===A.SUBPROCESS)for(var s=0,i=e.boundaryEvents.length;s<i;s++){var a=He(e.boundaryEvents[s],this._editor.elements);if(!a.selected){var n=t-a.x;a.x=e.x-n,this._editor.updateElementConnectors(a)}}}_updateVerticalBoundaryEventsPos(e,t){if(e.elementType===A.TASK||e.elementType===A.SUBPROCESS)for(var s=0,i=e.boundaryEvents.length;s<i;s++){var a=He(e.boundaryEvents[s],this._editor.elements);if(!a.selected){var n=t-a.y;a.y=e.y-n,this._editor.updateElementConnectors(a)}}}_getSelected(e){for(var t,s=[],i=0,a=e.length;i<a;i++)(t=e[i]).selected&&t.elementType!==A.POOL&&t.elementType!==A.LANE&&t.elementType!==A.CONNECTOR&&s.push(t);return s}}class ot{constructor(e,t){this._editor=e,this._historyManager=t,this._clipboard=[],this._clipboardElements=[],this._pasteOffset=0,this._PASTE_POSITION_OFFSET=30}copy(){var e=De(this._editor.elements);this._clipboardElements=e.filter(e=>e.elementType!==A.CONNECTOR&&e.elementType!==A.START_EVENT&&e.elementType!==A.POOL&&e.elementType!==A.LANE&&!e.properties.isAttached),this._clipboard=Se()(this._clipboardElements.map(e=>e.properties)),this._pasteOffset=1}paste(){if(this._clipboard.length>0){this._editor.unSelectAllElements(),this._historyManager.save();for(var e=0,t=this._clipboard.length;e<t;e++){var s=this._clipboardElements[e],i=this._clipboard[e],a=this._editor.idIndex+1;i.id=a,i.activity&&(i.activity.id=a),i.boundaryEvents=[];var n=Se()(i);this._editor.createElement(s.elementType,s.x+this._PASTE_POSITION_OFFSET*this._pasteOffset,s.y+this._PASTE_POSITION_OFFSET*this._pasteOffset,n,!1,!1).selected=!0}this._pasteOffset+=2}return!0}}class lt{constructor(e,t){this._editor=e,this._gridSize=t,this._grid=null,this._isGridOn=!1}init(){this._grid||this._drawGrid(),this.isGridOn&&"Offline"===A.ENV&&this.show()}get gridSize(){return this._gridSize}get isGridOn(){return this._isGridOn}_drawGrid(){var e=this._editor._viewport,t=document.getElementById("app").getBoundingClientRect(),s=32*t.width,i=32*t.height,a=e.rect(-s/2,-i/2,s,i);this._grid=a.prependTo(e);var n=e.line(0,0,this._gridSize,0).attr({class:"grid_bg__line"}),r=e.line(0,0,0,this._gridSize).attr({class:"grid_bg__line"}),o=e.g(n,r).pattern(0,0,this._gridSize,this._gridSize);this._grid.attr({fill:o,class:"grid_bg","data-visible":"off"})}show(){this._grid.node.setAttribute("data-visible","on"),this._isGridOn=!0}hide(){this._grid.node.setAttribute("data-visible","off"),this._isGridOn=!1}}var ht=s("NVta"),ct=s.n(ht);class pt extends me.a{constructor(e){super(),this._editor=e,this._paper=e._paper,this._lassoRect=null,this._onHandleDrag=this._onHandleDrag.bind(this),this._onHandleDragStart=this._onHandleDragStart.bind(this),this._onHandleDragEnd=this._onHandleDragEnd.bind(this)}enableLasso(e){this._paper.undrag(),this._paper.removeClass("selectionable"),e?(this._paper.removeClass("hand"),this._paper.removeClass("connectionable"),this._paper.addClass("selectionable"),this._paper.drag(this._onHandleDrag,this._onHandleDragStart,this._onHandleDragEnd)):this._lassoRect&&this._lassoRect.remove()}_onHandleDragStart(e,t,s){if("app"===s.target.id){var i=this._paper.getEventPoint(s);this._lassoRect=this._paper.rect(i.x,i.y,0,0).attr({class:"lasso_selection"}),this._lassoRect.data("ox",i.x),this._lassoRect.data("oy",i.y)}}_onHandleDrag(e,t,s,i,a){if("app"===a.target.id&&this._lassoRect&&a.x>0&&a.y>0){var n=this._paper.getEventPoint(a),r=n.x-this._lassoRect.data("ox"),o=n.y-this._lassoRect.data("oy");this._lassoRect.attr({width:Math.abs(r),height:Math.abs(o)}),r<0&&this._lassoRect.attr({x:this._lassoRect.data("ox")+r}),o<0&&this._lassoRect.attr({y:this._lassoRect.data("oy")+o})}}_onHandleDragEnd(){if(this._lassoRect){for(var e=0,t=this._editor.elements.length;e<t;e++){var s=this._editor.elements[e];s.graphic&&this._checkShapesSelectable(this._lassoRect.node,s)&&(s.selected=!0,s.toFront())}this._lassoRect.remove()}}_checkShapesSelectable(e,t){var s=e.getBoundingClientRect(),i=[[s.x,s.y],s.width,s.height],a=!1;switch(t.elementType){case A.CONNECTOR:for(var n=[],r=0,o=t._points.length;r<o-1;r++){var l=this._convertCoordsToGlobal(t._points[r].x,t._points[r].y),h=this._convertCoordsToGlobal(t._points[r+1].x,t._points[r+1].y),c=[[l.x,l.y],[h.x,h.y]];n[r]=this._checkIfValidSelection(c,i)}a=n.every(e=>!0===e);break;case A.START_EVENT:case A.END_EVENT:case A.INTERMEDIATE_EVENT:var p=t.selectionBox.node.getBoundingClientRect(),d=[[p.left+p.width/2,p.top+p.height/2],t.radius];a=this._checkIfValidSelection(d,i);break;case A.TASK:case A.SUBPROCESS:case A.DATA_OBJECT:case A.DATA_STORE:case A.DATA_INPUT:case A.DATA_OUTPUT:case A.GROUP:case A.TEXT:case A.GATEWAY:case A.LANE:case A.POOL:var u=t.selectionBox.node.getBoundingClientRect(),_=[[u.x,u.y],u.width,u.height];a=this._checkIfValidSelection(_,i)}return a}_checkIfValidSelection(e,t){return ct.a.contain(t,e)}_convertCoordsToGlobal(e,t){return this._paper.createPoint(e,t).matrixTransform(this._editor._viewport.node.getScreenCTM())}}var dt=s("imBb"),ut=s.n(dt);class _t{constructor(e){this._editor=e,this.initKeyBindings(),this._currentMouseMode=null,this._allElementsSelected=!1,this._isCtrlPressed=!1}initKeyBindings(){ut.a.bind("del",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),this._editor.deleteMultipleSelectedElements())}),ut.a.bind(["ctrl+c","meta+c"],e=>{e.preventDefault(),this._editor.copyElements()}),ut.a.bind(["ctrl+v","meta+v"],e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),this._editor.pasteElements())}),ut.a.bind(["shift+ctrl+z","shift+meta+z"],e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),this._editor.redoAction())}),ut.a.bind(["ctrl+z","meta+z"],e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),this._editor.undoAction())}),ut.a.bind("g",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),document.getElementById("grid_btn").click())}),ut.a.bind("p",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),document.getElementById("sidebar_toggle").click())}),ut.a.bind("h",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),document.getElementById("hand_btn").click())}),ut.a.bind("s",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),document.getElementById("lasso_btn").click())}),ut.a.bind("c",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),document.getElementById("connector_btn").click())}),ut.a.bind("t",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),this._editor.doTabProcessElements())}),ut.a.bind("+",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),document.getElementById("zoom_in").click())}),ut.a.bind("-",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),document.getElementById("zoom_out").click())}),ut.a.bind(["ctrl","meta"],()=>{this._currentMouseMode=this._editor.mode,this._editor._panZoomManager.enablePanning(!0),this._editor._lassoManager.enableLasso(!1),this._editor._connectorManager.enableConnection(!1),this._isCtrlPressed=!0},"keydown"),ut.a.bind(["ctrl","meta"],()=>{this._editor._panZoomManager.enablePanning(!1),this._editor.mode=this._currentMouseMode,this._isCtrlPressed=!1},"keyup"),ut.a.bind("r",e=>{"BODY"!==event.target.tagName&&"A"!==event.target.tagName||(e.preventDefault(),document.getElementById("reset_view").click())}),ut.a.bind("a",e=>{if("BODY"===event.target.tagName||"A"===event.target.tagName){e.preventDefault();var t=De(this._editor.elements);!this._allElementsSelected||t.length<1?(this._editor.selectAllElements(),this._allElementsSelected=!0):(this._editor.unSelectAllElements(),this._allElementsSelected=!1)}})}}class mt extends me.a{constructor(e,t){super(),this._editor=e,this._paper=e._paper,this._historyManager=t,this._isEnabled=!1,this._source=null,this._target=null,this._currentTarget=null,this._createFromContextMenu=!1,this._mousemoveHandler=this._mousemoveHandler.bind(this),this._mouseupHandler=this._mouseupHandler.bind(this),this._mousedownHandler=this._mousedownHandler.bind(this)}enableConnection(e){this._isEnabled=e,this._paper.removeClass("selectionable"),this._paper.removeClass("hand"),this._paper.addClass("connectionable"),e||(this._paper.removeClass("connectionable"),this.reset())}areConnected(e,t){return this._isConnectorOn(e,t)}_createGuideLine(e){var t=this._editor._viewport.getMousePoint(event,0,0);this._guideLine=this._editor._viewport.line(e.graphic.matrix.e+e.width/2,e.graphic.matrix.f+e.height/2,t.x,t.y).attr({class:"connection_guideline",id:"connection_guideline"})}connectOneTime(e){this.reset(),this._createFromContextMenu=!0,this._source=e,this._target=null,this._createGuideLine(e),e.toFront();for(var t=0,s=e.boundaryEvents.length;t<s;t++){He(e.boundaryEvents[t],this._editor.elements).toFront()}window.addEventListener("mousedown",this._mousedownHandler,!1),window.addEventListener("mousemove",this._mousemoveHandler,!1),window.addEventListener("mouseup",this._mouseupHandler,!1)}connect(e){e.elementType!==A.CONNECTOR&&e.elementType!==A.POOL&&e.elementType!==A.LANE&&e.elementType!==A.GROUP&&(!this._source&&this._isEnabled?e.elementType!==A.END_EVENT&&e.elementType!==A.TEXT?(this._source=e,this._target=null,this._createGuideLine(e),this._editor._mode===A.CONNECTOR_MODE&&e._contextMenu.hide(),window.addEventListener("mousemove",this._mousemoveHandler,!1),window.addEventListener("mouseup",this._mouseupHandler,!1)):this._source=null:(!this._isEnabled&&this._createFromContextMenu||this._isEnabled)&&(this._target=e,this._connectElements(this._source,this._target),this.reset()))}_mousedownHandler(){this._createFromContextMenu=!1}_mouseupHandler(e){("app"===e.target.id&&!this._createFromContextMenu||e.target.closest(".tool_bar"))&&this.reset()}reset(){this._guideLine&&this._guideLine.remove(),this._source=null,this._target=null,this._createFromContextMenu=!1,window.removeEventListener("mousemove",this._mousemoveHandler),window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("mousedown",this._mousedownHandler),this._paper.removeClass("invalid-connection")}_mousemoveHandler(e){var t=this._editor._viewport.getMousePoint(e,0,0),s=this._source.width/2,i=this._source.height/2,a=this._source.graphic.matrix.e-10+s,n=this._source.graphic.matrix.f-10+i,r=t.x,o=t.y,l=r-a,h=o-n,c=qe(l,h,a,n,s,i),p=qe(-l,-h,r,o,10,10);this._guideLine.attr({x1:c[0],y1:c[1],x2:p[0],y2:p[1]}),this._connectorVisualClues(this._source,e.target)}_connectElements(e,t){if(this._isConnectionValid(e,t)){this._currentTarget.graphic.removeClass("element--connectable-hover"),this._historyManager.save();var s=this._getConnectorType(e,t),i=this._editor.createElement(A.CONNECTOR,null,null,{id:this._editor.idIndex+1,from:e.id,to:t.id,points:[{x:0,y:0},{x:0,y:0}],type:s},!1,!1);t.elementType===A.DATA_OUTPUT&&i.setInitialDirection("directional"),e.elementType===A.DATA_INPUT&&i.setInitialDirection("directional")}}_getConnectorType(e,t){return e.elementType===A.DATA_STORE||t.elementType===A.DATA_STORE||e.elementType===A.DATA_OBJECT||t.elementType===A.DATA_OBJECT||e.elementType===A.DATA_INPUT||t.elementType===A.DATA_OUTPUT||e.elementType===A.TEXT||t.elementType===A.TEXT?A.CONNECTOR_TYPE_ASSOCIATION:A.CONNECTOR_TYPE_TRANSITION}_isConnectionValid(e,t){if(e!==t&&t.elementType!==A.START_EVENT&&e.elementType!==A.END_EVENT&&e.elementType!==A.TEXT&&e.elementType!==A.DATA_OUTPUT&&t.elementType!==A.DATA_INPUT&&!this._isConnectorOn(e,t)&&this._isNotBoundaryEvent(e,t)){switch(e.elementType){case A.DATA_OBJECT:case A.DATA_INPUT:if(t.elementType===A.DATA_OUTPUT)return!1;if(t.elementType===A.DATA_INPUT)return!1;if(t.elementType===A.DATA_OBJECT)return!1;if(t.elementType===A.DATA_STORE)return!1;break;case A.DATA_STORE:if(t.elementType===A.DATA_OUTPUT)return!1;if(t.elementType===A.DATA_INPUT)return!1;if(t.elementType===A.DATA_OBJECT)return!1;if(t.elementType===A.DATA_STORE)return!1;if(t.elementType===A.GATEWAY)return!1;if(t.elementType===A.START_EVENT)return!1;if(t.elementType===A.INTERMEDIATE_EVENT)return!1;if(t.elementType===A.END_EVENT)return!1}return!0}return!1}_isNotBoundaryEvent(e,t){return(e.elementType!==A.TASK&&t.elementType!==A.SUBPROCESS||t.elementType!==A.INTERMEDIATE_EVENT||!t.isAttached||t.target!==e.id)&&(e.elementType!==A.INTERMEDIATE_EVENT||t.elementType!==A.TASK&&t.elementType!==A.SUBPROCESS||!e.isAttached||e.target!==t.id)}_isConnectorOn(e,t){for(var s=0,i=this._editor._connections.length;s<i;s++){var a=this._editor._connections[s];if(a.properties.from===parseInt(e.id,10)&&a.properties.to===parseInt(t.id,10)||a.properties.to===parseInt(e.id,10)&&a.properties.from===parseInt(t.id,10))return!0}return!1}_connectorVisualClues(e,t){t.closest("#app")&&t.closest("#app").classList.add("invalid-connection"),this._currentTarget&&(this._currentTarget.graphic.removeClass("element--connectable-hover"),this._guideLine.removeClass("connection_guideline--connectable")),[".task",".subprocess",".intermediate_event",".end_event",".gateway",".data_store",".data_input",".data_output",".data_object",".annotation"].forEach(s=>{if(null!==t.closest(s)){var i=Ge(t.closest(s).id,this._editor.elements);this._currentTarget!==i&&this._currentTarget&&(this._currentTarget.graphic.removeClass("element--connectable-hover"),this._guideLine.removeClass("connection_guideline--connectable"),this._currentTarget=null),this._isConnectionValid(e,i)?(this._paper.removeClass("invalid-connection"),i.graphic.addClass("element--connectable-hover"),this._guideLine.addClass("connection_guideline--connectable"),this._currentTarget=i):(this._paper.addClass("invalid-connection"),this._guideLine.removeClass("connection_guideline--connectable"))}})}}class gt extends me.a{constructor(e){super(),this._editor=e,this._boundaryEventsToMove=[]}moveStart(e){var t=this;if(e.elementType===A.TASK){this._removeBoundaryEventsNotIntersecting(e);for(var s=function(s,i){var a=t._editor.elements[s];a.elementType===A.INTERMEDIATE_EVENT&&(a.isAttached&&a.target===e.id?(e.boundaryEvents.some(e=>e===a.id)||e.addBoundaryEvents(a.id),a.toFront(),t._boundaryEventsToMove.push(a)):t._checkIntersection(a,e)&&(t._editor._connectorManager.areConnected(e,a)||(e.boundaryEvents.some(e=>e===a.id)||(t._attached(a,e.id,!0),e.addBoundaryEvents(a.id)),a.toFront(),t._boundaryEventsToMove.push(a))))},i=0,a=this._editor.elements.length;i<a;i++)s(i)}else e.elementType===A.INTERMEDIATE_EVENT&&this._checkParentHover(e,!1)}moving(e){if(e.elementType===A.TASK)for(var t=0,s=this._boundaryEventsToMove.length;t<s;t++){var i=this._boundaryEventsToMove[t];i.moveElement(Math.round(e.mx+i.x),Math.round(e.my+i.y)),this._editor.updateElementConnectors(i)}else e.elementType===A.INTERMEDIATE_EVENT&&this._checkParentHover(e,!1)}moveEnd(e){if(e.elementType===A.TASK)for(var t=0,s=this._boundaryEventsToMove.length;t<s;t++){var i=this._boundaryEventsToMove[t];i.moveElementEnd(Math.round(e.mx+i.x),Math.round(e.my+i.y)),i.toFront()}else e.elementType===A.INTERMEDIATE_EVENT&&(this._checkParentHover(e,!0),this._checkIfAttached(e));this._boundaryEventsToMove=[]}noMoveEnd(e){this._boundaryEventsToMove=[],e.elementType===A.INTERMEDIATE_EVENT&&this._checkParentHover(e,!0)}_removeBoundaryEventsNotIntersecting(e){for(var t=e.boundaryEvents.length;t--;){var s=He(e.boundaryEvents[t],this._editor.elements);s?this._checkIntersection(s,e)||(this._attached(s,null,!1),e.removeBoundaryEvents(t)):e.removeBoundaryEvents(t)}}_checkIntersection(e,t){var s=e.selectionBox.node.getBoundingClientRect(),i=[[s.left+s.width/2,s.top+s.height/2],e.radius],a=t.box.node.getBoundingClientRect(),n=[[a.x,a.y],a.width,a.height];return ct.a.intersection(n,i)}_checkParentHover(e,t){for(var s=0,i=this._editor.elements.length;s<i;s++){var a=this._editor.elements[s];a.elementType===A.TASK&&(t?(a.graphic.removeClass("element--boundary-event-hover"),this._checkIntersection(e,a)&&(this._editor._connectorManager.areConnected(e,a)||this._attached(e,a.id,!0))):this._checkIntersection(e,a)?this._editor._connectorManager.areConnected(e,a)||a.graphic.addClass("element--boundary-event-hover"):a.graphic.removeClass("element--boundary-event-hover"))}}_checkIfAttached(e){e.target&&(this._checkIntersection(e,He(e.target,this._editor.elements))||this._attached(e,null,!1))}_attached(e,t,s){if(s){e.target=t,e.isAttached=s,"none"===e.eventType&&(e.type="timer");var i=this._editor.elements.find(t=>t.elementType===A.TASK&&t.id===e.target);if(i){var a=i.taskType;"receive"!==a&&"send"!==a&&"service"!==a&&"script"!==a||"message"!==e.eventType||(e.type="timer")}i.boundaryEvents.push(e.id),this.emit("boundary_attached",e)}else e.target=null,e.isAttached=!1,"multiple"!==e.eventType&&"error"!==e.eventType||(e.type="none")}}var vt=s("E+oP"),bt=s.n(vt),Tt=s("Y7UZ");class yt extends me.a{constructor(e,t,s,i){super(),this._paper=e,this._btn=null,this._bg=null,this._iconGroup=null,this._onButtonClicked=this._onButtonClicked.bind(this),this._ICON_OFFSET_X=20,this._ICON_OFFSET_Y=25,this._BG_OFFSET_X=15,this._drawMenu(s,i,t)}_drawMenu(e,t,s){this._bg=this._paper.rect(t.x+this._BG_OFFSET_X,t.y,40,36).attr({class:"context_menu_btn__bg"});var i=de.parse(s);this._iconGroup=i.select("g"),this._iconGroup.transform("s0.03, T".concat(t.x+this._ICON_OFFSET_X,",").concat(t.y+this._ICON_OFFSET_Y)),this._btn=this._paper.g(this._bg,this._iconGroup).mousedown(this._onButtonClicked).attr({class:"context_menu_btn"}),this._btn.appendTo(e)}_onButtonClicked(e){e.stopPropagation(),this.emit("on_context_button_clicked",e)}updatePosition(e){this._bg.attr({x:e.x+this._BG_OFFSET_X,y:e.y});var t=new de.Matrix;t.translate(e.x+this._ICON_OFFSET_X,e.y+this._ICON_OFFSET_Y),t.scale(.03),this._iconGroup.attr({transform:t})}}class Et extends me.a{constructor(e,t){super(),this._element=e,this._paper=e.paper,this._buttonNames=t,this._buttonBar=null,this._graphic=e.graphic,this._selectionBox=e.selectionBox,this._menuItems=[],this._MENU_OFFSET_Y=35,this._initButtons()}show(){this._updateMenuItemsPosition(),this._buttonBar.removeClass("context_menu--hidden")}hide(){this._buttonBar.addClass("context_menu--hidden")}_initButtons(){for(var e=this._selectionBox.node.getBoundingClientRect(),t=0,s=0,i=this._paper.g().attr({class:"context_menu",id:"ctx_".concat(this._element.id)}),a=0,n=this._buttonNames.length;a<n;a++){var r=null;a<4?(r={x:e.right-5,y:e.y+t},t+=this._MENU_OFFSET_Y):(r={x:e.right+35,y:e.y+s},s+=this._MENU_OFFSET_Y);var o=null;switch(this._buttonNames[a]){case A.DELETE:(o=new yt(this._paper,'<g id="remove_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M429 743c-58-4-70 11-71-52l0-9-172-56c-20-5-20-29 0-30l624 0c19 0 19 25 0 30l-168 55 0 10c0 62-7 48-71 52l-71 0z m-215-204c-14 0-25-12-24-26l50-555c1-12 11-22 24-22l457 0c13 0 23 9 25 22l64 554c2 15-9 27-24 27l-143 0-143 0z m27-49l259 0 259 0-59-505-414 0z m120-73c-1 0-2 0-3 0-16-1-28-15-25-31l44-320c2-15 16-26 31-24 15 2 25 17 22 32l-44 319c-2 13-12 23-25 24z m280 0c-13 0-25-10-27-24l-44-319c-3-15 7-30 22-32 16-2 29 9 31 24l44 320c3 16-9 30-26 31z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_remove_button_clicked")});break;case A.TASK:(o=new yt(this._paper,'<g id="append_task_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M215 745c-107 0-195-87-195-194l0-402c0-107 88-194 195-194l570 0c108 0 195 87 195 194l0 402c0 107-87 194-195 194l-570 0z m0-60l570 0c75 0 135-59 135-134l0-402c0-75-60-134-135-134l-570 0c-75 0-135 59-135 134l0 402c0 75 60 134 135 134z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_append",A.TASK)});break;case A.SUBPROCESS:(o=new yt(this._paper,'<g id="append_subprocess_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)"  d="M216 716c-86 0-155-69-155-154l0-424c0-85 69-154 155-154l569 0c85 0 154 69 154 154l0 424c0 85-69 154-154 154l-569 0z m0-48l569 0c59 0 106-47 106-106l0-424c0-59-47-106-106-106l-116 0 0 308-338 0 0-15 0-293-115 0c-60 0-106 47-106 106l0 424c0 59 46 106 106 106z m146-359l276 0 0-276-276 0 0 276z m115-39l0-23 0-54-54 0-23 0 0-46 23 0 54 0 0-54 0-23 46 0 0 23 0 54 54 0 23 0 0 46-23 0-54 0 0 54 0 23-46 0z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_append",A.SUBPROCESS)});break;case A.GATEWAY:(o=new yt(this._paper,'<g id="append_gateway_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M59 376c-14-14-14-38 0-52l415-415c14-14 38-14 52 0l415 415c14 14 14 38 0 52l-415 415c-14 14-38 14-52 0l-415-415z m51-26l390 390 390-390-390-390-390 390z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_append",A.GATEWAY)});break;case A.START_EVENT:(o=new yt(this._paper,'<g id="append_start_event_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M496 802c-176 0-345-113-412-276-70-161-34-362 89-487 119-128 314-175 477-115 169 58 294 224 301 403 12 176-92 351-250 428-62 31-132 47-201 47-1 0-3 0-4 0z m12-49c173-1 335-126 380-293 47-159-17-344-155-439-143-105-354-97-489 18-136 109-185 309-115 468 60 147 212 248 371 246 3 0 6 0 8 0z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_append",A.START_EVENT)});break;case A.INTERMEDIATE_EVENT:(o=new yt(this._paper,'<g id="append_intermediate_event_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M496 802c-219 2-422-178-445-396-24-185 78-380 247-461 160-80 368-56 501 66 134 118 190 318 128 486-57 165-214 291-388 303-15 1-29 2-43 2z m8-49c201 3 386-169 398-370 16-178-100-360-271-415-164-56-362 4-460 148-103 144-99 357 19 491 76 92 194 149 314 146z m-12-44c-185 0-352-166-352-352-4-168 124-331 291-360 153-30 322 49 390 191 71 141 39 329-84 431-67 59-156 92-245 90z m14-48c165 1 312-150 305-315 0-150-121-290-272-305-143-19-295 73-336 213-43 134 14 296 139 364 50 29 107 44 164 43z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_append",A.INTERMEDIATE_EVENT)});break;case A.END_EVENT:(o=new yt(this._paper,'<g id="append_end_event_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M496 802c-203 1-394-153-437-351-41-174 33-368 181-470 143-103 348-111 497-15 150 91 238 275 210 449-26 181-170 339-350 376-33 7-67 11-101 11z m10-142c150 1 287-123 302-271 19-142-72-291-210-334-134-45-296 13-366 138-77 129-45 313 78 403 56 43 126 66 196 64z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_append",A.END_EVENT)});break;case A.TEXT:(o=new yt(this._paper,'<g id="append_text_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M677 795l0-25 0-411 0-412 0-24 24 0 224 0 25 0 0 49-25 0-199 0 0 387 0 386 199 0 25 0 0 50-25 0-224 0-24 0z m-81-386l-75-60 60-75 75 60-60 75z m-151-119l-75-60 60-75 75 59-60 76z m-150-120l-76-59 60-76 75 60-59 75z m-151-119l-76-60 60-75 76 59-60 76z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_append",A.TEXT)});break;case A.OPEN_SUBPROCESS:(o=new yt(this._paper,'<g id="append_text_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M150 700l0-25 0-675 700 0 0 700z m44-44l612 0 0-612-612 0z m261-106l0-155-155 0 0-90 155 0 0-155 90 0 0 155 155 0 0 90-155 0 0 155z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_open_subprocess")});break;case A.CONNECTOR:(o=new yt(this._paper,'<g id="append_text_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M911 749c0 0-285-146-431-214 31-28 60-59 90-89-147-149-295-299-443-448 11-11 22-21 33-31 148 149 295 299 443 448 30-29 60-60 90-90 77 153 218 424 218 424z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_connect_button",A.CONNECTOR)});break;case A.LANE:(o=new yt(this._paper,'<g id="append_text_icon"><path class="context_menu_btn__icon" transform="scale(1, -1) translate(0, -100)" d="M46-50l0 89 49 0 0-40 16 0 0-49-65 0z m114 0l0 49 97 0 0-49-97 0z m146 0l0 49 98 0 0-49-98 0z m147 0l0 49 97 0 0-49-97 0z m146 0l0 49 98 0 0-49-98 0z m147 0l0 49 97 0 0-49-97 0z m145 0l0 49 13 0 0 40 49 0 0-64 0-25-25 0-37 0z m-845 138l0 92 49 0 0-92-49 0z m858 0l0 92 49 0 0-92-49 0z m-857 139l0 527 906 0 0-527-906 0z m857 48l0 435-810 0 0-435 810 0z" /></g>',this._buttonBar,r)).on("on_context_button_clicked",()=>{this.emit("element_on_append",A.LANE)})}i.add(o._btn),this._menuItems.push(o)}this._buttonBar=i.appendTo(document.getElementById("ctxMenuLayer"))}_updateMenuItemsPosition(){for(var e=this._selectionBox.node.getBoundingClientRect(),t=document.getElementById("app").getBoundingClientRect().top,s=-t,i=-t,a=0,n=this._menuItems.length;a<n;a++){var r=null;a<4?(r={x:e.right-5,y:e.y+s},s+=this._MENU_OFFSET_Y):(r={x:e.right+35,y:e.y+i},i+=this._MENU_OFFSET_Y),this._menuItems[a].updatePosition(r)}}delete(){this._buttonBar.remove()}}function St(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class ft extends me.a{constructor(e,t,s,i,a,n,r,o){super(),this._elementType=e,this._box=null,this._label=null,this._graphic=null,this._dx=i,this._dy=a,this._tdx=0,this._tdy=0,this._mx=i,this._my=a,this._width=0,this._height=0,this._viewport=s,this._hSize=12,this._handles=[],this._selectionBox=null,this._contextMenuItems=o,this._isMovable=r;var l=window.getComputedStyle(document.documentElement);this._foregroundColor=l.getPropertyValue("--subprocess-fill-color"),this._stroke_color=l.getPropertyValue("--stroke-color"),this._CONTRAST_COLORS_SELECTION=["#fffb00","#0433ff","#00fdff","00f900"],n?(this._properties=n,this._properties.size&&(this._width=this._properties.size.width,this._height=this._properties.size.height)):(this._properties={id:t},this.elementType!==A.TEXT&&this.elementType!==A.START_EVENT&&this.elementType!==A.INTERMEDIATE_EVENT&&this.elementType!==A.END_EVENT&&(this._properties.name="".concat(this.elementType))),this._properties.boundaryEvents||(this._properties.boundaryEvents=[]),this._selected=!1,this.SELECTSIZE=A.ELEMENT_SELECT_SIZE,this.onElementMouseDown=this.onElementMouseDown.bind(this),this.onElementMoveEnd=this.onElementMoveEnd.bind(this),this.onElementMove=pe()(this.onElementMove.bind(this),80),this.onElementMoveStart=this.onElementMoveStart.bind(this),this.onHandleDrag=this.onHandleDrag.bind(this),this.onHandleDragStart=this.onHandleDragStart.bind(this),this.onHandleDragEnd=this.onHandleDragEnd.bind(this)}initElement(){void 0!==this.x&&void 0!==this.y&&this._graphic.transform("T".concat(this.x,",").concat(this.y)),this._contextMenu=new Et(this,this._contextMenuItems),this._contextMenu.on("element_on_remove_button_clicked",()=>{this.emit("element_on_remove_button_clicked")}),this._contextMenu.on("element_on_append",e=>{this.emit("element_on_append",e)}),this._contextMenu.on("element_on_open_subprocess",()=>{this.emit("element_on_open_subprocess")}),this._contextMenu.on("element_on_connect_button",e=>{this.emit("element_on_connect_button",e)}),this.selected=this._properties.selected,this._contextMenu.hide()}get x(){return this._dx}set x(e){this._dx=e,this._graphic.transform("t".concat(this._dx,",").concat(this._dy))}get y(){return this._dy}set y(e){this._dy=e,this._graphic.transform("t".concat(this._dx,",").concat(this._dy))}get mx(){return this._mx}get my(){return this._my}get properties(){return this._properties}get elementType(){return this._elementType}get graphic(){return this._graphic}get box(){return this._box}get paper(){return this._viewport}get selected(){return this._selected}get selectionBox(){return this._selectionBox}get width(){return this.selectionBox.getBBox().width}get height(){return this.selectionBox.getBBox().height}get boundaryEvents(){return this._properties.boundaryEvents}addBoundaryEvents(e){this._properties.boundaryEvents.push(e)}removeBoundaryEvents(e){this._properties.boundaryEvents.splice(e,1)}set selected(e){this._selected=e,this._properties.selected=e,e?(this._graphic.select("#selectionBox").addClass("element--selected"),this.resizable&&this.drawResizeHandles(),this._onSelected()):(this._graphic.select("#selectionBox").removeClass("element--selected"),this.resizable&&this.removeResizeHandles(),this._onDeselected())}get id(){return this._properties.id}set id(e){this._properties.id=e,this._properties.activity&&(this._properties.activity.id=e)}set deleteProperty(e){delete this._properties[e]}addProperty(e,t,s){e[t]=s}_onSelected(){this.emit("element_selected")}_onDeselected(){this.emit("element_unselected")}drawSelectionBox(e,t="selectionBox"){return this._selectionBox=this._viewport.rect(Math.round(e.x-this.SELECTSIZE/2),Math.round(e.y-this.SELECTSIZE/2),Math.round(e.width+this.SELECTSIZE),Math.round(e.height+this.SELECTSIZE)).attr({class:t,id:"selectionBox"}),this._selectionBox}drawResizeHandles(){var e=this._selectionBox.getBBox();this._handles=[this._viewport.rect(e.x2-this._hSize/2,e.y2-this._hSize/2,this._hSize,this._hSize).attr({class:"resize__handle--se",id:"resize__handle"})];var t=this._viewport.g(this._handles[0]).drag(this.onHandleDrag,this.onHandleDragStart,this.onHandleDragEnd).attr({class:"resize",id:"resize_group"});this._graphic.append(t)}removeResizeHandles(){this._graphic.select("#resize_group")&&this._graphic.select("#resize_group").remove()}onHandleDragStart(){this._graphic.undrag(),this.removeResizeHandles(),this.drawResizeHandles(),this.emit("element_resize_start")}onHandleDrag(e,t,s,i,a){var n=this._selectionBox,r=St(this._handles,1)[0],o=n.transform().diffMatrix.invert();o.e=0,o.f=0;var l=o.x(e,t)+this.SELECTSIZE/2,h=o.y(e,t)+this.SELECTSIZE/2,c=this._viewport.getMousePoint(a,0,0),p=Math.round(c.x-this._graphic.matrix.e),d=Math.round(c.y-this._graphic.matrix.f);p>0&&d>0&&(r.transform("t".concat([l,h])),this.emit("element_resizing",p,d))}onHandleDragEnd(){this.emit("element_resize_end"),this._properties.size={width:this._width,height:this._height},this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}toFront(){this._graphic.appendTo(this._viewport)}toBack(){var e=this._viewport.select(".grid_bg");this._graphic.insertAfter(e)}snap(e,t){this._isSnapOn=e,this._snapSize=t,e&&this.elementType!==A.POOL&&this.elementType!==A.LANE&&this.elementType!==A.CONNECTOR&&(this.x=We(this.x,t)+this.SELECTSIZE/2,this.y=We(this.y,t)+this.SELECTSIZE/2,this.emit("element_snap_to_grid"))}onElementMoveStart(e,t,s){this.toFront(),this._graphic.addClass("draggable"),this._graphic.data("ot",this._graphic.transform().local),this.emit("element_move_start",s)}onElementMove(e,t,s,i,a){var n=this._graphic.transform().diffMatrix.invert();n.e=0,n.f=0,this._isSnapOn?(this._tdx=de.snapTo(this._snapSize,Math.round(n.x(e,t)),25),this._tdy=de.snapTo(this._snapSize,Math.round(n.y(e,t)),25)):(this._tdx=Math.round(n.x(e,t)),this._tdy=Math.round(n.y(e,t))),this._graphic.transform("t".concat([this._tdx,this._tdy]).concat(this._graphic.data("ot"))),this._mx=this._tdx,this._my=this._tdy,this.emit("element_moving",a)}onElementMoveEnd(e){this._graphic.removeClass("draggable");var t=this._graphic.matrix.e,s=this._graphic.matrix.f;this._dx!==t||this._dy!==s?(this.emit("element_move_end",e),this._dx=t,this._dy=s):this.emit("element_no_move_end")}onElementMouseDown(e){this.toFront(),this.emit("element_mouse_down",e)}moveElement(e,t){this._graphic.transform("t".concat([e,t]))}moveElementEnd(e,t){this._dx=e,this._dy=t}deleteEl(e=!0){if(this._contextMenu.delete(),e&&this.elementType!==A.CONNECTOR&&this.elementType!==A.POOL&&this.elementType!==A.LANE){var t=[{transform:"scale(0.8) translate(".concat(this._dx,"px, ").concat(this._dy,"px)"),easing:"ease-in",transformOrigin:"".concat(this._graphic.getBBox().cx,"px ").concat(this._graphic.getBBox().cy,"px")},{transform:"scale(1.4) translate(".concat(this._dx,"px, ").concat(this._dy,"px)"),easing:"cubic-bezier(.75,-0.5,0,1.75)",transformOrigin:"".concat(this._graphic.getBBox().cx,"px ").concat(this._graphic.getBBox().cy,"px")}];this._graphic.node.animate(t,{duration:200,delay:100}).onfinish=()=>{this._graphic.remove(),this.emit("element_deleted")}}else this._graphic.remove(),this.emit("element_deleted")}delete(){this._contextMenu.delete(),this._graphic.remove()}_updateNameLabel(e,t,s){e.attr("text",s);var i=t.getBBox();e.attr("x",Math.round(i.x+i.width/2))}drawLabel(e,t,s,i){var a=this._viewport.text(0,s,e).attr({class:t,dominantBaseline:"middle",textAnchor:"middle"});return a.attr("x",Math.round(i.x+i.width/2)),a}drawForeignObjLabel(e,t,s,i,a,n,r){var o='<g><foreignObject \n      x="'.concat(e,'"\n      y="').concat(t,'"\n      width="').concat(s,'" \n      height="').concat(i,'"\n      id="').concat(r,'">\n    <p class="').concat(n,'">').concat(a,"</p></foreignObject></g>");return de.parse(o)}updateTextLabel(e,t){this._graphic.select(".".concat(e)).node.innerText=t}_setColors(e,t,s,i){"#ffffff"!==e?Object(Tt.a)(e,this._stroke_color,{level:"AA",size:"small"})?this._foregroundColor=this._stroke_color:this._foregroundColor=Object(Tt.b)(e,this._CONTRAST_COLORS_SELECTION,{includeFallbackColors:!0,level:"AA",size:"small"}).toHexString():this._foregroundColor=this._stroke_color,this.graphic.select(t).attr({fill:e,stroke:this._foregroundColor});var a=this.graphic.select(s);a&&a.attr({color:this._foregroundColor});for(var n=0;n<i.length;n++){var r=this.graphic.select(i[n]);r&&r.attr({fill:this._foregroundColor,stroke:this._foregroundColor})}}set documentation(e){this.emit("element_onpropertychange"),this.documentation?this._properties.documentation.text=e.text:this._properties.documentation={id:e.id,text:e.text}}get documentation(){return(this._properties.documentation||{}).text||""}deletePropertyByName(e){this._properties[e]&&delete this._properties[e]}}class It extends ft{constructor(e,t,s,i,a,n){super(A.TASK,e,i,t,s,a,n,[A.DELETE,A.TASK,A.SUBPROCESS,A.END_EVENT,A.INTERMEDIATE_EVENT,A.GATEWAY,A.TEXT,A.CONNECTOR]),this._WIDTH=A.TASK_SIZE.width,this._HEIGHT=A.TASK_SIZE.height,a||(this._properties.taskType="user",this._properties.loopType="none",this._properties.name="Default_Task",this._properties.title="Default Task",this._properties.taskId=2,this._properties.condition="",this._properties.color="#ffffff",this._properties.activity={id:e,name:"Default_Task"}),this.drawElement(),this.initElement()}get taskType(){return this._properties.taskType}set taskType(e){this.emit("element_onpropertychange"),this._properties.taskType=e,this._updateTaskTypeIcon()}get loopType(){return this._properties.loopType}set loopType(e){this.emit("element_onpropertychange"),this._properties.loopType=e,this._updateLoopTypeIcon()}set taskName(e){this.emit("element_onpropertychange"),this._properties.activity.name=e.name,this._properties.name=e.name,e.id&&(this._properties.taskId=parseInt(e.id,10)),e.label&&(this.title=e.label)}get taskName(){return this._properties.name}get title(){return this._properties.title||""}set title(e){this._properties.title=e,this._updateTitleLabel()}get comments(){return this._properties.comments}set comments(e){this._properties.comments=e}get condition(){return this._properties.condition}set condition(e){this.emit("element_onpropertychange"),this._properties.condition=e}get role(){return this._properties.role}get roleId(){return this._properties.role.id}get roleName(){return this._properties.role.name}set role(e){this.emit("element_onpropertychange"),this._properties.role||(this._properties.role={}),this._properties.role.id=parseInt(e.id,10),this._properties.role.name=e.name}get groups(){return this._properties.groups}set groups(e){this.emit("element_onpropertychange"),this._properties.groups=e}get multiplyCount(){return this._properties.multiplyCount}set multiplyCount(e){this.emit("element_onpropertychange"),this._properties.multiplyCount=e}createDefaultGroup(){this._properties.groups||(this.groups=[])}objectIndex(e,t,s="id"){return(Array.isArray(t)?t:this._properties[t]||[]).findIndex(t=>parseInt(t[s],10)===parseInt(e[s],10))}setPropertyObject(e,t,s,i){var a=this.objectIndex(e,t);if(-1!==a&&this._properties[t])if(this.emit("element_onpropertychange"),Array.isArray(s)&&Array.isArray(i)){var n=0;s.forEach(e=>{this._properties[t][a][e]=i[n],n++})}else this._properties[t][a][s]=i}deleteBindingInIndex(e,t){this.emit("element_onpropertychange"),this._properties.events[e].bindings.splice(t,1)}createDefaultSchedule(){this.schedule||(this.schedule={})}get forms(){return this._properties.forms}set forms(e){this.emit("element_onpropertychange"),this._properties.forms=e}setSpecificFormInStepByIndex(e,t,s,i,a,n){this.emit("element_onpropertychange"),s?this._properties.forms[e][t]=s:this._properties.forms[e][t][i][a]=n}get multiInstanceAttributeName(){return this.multiInstance?this.multiInstance.attribute:void 0}insertForm(e){this.forms||(this._properties.forms=[]),this.forms.push(e)}get states(){return this._properties.states}set states(e){this.emit("element_onpropertychange"),this._properties.states=e}createDefaultStates(){this.states||(this._properties.states=[])}insertState(e){this.states||(this._properties.states=[]),this.states.push(e)}get events(){return this._properties.events}set events(e){this.emit("element_onpropertychange"),this._properties.events=e}setPropertyWithoutSave(e,t){this._properties[e]=t,"loopType"===e&&this._updateLoopTypeIcon(),"taskType"===e&&this._updateTaskTypeIcon()}setBindingsEventByIndex(e,t){this.emit("element_onpropertychange"),this._properties.events[e].bindings=t}setBindingEvent(e,t,s){-1===t?this.events[e].bindings.push(s):this._properties.events[e].bindings[t]=s}setSpecificBindingAttribute(e,t,s,i=null){var a=this.objectIndex(e,"events");if(-1!==a){var n=(this.events[a].bindings||[]).findIndex(e=>parseInt(e.busClaParId,10)===parseInt(t.id,10));-1!==n&&(this.emit("element_onpropertychange"),this.events[a].bindings[n].busClaParBndType=s,"V"===s&&i&&(this.events[a].bindings[n].busClaParBndValue=i),"E"!==s&&"P"!==s||!i||(this.events[a].bindings[n].attId=i.attId,this.events[a].bindings[n].attTooltip=i.attTooltip,this.events[a].bindings[n].attName=i.attName))}}createDefaultEvents(){this._properties.events||(this._properties.events=[])}insertEvent(e){this.events||(this._properties.events=[]),this.events.push(e)}get multiInstance(){return this._properties.multiInstance}set multiInstance(e){this.emit("element_onpropertychange"),this._properties.multiInstance=e}get multiInstanceType(){return this.multiInstance?this.multiInstance.type:void 0}set multiInstanceType(e){this.emit("element_onpropertychange"),"value"!==e||bt()(this.multiInstanceAttribute||{})||(delete this._properties.multiInstance.attributeId,delete this._properties.multiInstance.attribute),"attribute"===e&&this.multiInstanceValue&&delete this._properties.multiInstance.value,this._properties.multiInstance.type=e}get multiInstanceValue(){return this.multiInstance?this.multiInstance.value:void 0}set multiInstanceValue(e){this.emit("element_onpropertychange"),this._properties.multiInstance.value=e}get multiInstanceAttribute(){var e={},t=this.multiInstance||{};return t.attributeId&&t.attribute&&(e.id=this.multiInstance.attributeId,e.name=this.multiInstance.attribute),e}get schedule(){return this._properties.schedule}set schedule(e){this._properties.schedule=e}set scheduleId(e){this.emit("element_onpropertychange"),this._properties.schedule.id=e}get scheduleId(){return this.schedule?this.schedule.id:void 0}get scheduleName(){return this.schedule?this.schedule.scheduleName:void 0}set scheduleName(e){this._properties.schedule.scheduleName=e}set scheduleType(e){this.emit("element_onpropertychange"),this._properties.schedule.type=e}get scheduleType(){return this.schedule?this.schedule.type:void 0}set scheduleSubprocess(e){this.emit("element_onpropertychange"),this._properties.schedule.subprocess=e,this._properties.schedule.task="",this._properties.schedule.taskName=""}set scheduleSubprocessName(e){this._properties.schedule.subprocessName=e}get scheduleSubprocessName(){return this.schedule?this.schedule.subprocessName:void 0}get scheduleTask(){return this.schedule?this.schedule.task:void 0}set scheduleTask(e){this.emit("element_onpropertychange"),this._properties.schedule.task=e}get scheduleTaskName(){return this.schedule?this._properties.schedule.taskName:void 0}set scheduleTaskName(e){this._properties.schedule.taskName=e}deleteScheduleProperties(e){this.emit("element_onpropertychange"),e.forEach(e=>{delete this._properties.schedule[e]}),this._properties.schedule==={}&&delete this._properties.schedule}get taskId(){return this._properties.taskId||""}set taskId(e){this._properties.taskId=e}get color(){return this._properties.color||"#FFFFFF"}set color(e){this.emit("element_onpropertychange"),this._properties.color=e,this._setColors(this.color,".task__bg",".task__group__text",[".task__looptypeicon",".task__typeicon"])}get inputMessageRef(){return this._properties.inputMessageRef}get wsMethodName(){return this.inputMessageRef?this.inputMessageRef.wsMethodName:void 0}get imrAttrProc(){return this.inputMessageRef?this.inputMessageRef.attrProc:void 0}get imrAttrEnt(){return this.inputMessageRef?this.inputMessageRef.attrEnt:void 0}set inputMessageRef(e){this._properties.inputMessageRef=e}set wsMethodName(e){this.emit("element_onpropertychange"),this.inputMessageRef||(this.inputMessageRef={}),this._properties.inputMessageRef.wsMethodName=e}insertAttributeInputMsgRef(e,t){this.emit("element_onpropertychange"),this.inputMessageRef||(this._properties.inputMessageRef={}),this.inputMessageRef[e]||(this._properties.inputMessageRef[e]=[]),this.inputMessageRef[e].push(t)}cleanAttributesInputMsgRef(e){this.emit("element_onpropertychange"),this._properties.inputMessageRef[e]=[]}editAttributesInputMsgRef(e,t,s){this.inputMessageRef[e][t]&&(this.emit("element_onpropertychange"),this.inputMessageRef[e][t]=s)}deleteAttributeInputMsgRef(e,t){this.inputMessageRef[e][t]&&(this.emit("element_onpropertychange"),this.inputMessageRef[e].splice(t,1))}get outputMessageRef(){return this._properties.outputMessageRef}set outputMessageRef(e){this._properties.outputMessageRef=e}createDefaultBPMNAutoComplete(){this.outputMessageRef||(this.outputMessageRef=[]);this._properties.outputMessageRef.push({id:1,eventId:11,busClaId:102,busClaName:"BPMNAutoComplete",name:"ONREADY",order:0,WS:!0})}addWebServiceOutputMsgRef(e){this.emit("element_onpropertychange"),this.outputMessageRef.push(e)}editWebServiceOutputMsgRef(e,t){this.outputMessageRef[e]&&(this.emit("element_onpropertychange"),this.outputMessageRef[e]=t)}deleteWebServiceOutputMsgRef(e){this.outputMessageRef[e]&&(this.emit("element_onpropertychange"),this.outputMessageRef.splice(e,1))}cleanWebServicesOutputMsgRef(){this.outputMessageRef&&(this.emit("element_onpropertychange"),this.outputMessageRef=[])}deleteBindingWebServiceOutputMsgRef(e,t){this.outputMessageRef[e].bindings[t]&&(this.emit("element_onpropertychange"),this.outputMessageRef[e].bindings.splice(t,1))}setWebServicePropertyOutputMsgRef(e,t,s,i){if(this.outputMessageRef[e].bindings[t]){var a=this.outputMessageRef[e];if(this.emit("element_onpropertychange"),Array.isArray(s)&&Array.isArray(i))for(var n=0;n<i.length;n++)a.bindings[t][s[n]]=i[n];else a.bindings[t][s]=i}}deleteValueWebServiceProperty(e,t){this.outputMessageRef[e].bindings[t]&&delete this.outputMessageRef[e].bindings[t].busClaParBndValue}deleteAttributeWebServicesProperties(e,t){this.outputMessageRef[e].bindings[t]&&(delete this.outputMessageRef[e].bindings[t].attId,delete this.outputMessageRef[e].bindings[t].attTooltip,delete this.outputMessageRef[e].bindings[t].attName)}addBindingWebServiceOutputMsgRef(e,t){this.outputMessageRef[e]&&(this.emit("element_onpropertychange"),this.outputMessageRef[e].bindings||(this.outputMessageRef[e].bindings=[]),this.outputMessageRef[e].bindings.push(t))}drawElement(){this._box=this._viewport.rect(0,0,this._WIDTH,this._HEIGHT,8).attr({class:"task__bg",fill:this.color}),this._label=this.drawForeignObjLabel(0,0,this._WIDTH,this._HEIGHT,this.title,"task__group__text","text_".concat(this.id)),this._label.select("g").attr({class:"task__group"});var e=this._box.appendTo(this._viewport),t=e.getBBox(),s=this.drawSelectionBox(t),i=this._drawTaskTypeIcon(),a=this._drawLoopTypeIcon();this._graphic=this._viewport.g(s,e,this._label,i,a).mousedown(this.onElementMouseDown).attr({class:"task",id:"".concat(A.TASK,"_").concat(this._properties.id)}),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd),this._setColors(this.color,".task__bg",".task__group__text",[".task__looptypeicon",".task__typeicon"])}_drawTaskTypeIcon(){var e;switch(this.taskType.toUpperCase()){case"USER":e=de.parse('<g id="typeicon"><path class="task__typeicon" transform="scale(1, -1) translate(0, -100)" d="M496 668c-89 0-152-69-152-146l0 0 0 0c0-24 6-48 16-71 7-16 16-31 27-43-65-22-140-58-178-130l-2-4 0-231 578 0 0 231-2 4c-37 71-111 107-175 129 31 32 40 73 40 115l0 0 0 0c0 77-63 146-152 146z m-61-83c5 0 9 0 14-1 39-2 53-9 63-16 10-6 17-13 44-14l0 0 0 0c21 1 32 5 39 9 3 2 5 4 8 5 7-14 10-30 10-46 0-47-8-80-51-106l4-32c9-3 19-6 28-9 1-5 3-13 4-20 1-8 1-16 1-23-1-6-3-9-3-10-22-21-61-34-100-34-39 0-78 13-100 34 0 1-2 4-3 10 0 7 0 15 1 23 1 7 3 15 4 20 9 3 19 6 27 9l3 34c-2 2-4 4-7 6-9 7-21 23-29 41-8 19-13 40-13 57 0 20 5 39 15 56 2 1 4 1 6 2 7 3 18 5 35 5z m-75-225c0 0 0 0 0-1-2-9-2-20-1-30 1-11 4-22 13-31 31-31 78-45 124-45 46 0 93 14 124 45 10 9 12 20 13 31 2 10 1 21-1 30 0 1 0 1 0 1 48-21 93-50 118-95l0-187-83 0 0 132-35 0 0-132-272 0 0 132-35 0 0-132-83 0 0 187c25 45 70 74 118 95z" /></g>');break;case"SERVICE":e=de.parse('<g id="typeicon"><path class="task__typeicon" transform="scale(1, -1) translate(0, -100)" d="M413 631c0-19 0-37 0-56-16-4-30-10-44-18l-40 39-74-74 40-40c-8-13-14-28-18-43l-56 0 0-106 56 0c6-20 17-39 28-55l0 91-49-1 0 36 49 0 3 14c4 20 12 40 23 57l8 12-34 35 25 25 34-34 12 8c18 11 38 19 58 24l14 3 0 48 36 0 0-48 14 0 80 0c-9 10-46 24-59 28l0 55c-39 0-70 0-106 0z m100-101l0-55c-16-5-31-11-44-19l-40 40-74-75 39-40c-7-13-13-28-17-43l-57 0 0-106 57 1c5-16 11-30 18-44l-40-40 75-74 41 40c13-8 28-14 44-18l0-57c36 0 74 0 105 0l0 58c16 4 31 10 44 18l41-40 74 75-41 40c8 14 14 28 18 44l56 0 0 105-56 0c-5 16-11 30-19 43l39 39-75 74-39-39c-14 8-28 14-44 18l1 55-106 0z m35-35l36 0-1-48 15-3c20-4 40-12 58-23l11-8 34 34 25-25-33-34 8-12c12-18 20-37 24-57l3-14 49 0 0-35-49-1-3-14c-4-20-12-40-23-57l-8-12 36-35-26-26-35 36-12-8c-18-12-38-20-58-24l-14-3 0-51c-9 0-20 0-35 0l0 50-15 3c-20 4-40 12-58 24l-11 8-36-36-26 25 36 35-8 12c-12 18-20 38-24 58l-3 14-50-1 0 36 50 0 3 14c4 21 12 40 23 58l8 12-35 34 25 25 35-34 12 8c18 12 37 19 58 24l14 3 0 48z m18-128c-43 0-79-36-79-79 0-44 36-79 79-79 43 0 79 35 79 79 0 43-36 79-79 79z m0-35c25 0 44-20 44-44 0-25-19-44-44-44-24 0-44 19-44 44 0 24 20 44 44 44z" /></g>');break;case"RECEIVE":e=de.parse('<g id="typeicon"><path class="task__typeicon" transform="scale(1, -1) translate(0, -100)" d="M95 618l0-535 811 0 0 535-811 0z m83-35l644 0-322-212-322 212z m-48-10l370-244 371 244 0-455-741 0 0 455z" /></g>');break;case"MANUAL":e=de.parse('<g id="typeicon"><path class="task__typeicon" transform="scale(1, -1) translate(0, -100)" d="M460 659c-11 0-22-5-31-10l0 0 0 0c-47-31-209-143-245-168l0 0 0 0c-32-22-54-55-66-95l0 0 0 0c-13-41-11-86-11-124l0 0 0 0c0-28 1-53 8-83 0 0 0 0 0 0 11-44 31-75 61-95 29-19 65-26 105-26 147-1 293-1 439 0l0 0 0 0c16 0 31 6 41 18 10 12 14 28 14 45 0 11-2 22-5 32l16 0c16 0 30 4 40 14 11 9 16 22 19 35l0 0c4 19 2 38-6 53 17 2 31 8 41 19 10 13 13 29 13 47 0 18-4 35-14 49-10 13-27 23-46 23l0 0 0 0c-7 0-13 0-21 0 4 9 6 19 6 31l0 0 0 0c0 17-5 35-15 48-10 14-27 23-46 23-112 0-223-1-317-1 5 5 9 10 15 15 16 17 31 32 39 42 20 25 23 59 6 83-8 13-21 22-34 24-2 0-4 1-5 1l0 0c-1 0-1 0-1 0z m0-35c0 0 1 0 1-1 3 0 6-1 10-8l0 0 0 0c6-9 6-29-4-42l0 0 0 0c-4-5-21-23-37-39-16-16-32-31-39-40-8-9-5-16-3-21 2-5 4-10 14-12 3-1 4-1 5-1 0 0 1 0 3 0 2 0 5 0 9 0 113-1 225 0 338 0l0 0 0 0c9 0 13-3 18-9 4-6 8-16 8-28 0-12-3-19-7-24-3-4-8-6-19-6l-242 0 0-35 242 0 0 0c34 0 51 0 76 0 9 0 13-3 18-9 4-6 7-16 7-28l0 0c0-13-2-21-5-24-3-4-8-7-20-7-4 0-34 0-47 0 0 0 0 0-1 0-90 0-180 0-270 0l0 0 0-35 0 0c0 0 191 0 271 0 10 0 15-4 20-12 5-8 7-20 5-34l0 0 0 0c-2-9-5-14-8-17-3-2-7-4-17-4-90 0-181 0-271 0l0 0 0-35 0 0 205 0 0 0c7 0 10-2 14-7 3-4 6-13 6-25l0 0 0 0c0-11-3-19-6-23-3-4-6-5-14-5-146-1-292-1-438 0l0 0 0 0c-37 0-66 6-87 20-21 14-37 37-46 74l0 1 0 0c-6 26-7 47-7 74l0 0c0 39-1 80 9 114 11 34 28 59 53 76l0 0c36 25 199 138 244 167l0 0c5 3 8 4 11 4 0 1 1 1 1 1z" /></g>');break;case"SCRIPT":e=de.parse('<g id="typeicon"><path class="task__typeicon" transform="scale(1, -1) translate(0, -100)" d="M380 661l-4-2-2-1c-58-35-98-67-125-98-26-31-39-62-40-92 0-60 44-105 83-145 39-40 74-78 78-109 1-16-3-32-20-54-17-22-49-48-99-78l-74-43 458 0 5 3 1 0c53 31 89 60 112 89 23 29 32 59 29 88-6 56-52 97-90 137-39 39-70 76-70 112 0 17 7 37 29 62 21 25 57 55 113 88l0 0 73 43-457 0z m13-46l282 0c-25-19-45-37-60-55-26-31-39-62-39-92-1-60 43-105 82-145 39-40 74-78 78-109 1-16-2-32-20-54-16-21-47-46-94-74l-283 0c20 15 36 30 47 45 23 29 33 59 30 88-6 56-52 97-91 137-38 39-70 76-69 112 0 17 7 37 28 62 21 25 56 53 109 85z m-66-80l0-21 220 0 0 21-220 0z m-9-115l0-22 229 0 0 22-229 0z m104-116l0-21 221 0 0 21-221 0z m31-115l0-22 229 0 0 22-229 0z" /></g>');break;case"SEND":e=de.parse('<g id="typeicon"><path class="task__typeicon" transform="scale(1, -1) translate(0, -100)" d="M99 608l401-227 401 227-802 0z m1-84l0-448 802 0 0 448-402-224-400 224z" /></g>');break;case"BUSINESSRULE":e=de.parse('<g id="typeicon"><path class="task__typeicon" transform="scale(1, -1) translate(0, -100)" d="M89 659l0-617 822 0 0 617-822 0z m35-209l159 0 0-173-159 0 0 173z m194 0l558 0 0-173-558 0 0 173z m-194-208l159 0 0-165-159 0 0 165z m194 0l558 0 0-165-558 0 0 165z" /></g>');break;case"NONE":e=de.parse('<g id="typeicon"></g>')}var t=e.select("g");t.transform("s0.03, T".concat(4,",",23));var s=e.select(".task__typeicon");return s&&s.attr({fill:this._foregroundColor}),t}_updateTaskTypeIcon(){this._graphic.select("#typeicon").remove(),this._drawTaskTypeIcon().appendTo(this._graphic)}_drawLoopTypeIcon(){var e;switch(this.loopType.toUpperCase()){case"MULTIINSTANCE":e=de.parse('<g id="looptypeicon"><path class="task__looptypeicon" transform="scale(1, -1) translate(0, -100)" d="M250 650l0-600 100 0 0 600-100 0z m200 0l0-600 100 0 0 600-100 0z m200 0l0-600 100 0 0 600-100 0z" /></g>');break;case"NONE":e=de.parse('<g id="looptypeicon"></g>')}var t=e.select("g");t.transform("s0.022, T".concat(this._WIDTH/2-10,",").concat(this._HEIGHT-8));var s=e.select(".task__looptypeicon");return s&&s.attr({fill:this._foregroundColor}),t}_updateLoopTypeIcon(){this._graphic.select("#looptypeicon").remove(),this._drawLoopTypeIcon().appendTo(this._graphic)}_updateTitleLabel(){this._graphic.select(".task__group__text").node.innerText=this.title}deleteFormIfExist(e){var t=!1;return this.forms&&this.forms.forEach(s=>{var i=s.EForms,a=s.PForms,n=s.entity,r=s.process,o=i.findIndex(t=>t.id===e.id),l=a.findIndex(t=>t.id===e.id);if(-1!==o){i.splice(o,1);var h=Number.parseInt(n,10)-1;s.entity=h.toString(),t=!0}if(-1!==l){a.splice(l,1);var c=Number.parseInt(r,10)-1;s.process=c.toString(),t=!0}}),t}}function Ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Pt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function At(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class kt extends ft{constructor(e,t,s,i,a,n,r,o){if(super(e,t,a,s,i,n,r,o),this._radius=A.EVENT_SIZE.radius,!n){this._properties.type="none";var l=this.elementType.split("Event");this._properties.activity={id:t,name:"".concat(l[0]," Event")}}this.drawElement()}get isAttached(){return this._properties.isAttached}get radius(){return this._radius}get eventName(){return this._properties.activity.name}set name(e){this._properties.activity.name=e}get eventType(){return this._properties.type}get message(){return this._properties.message}get timer(){return this._properties.timer}set timer(e){this._properties.timer=e}get trasitions(){return this._properties.trasitions||[]}set message(e){this._properties.message=e}get webServiceMessage(){return this.message?this.message.webService:void 0}get catchThrowMessage(){return this.message?this.message.catchThrow:void 0}set catchThrowMessage(e){this.emit("element_onpropertychange"),this._createDefaultMessage(),this._properties.message.catchThrow=e}getFactorFrequency(e){switch(e){case"MINUTES":return 1e3;case"HOURS":return 6e4;case"DAYS":return 144e4;case"WEEKS":return 1008e4}return 0}addTransition(e){0===this.trasitions.length&&(this._properties.trasitions=[]),this.trasitions.push(e)}get processAttributesMessage(){return this.message?this.message.attrProc:[]}get entityAttributesMessage(){return this.message?this.message.attrEnt:[]}set processAttributesMessage(e){this._properties.message.attrProc=e}set entityAttributesMessage(e){this._properties.message.attrEnt=e}set webServiceMessage(e){this.emit("element_onpropertychange"),this._createDefaultMessage(),this._properties.message.webService=e}get webServices(){return this._properties.events}set webServices(e){this.emit("element_onpropertychange"),this._properties.events=e}_createDefaultMessage(){if(!this.message){var e=this.elementType,t=e===A.START_EVENT||e===A.INTERMEDIATE_EVENT?"catch":"throw";this._properties.message={catchThrow:t}}}get dateTimer(){return this.timer.date}set dateTimer(e){this._properties.timer.date=e}get frequencyTimer(){return this.timer?this.timer.frequency:void 0}set frequencyTimer(e){this.emit("element_onpropertychange"),this._createDefaultFrequencyTimer(),this._properties.timer.frequency=e}get attributeTimer(){return this.timer?this.timer.attribute:void 0}set attributeTimer(e){this.emit("element_onpropertychange"),this._createDefaultAttributeTimer(),this._properties.timer.attribute=e}_createDefaultDateTimer(){this.timer||(this.timer={}),this.dateTimer||(this.dateTimer={})}_createDefaultFrequencyTimer(){this.timer||(this.timer={}),this.frequencyTimer||(this._properties.timer.frequency={})}_createDefaultAttributeTimer(){this.timer||(this.timer={}),this.attributeTimer||(this._properties.timer.attribute={})}setDateTimerByType(e,t){this.emit("element_onpropertychange"),this._createDefaultDateTimer(),this._properties.timer.date[t]=e}deleteTimerProperty(e){this.timer[e]&&delete this._properties.timer[e]}_defaultAttrsMessageProperties(e){this._createDefaultMessage(),this.message[e]||(this._properties.message[e]=[])}existMessageAttribute(e,t){return((this._properties.message||{})[t]||[]).find(t=>parseInt(t.id,10)===parseInt(e,10))}findMessageAttributeIndex(e,t){for(var s=this.message[t]||[],i=0;i<s.length;i++){var a=s[i];if(parseInt(a.id,10)===parseInt(e,10))return i}return-1}addMessageAttribute(e,t){var s="entity"===t?"attrEnt":"attrProc";this.emit("element_onpropertychange"),this._defaultAttrsMessageProperties(s),this._properties.message[s].push(e)}editMessageAttribute(e,t,s){var i="entity"===t?"attrEnt":"attrProc",a=this.findMessageAttributeIndex(e,i);-1!==a&&(this.emit("element_onpropertychange"),this._properties.message[i][a]=s)}deleteMessageAttribute(e,t){var s="entity"===t?"attrEnt":"attrProc",i=this.findMessageAttributeIndex(e,s);-1!==i&&(this.emit("element_onpropertychange"),this._properties.message[s].splice(i,1))}deleteAllMessageAttributes(e){var t="entity"===e?"attrEnt":"attrProc";this.emit("element_onpropertychange"),this._properties.message[t]=[]}_defaultWebServices(){this.message||this._createDefaultMessage(),this._properties.events=[{WS:!0,busClaId:102,busClaName:"BPMNAutoComplete",eventId:11,id:1,name:"ONREADY",order:0}]}maxId(e){var t=0;return e.forEach(e=>{parseInt(e.id,10)>t&&(t=parseInt(e.id,10))}),t}existWebService(e){return(this.webServices||[]).find(t=>parseInt(t.id,10)===parseInt(e,10))}existWSBindingParameter(e,t){var s,i=this.getWebServiceIndexById(e);-1!==i&&(s=(this.webServices[i].bindings||[]).find(e=>parseInt(e.busClaParId,10)===parseInt(t,10)));return s}getWebServiceIndexById(e){return this.webServices.findIndex(t=>parseInt(t.id,10)===parseInt(e,10))}getBindingIndexById(e,t){return(this.webServices[e].bindings||[]).findIndex(e=>parseInt(e.busClaParId,10)===parseInt(t,10))}addWebService(e){this.emit("element_onpropertychange"),this.webServices||this._defaultWebServices();var t=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(s),!0).forEach((function(t){At(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Pt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({id:this.maxId(this.webServices)+1,order:this.webServices.length,WS:!0,bindings:[]},e);this._properties.events.push(t)}editWebService(e,t){var s,i=this.getWebServiceIndexById(e);return-1!==i&&(this.emit("element_onpropertychange"),(s=this.webServices[i]).busClaId=parseInt(t.id,10),s.busClaName=t.name,s.bindings=[]),s}deleteWebService(e){var t=this.getWebServiceIndexById(e);-1!==t&&(this.emit("element_onpropertychange"),2===this.webServices.length?this._properties.events=[]:this._properties.events.splice(t,1))}editBindingParameter(e,t,s){var i=this.getWebServiceIndexById(e);if(-1!==i){var a=this.getBindingIndexById(i,t);if(-1!==a){var n=Object.entries(s);this.emit("element_onpropertychange"),n.forEach(e=>{var t=Ct(e,2),s=t[0],n=t[1];this.webServices[i].bindings[a][s]=n})}}}deletePropertyOfBindingParameter(e,t,s){var i=this.getWebServiceIndexById(e);if(-1!==i){var a=this.getBindingIndexById(i,t);-1!==a&&s.forEach(e=>{this.webServices[i].bindings[a][e]&&delete this.webServices[i].bindings[a][e]})}}deleteBindingParameter(e,t){var s=this.getWebServiceIndexById(e);if(-1!==s){var i=this.getBindingIndexById(s,t);-1!==i&&(this.emit("element_onpropertychange"),this.webServices[s].bindings.splice(i,1),0===this.webServices[s].bindings.length&&delete this.webServices[s].bindings)}}addBindingParameter(e,t){var s=this.getWebServiceIndexById(e);-1!==s&&(this.emit("element_onpropertychange"),this.webServices[s].bindings||(this.webServices[s].bindings=[]),this.webServices[s].bindings.push(t))}}class wt extends kt{constructor(e,t,s,i,a,n){super(A.START_EVENT,e,t,s,i,a,n,[A.DELETE,A.TASK,A.SUBPROCESS,A.CONNECTOR,A.INTERMEDIATE_EVENT,A.GATEWAY,A.TEXT]),this.initElement()}set name(e){this.emit("element_onpropertychange"),super.name=e,this.updateTextLabel("start_event__group__text",e)}set type(e){this.emit("element_onpropertychange"),this._properties.type=e,this._updateDetailTypeIcon()}drawElement(){var e=this._viewport.circle(20,20,this._radius).attr({class:"start_event__bg"}).appendTo(this._viewport),t=e.getBBox(),s=this.drawSelectionBox(t),i=this.drawForeignObjLabel(-40,48,120,80,this.eventName,"start_event__group__text","text_".concat(this.id));i.select("g").attr({class:"start_event__group"});var a=this._drawEventDetailTypeIcon();this._graphic=this._viewport.g(s,e,i,a).mousedown(this.onElementMouseDown).attr({class:"start_event",id:"".concat(A.START_EVENT,"_").concat(this._properties.id)}),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}_drawEventDetailTypeIcon(){var e;switch(this.eventType.toUpperCase()){case"MESSAGE":(e=de.parse('<g id="typeicon"><path  class="start_event__typeicon__message" transform="scale(1, -1) translate(0, -100)" d="M95 618l0-535 811 0 0 535-811 0z m83-35l644 0-322-212-322 212z m-48-10l370-244 371 244 0-455-741 0 0 455z" /></g>').select("g")).transform("s0.02, T".concat(10,",",25));break;case"TIMER":(e=de.parse('<g id="typeicon"><g><path class="start_event__typeicon" d="M47.5,0C21.3,0,0,21.3,0,47.5S21.3,95,47.5,95S95,73.7,95,47.5S73.7,0,47.5,0z M47.5,90.7c-23.8,0-43.2-19.4-43.2-43.2 S23.7,4.3,47.5,4.3s43.2,19.4,43.2,43.2S71.3,90.7,47.5,90.7z"/><path class="start_event__typeicon" d="M47.5,19.4c1.2,0,2.2-1,2.2-2.2v-5.3c0-1.2-1-2.2-2.2-2.2s-2.2,1-2.2,2.2v5.3C45.3,18.5,46.3,19.4,47.5,19.4z"/><path class="start_event__typeicon" d="M30.5,22.4c0.4,0.7,1.1,1.1,1.9,1.1c0.4,0,0.7-0.1,1.1-0.3c1-0.6,1.4-1.9,0.8-2.9l-2.6-4.6c-0.6-1-1.9-1.4-2.9-0.8 c-1,0.6-1.4,1.9-0.8,2.9L30.5,22.4z"/><path class="start_event__typeicon" d="M22.4,30.5l-4.6-2.6c-1-0.6-2.3-0.2-2.9,0.8c-0.6,1-0.2,2.3,0.8,2.9l4.6,2.6c0.3,0.2,0.7,0.3,1.1,0.3 c0.7,0,1.5-0.4,1.9-1.1C23.8,32.4,23.4,31.1,22.4,30.5z"/><path class="start_event__typeicon" d="M19.4,47.5c0-1.2-1-2.2-2.2-2.2h-5.3c-1.2,0-2.2,1-2.2,2.2s1,2.2,2.2,2.2h5.3C18.5,49.7,19.4,48.7,19.4,47.5z"/><path class="start_event__typeicon" d="M20.2,60.8l-4.6,2.6c-1,0.6-1.4,1.9-0.8,2.9c0.4,0.7,1.1,1.1,1.9,1.1c0.4,0,0.7-0.1,1.1-0.3l4.6-2.6 c1-0.6,1.4-1.9,0.8-2.9C22.6,60.5,21.3,60.2,20.2,60.8z"/><path class="start_event__typeicon" d="M33.5,71.8c-1-0.6-2.3-0.2-2.9,0.8L28,77.2c-0.6,1-0.2,2.3,0.8,2.9c0.3,0.2,0.7,0.3,1.1,0.3c0.7,0,1.5-0.4,1.9-1.1 l2.6-4.6C34.8,73.7,34.5,72.4,33.5,71.8z"/><path class="start_event__typeicon" d="M47.5,75.6c-1.2,0-2.2,1-2.2,2.2v5.3c0,1.2,1,2.2,2.2,2.2s2.2-1,2.2-2.2v-5.3C49.6,76.5,48.7,75.6,47.5,75.6z"/><path class="start_event__typeicon" d="M64.5,72.6c-0.6-1-1.9-1.4-2.9-0.8s-1.4,1.9-0.8,2.9l2.6,4.6c0.4,0.7,1.1,1.1,1.9,1.1c0.4,0,0.7-0.1,1.1-0.3 c1-0.6,1.4-1.9,0.8-2.9L64.5,72.6z"/><path class="start_event__typeicon" d="M79.3,63.4l-4.6-2.6c-1-0.6-2.3-0.2-2.9,0.8c-0.6,1-0.2,2.3,0.8,2.9l4.6,2.6c0.3,0.2,0.7,0.3,1.1,0.3 c0.7,0,1.5-0.4,1.9-1.1C80.7,65.3,80.3,64,79.3,63.4z"/><path class="start_event__typeicon" d="M83,45.4h-5.3c-1.2,0-2.2,1-2.2,2.2s1,2.2,2.2,2.2H83c1.2,0,2.2-1,2.2-2.2S84.2,45.4,83,45.4z"/><path class="start_event__typeicon" d="M73.7,34.5c0.4,0,0.7-0.1,1.1-0.3l4.6-2.6c1-0.6,1.4-1.9,0.8-2.9c-0.6-1-1.9-1.4-2.9-0.8l-4.7,2.6c-1,0.6-1.4,1.9-0.8,2.9 C72.2,34.1,72.9,34.5,73.7,34.5z"/><path class="start_event__typeicon" d="M66.3,14.9c-1-0.6-2.3-0.2-2.9,0.8l-2.6,4.6c-0.6,1-0.2,2.3,0.8,2.9c0.3,0.2,0.7,0.3,1.1,0.3c0.7,0,1.5-0.4,1.9-1.1 l2.6-4.6C67.7,16.8,67.4,15.5,66.3,14.9z"/><path class="start_event__typeicon" d="M47.5,49.7h13c1.2,0,2.2-1,2.2-2.2s-1-2.2-2.2-2.2H49.6V28.8c0-1.2-1-2.2-2.2-2.2s-2.2,1-2.2,2.2v18.7 C45.3,48.7,46.3,49.7,47.5,49.7z"/></g></g>').select("g")).transform("s0.23, T".concat(9,",",9));break;case"SIGNAL":(e=de.parse('<g id="typeicon"><polygon class="start_event__signalicon" points="50 15, 100 100, 0 100"/></g>').select("g")).transform("s0.17, T".concat(11.5,",",8.5));break;case"NONE":e=de.parse('<g id="typeicon"></g>').select("g")}return e}_updateDetailTypeIcon(){this._graphic.select("#typeicon").remove(),this._drawEventDetailTypeIcon().appendTo(this._graphic)}}class Mt extends kt{constructor(e,t,s,i,a,n){super(A.END_EVENT,e,t,s,i,a,n,[A.DELETE,A.TEXT]),this.initElement()}set name(e){this.emit("element_onpropertychange"),super.name=e,this.updateTextLabel("end_event__group__text",e)}set type(e){this.emit("element_onpropertychange"),this._properties.type=e,this._updateDetailTypeIcon()}drawElement(){var e=this._viewport.circle(20,20,this._radius).attr({class:"end_event__bg"}).appendTo(this._viewport),t=e.getBBox(),s=this.drawSelectionBox(t),i=this.drawForeignObjLabel(-40,48,120,80,this.eventName,"end_event__group__text","text_".concat(this.id));i.select("g").attr({class:"end_event__group"});var a=this._drawEventDetailTypeIcon();this._graphic=this._viewport.g(s,e,i,a).mousedown(this.onElementMouseDown).attr({class:"end_event",id:"".concat(A.END_EVENT,"_").concat(this._properties.id)}),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}_drawEventDetailTypeIcon(){var e;switch(this.eventType.toUpperCase()){case"MESSAGE":(e=de.parse('<g id="typeicon"><path class="end_event__typeicon" transform="scale(1, -1) translate(0, -100)" d="M99 608l401-227 401 227-802 0z m1-84l0-448 802 0 0 448-402-224-400 224z" /></g>').select("g")).transform("s0.02, T".concat(10,",",25));break;case"SIGNAL":(e=de.parse('<g id="typeicon"><polygon class="end_event__signalicon" points="50 15, 100 100, 0 100"/></g>').select("g")).transform("s0.17, T".concat(11.5,",",8.5));break;case"TERMINATE":(e=de.parse('<g id="typeicon"><circle class="end_event__typeicon" cx="0" cy="0" r="12"/></g>').select("g")).transform("s1, T".concat(20,",",20));break;case"ERROR":(e=de.parse('<g id="typeicon"><path class="end_event__typeicon" transform="scale(1, -1) translate(0, -100)" d="M0,0c39,114,77,228,116,342c42-55,85-110,128-166c34,70,68,139,102,209c-27-124-55-248-82-372 c-45,51-89,103-134,154C87,111,43,55,0,0z"/></g>').select("g")).transform("s0.07, T".concat(8,",",25));break;case"NONE":e=de.parse('<g id="typeicon"></g>').select("g")}return e}_updateDetailTypeIcon(){this._graphic.select("#typeicon").remove(),this._drawEventDetailTypeIcon().appendTo(this._graphic)}}class Lt extends kt{constructor(e,t,s,i,a,n){super(A.INTERMEDIATE_EVENT,e,t,s,i,a,n,[A.DELETE,A.TASK,A.SUBPROCESS,A.END_EVENT,A.INTERMEDIATE_EVENT,A.GATEWAY,A.TEXT,A.CONNECTOR]),this.initElement()}set name(e){this.emit("element_onpropertychange"),super.name=e,this.updateTextLabel("intermediate_event__group__text",e)}set type(e){this.emit("element_onpropertychange"),this._properties.type=e,"message"===e?this._properties.message={catchThrow:"catch"}:delete this._properties.message,this._updateDetailTypeIcon()}get catchThrowMessage(){return this.message?this.message.catchThrow:void 0}set catchThrowMessage(e){var t=e!==this.catchThrowMessage;super.catchThrowMessage=e,this._updateDetailTypeIcon(),t&&this.updateMessageProperties(e)}updateMessageProperties(e){"throw"===e?(delete this._properties.message.attrProc,delete this._properties.message.attrEnt,delete this._properties.message.webService):delete this._properties.events}setTypeWithoutSave(e){this._properties.type=e,this._updateDetailTypeIcon()}get isAttached(){return this._properties.isAttached}get target(){return this._properties.target}set isAttached(e){this._properties.isAttached=e}set target(e){this._properties.target=e}drawElement(){var e=this._viewport.circle(20,20,this._radius).attr({class:"intermediate_event__bg"}),t=this._viewport.circle(20,20,this._radius-4).attr({class:"intermediate_event__inner"}),s=e.appendTo(this._viewport),i=s.getBBox(),a=this.drawSelectionBox(i),n=this.drawForeignObjLabel(-40,48,120,80,this.eventName,"intermediate_event__group__text","text_".concat(this.id));n.select("g").attr({class:"intermediate_event__group"});var r=this._drawEventDetailTypeIcon();this._graphic=this._viewport.g(a,s,t,n,r).attr({class:"intermediate_event",id:"".concat(A.INTERMEDIATE_EVENT,"_").concat(this.properties.id)}).mousedown(this.onElementMouseDown),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}_drawEventDetailTypeIcon(){var e,t;switch(this.eventType.toUpperCase()){case"MESSAGE":e=de.parse('<g id="typeicon">\n            <path \n              class="start_event__typeicon__message" \n              transform="scale(1, -1) \n              translate(0, -100)" \n              d="M95 618l0-535 811 0 0 535-811 0z m83-35l644 \n              0-322-212-322 212z m-48-10l370-244 371 244 0-455-741 0 0 455z" \n            /></g>'),"throw"===this.catchThrowMessage&&(e=de.parse('<g id="typeicon">\n              <path \n                class="task__typeicon" \n                transform="scale(1, -1) \n                translate(0, -100)" \n                d="M99 608l401-227 401 227-802 0z \n                m1-84l0-448 802 0 0 448-402-224-400 224z" \n              />\n            </g>')),(t=e.select("g")).transform("s0.02, T".concat(10,",",25));break;case"TIMER":(t=(e=de.parse('<g id="typeicon"><g>\n          <path \n            class="start_event__typeicon" \n            d="M47.5,0C21.3,0,0,21.3,0,47.5S21.3,95,47.5,95S95,73.7,95,47.5S73.7,0,47.5,0z M47.5,90.7c-23.8,0-43.2-19.4-43.2-43.2 S23.7,4.3,47.5,4.3s43.2,19.4,43.2,43.2S71.3,90.7,47.5,90.7z"/>\n            <path \n              class="start_event__typeicon" \n              d="M47.5,19.4c1.2,0,2.2-1,2.2-2.2v-5.3c0-1.2-1-2.2-2.2-2.2s-2.2,1-2.2,2.2v5.3C45.3,18.5,46.3,19.4,47.5,19.4z"/>\n            <path \n              class="start_event__typeicon" \n              d="M30.5,22.4c0.4,0.7,1.1,1.1,1.9,1.1c0.4,0,0.7-0.1,1.1-0.3c1-0.6,1.4-1.9,0.8-2.9l-2.6-4.6c-0.6-1-1.9-1.4-2.9-0.8 c-1,0.6-1.4,1.9-0.8,2.9L30.5,22.4z"/>\n            <path class="start_event__typeicon" d="M22.4,30.5l-4.6-2.6c-1-0.6-2.3-0.2-2.9,0.8c-0.6,1-0.2,2.3,0.8,2.9l4.6,2.6c0.3,0.2,0.7,0.3,1.1,0.3 c0.7,0,1.5-0.4,1.9-1.1C23.8,32.4,23.4,31.1,22.4,30.5z"/><path class="start_event__typeicon" d="M19.4,47.5c0-1.2-1-2.2-2.2-2.2h-5.3c-1.2,0-2.2,1-2.2,2.2s1,2.2,2.2,2.2h5.3C18.5,49.7,19.4,48.7,19.4,47.5z"/><path class="start_event__typeicon" d="M20.2,60.8l-4.6,2.6c-1,0.6-1.4,1.9-0.8,2.9c0.4,0.7,1.1,1.1,1.9,1.1c0.4,0,0.7-0.1,1.1-0.3l4.6-2.6 c1-0.6,1.4-1.9,0.8-2.9C22.6,60.5,21.3,60.2,20.2,60.8z"/><path class="start_event__typeicon" d="M33.5,71.8c-1-0.6-2.3-0.2-2.9,0.8L28,77.2c-0.6,1-0.2,2.3,0.8,2.9c0.3,0.2,0.7,0.3,1.1,0.3c0.7,0,1.5-0.4,1.9-1.1 l2.6-4.6C34.8,73.7,34.5,72.4,33.5,71.8z"/><path class="start_event__typeicon" d="M47.5,75.6c-1.2,0-2.2,1-2.2,2.2v5.3c0,1.2,1,2.2,2.2,2.2s2.2-1,2.2-2.2v-5.3C49.6,76.5,48.7,75.6,47.5,75.6z"/><path class="start_event__typeicon" d="M64.5,72.6c-0.6-1-1.9-1.4-2.9-0.8s-1.4,1.9-0.8,2.9l2.6,4.6c0.4,0.7,1.1,1.1,1.9,1.1c0.4,0,0.7-0.1,1.1-0.3 c1-0.6,1.4-1.9,0.8-2.9L64.5,72.6z"/><path class="start_event__typeicon" d="M79.3,63.4l-4.6-2.6c-1-0.6-2.3-0.2-2.9,0.8c-0.6,1-0.2,2.3,0.8,2.9l4.6,2.6c0.3,0.2,0.7,0.3,1.1,0.3 c0.7,0,1.5-0.4,1.9-1.1C80.7,65.3,80.3,64,79.3,63.4z"/><path class="start_event__typeicon" d="M83,45.4h-5.3c-1.2,0-2.2,1-2.2,2.2s1,2.2,2.2,2.2H83c1.2,0,2.2-1,2.2-2.2S84.2,45.4,83,45.4z"/><path class="start_event__typeicon" d="M73.7,34.5c0.4,0,0.7-0.1,1.1-0.3l4.6-2.6c1-0.6,1.4-1.9,0.8-2.9c-0.6-1-1.9-1.4-2.9-0.8l-4.7,2.6c-1,0.6-1.4,1.9-0.8,2.9 C72.2,34.1,72.9,34.5,73.7,34.5z"/><path class="start_event__typeicon" d="M66.3,14.9c-1-0.6-2.3-0.2-2.9,0.8l-2.6,4.6c-0.6,1-0.2,2.3,0.8,2.9c0.3,0.2,0.7,0.3,1.1,0.3c0.7,0,1.5-0.4,1.9-1.1 l2.6-4.6C67.7,16.8,67.4,15.5,66.3,14.9z"/><path class="start_event__typeicon" d="M47.5,49.7h13c1.2,0,2.2-1,2.2-2.2s-1-2.2-2.2-2.2H49.6V28.8c0-1.2-1-2.2-2.2-2.2s-2.2,1-2.2,2.2v18.7 C45.3,48.7,46.3,49.7,47.5,49.7z"/></g></g>')).select("g")).transform("s0.22, T".concat(9.5,",",9.5));break;case"SIGNAL":(t=(e=de.parse('<g id="typeicon"><polygon class="start_event__signalicon" points="50 15, 100 100, 0 100"/></g>')).select("g")).transform("s0.17, T".concat(11.5,",",8.5));break;case"NONE":t=(e=de.parse('<g id="typeicon"></g>')).select("g");break;case"ERROR":(t=(e=de.parse('<g id="typeicon"><path class="end_event__typeicon" transform="scale(1, -1) translate(0, -100)" d="M0,0c39,114,77,228,116,342c42-55,85-110,128-166c34,70,68,139,102,209c-27-124-55-248-82-372 c-45,51-89,103-134,154C87,111,43,55,0,0z"/></g>')).select("g")).transform("s0.07, T".concat(8,",",25));break;case"MULTIPLE":(t=(e=de.parse('<g id="typeicon"><polygon class="intermediate_event__multipleicon" points="294,3 585.246118,214.602691 474,556.983037 114,556.983037 2.753882,214.602691"/></g>')).select("g")).transform("s0.04, T".concat(8,",",8))}return t}_updateDetailTypeIcon(){this._graphic.select("#typeicon").remove(),this._drawEventDetailTypeIcon().appendTo(this._graphic)}}class xt extends ft{constructor(e,t,s,i,a,n){super(A.GATEWAY,e,i,t,s,a,n,[A.DELETE,A.TASK,A.SUBPROCESS,A.END_EVENT,A.INTERMEDIATE_EVENT,A.GATEWAY,A.TEXT,A.CONNECTOR]),a||(this._properties.type="exclusive",this._properties.executionType="automatic",this._properties.activity={id:e,name:this._properties.name}),this.drawElement(),this.initElement()}get type(){return this._properties.type}set type(e){this.emit("element_onpropertychange"),"exclusive"===this._properties.type&&"exclusive"!==e&&this.emit("delete_exclusive"),this._properties.type=e,"exclusive"===e||"inclusive"===e||delete this.properties.executionType,"parallel"!==e&&"event"!==e||this.emit("change_parallel_event"),this._updateTypeIcon()}get name(){return this._properties.activity.name}set name(e){this.emit("element_onpropertychange"),this._properties.activity.name=e,this._properties.name=e,this.updateTextLabel("gateway__group__text",e)}get executionType(){return this._properties.executionType}set executionType(e){this.emit("element_onpropertychange"),this._properties.executionType=e}getAllConnectorAssociated(e){return ze(A.CONNECTOR,e).filter(e=>e.type===A.CONNECTOR_TYPE_TRANSITION&&parseInt(this.id,10)===parseInt(e.from,10))}deleteAllExecutionOrderConnector(e){this.getAllConnectorAssociated(e).forEach(e=>{e.deletePropertyByName("executionOrder")})}changeAllConnectorsKind(e){this.getAllConnectorAssociated(e).forEach(e=>{e.properties.kind="none"})}drawElement(){var e=this._viewport.polygon(20,0,0,20,20,A.GATEWAY_SIZE.width,A.GATEWAY_SIZE.height,20).attr({class:"gateway__bg"}).appendTo(this._viewport),t=e.getBBox(),s=this.drawSelectionBox(t),i=this._drawGatewayTypeIcon(),a=this.drawForeignObjLabel(-40,48,120,80,this.name,"gateway__group__text","text_".concat(this.id));a.select("g").attr({class:"gateway__group"}),this._graphic=this._viewport.g(s,e,i,a).mousedown(this.onElementMouseDown).attr({class:"gateway",id:"".concat(A.GATEWAY,"_").concat(this._properties.id)}),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}_drawGatewayTypeIcon(){var e;switch(this.type.toUpperCase()){case"EXCLUSIVE":(e=de.parse('<g id="typeicon"><path class="gateway__typeicon--exclusive" d="M38,12.8L35.2,10L24,21.2L12.8,10L10,12.8L21.2,24L10,35.2l2.8,2.8L24,26.8L35.2,38l2.8-2.8L26.8,24L38,12.8z"/></g>').select("g")).transform("s0.5, T".concat(8,",",8));break;case"INCLUSIVE":(e=de.parse('<g id="typeicon"><path class="gateway__typeicon--inclusive" d="M 25, 50 a 25,25 0 1,1 50,0 a 25,25 0 1,1 -50,0"/></g>').select("g")).transform("s0.4, T".concat(0,",",0));break;case"PARALLEL":(e=de.parse('<g id="typeicon"><path class="gateway__typeicon--parallel" d="M38,26H26v12h-4V26H10v-4h12V10h4v12h12V26z"/></g>').select("g")).transform("s0.6, T".concat(5.5,",",5.5));break;case"EVENT":(e=de.parse('<g id="typeicon"><path class="gateway__typeicon--event" transform="scale(1, -1) translate(0, -100)" d="M499 802c-220 4-425-177-448-396-24-185 78-380 247-461 160-80 368-56 501 66 134 118 190 318 128 486-57 167-217 293-393 303-12 1-23 2-35 2z m-5-49c202 7 391-161 407-362 19-178-92-361-262-420-166-61-368-2-468 145-103 144-99 356 18 490 74 90 188 146 305 147z m8-44c-186 6-358-158-361-344-9-169 116-334 283-367 155-33 328 46 397 190 71 140 39 327-83 430-64 57-150 91-236 91z m-2-48c164 4 314-144 311-308 3-152-119-297-272-312-143-19-295 73-336 213-43 134 14 295 138 364 48 28 103 43 159 43z m0-87c-72-52-143-104-215-156 27-84 55-169 82-253 89 0 177 0 266 0 28 84 55 169 82 253-71 52-143 104-215 156z m0-30c62-45 124-90 187-135-24-74-48-147-72-220-77 0-153 0-230 0-24 73-48 146-72 220 63 45 125 90 187 135z"/></g>').select("g")).transform("s0.03, T".concat(5,",",27));break;case"NONE":e=de.parse('<g id="typeicon"></g>').select("g")}return e}_updateTypeIcon(){this._graphic.select("#typeicon").remove(),this._drawGatewayTypeIcon().appendTo(this._graphic)}}class Nt extends ft{constructor(e,t,s,i,a,n){super(A.SUBPROCESS,e,i,t,s,a,n,[A.DELETE,A.TASK,A.SUBPROCESS,A.END_EVENT,A.INTERMEDIATE_EVENT,A.GATEWAY,A.TEXT,A.CONNECTOR,A.OPEN_SUBPROCESS]),this._WIDTH=A.TASK_SIZE.width,this._HEIGHT=A.TASK_SIZE.height,a||(this._properties.activity={id:e,name:"Default_Process"},this._properties.name="Default_Process","Offline"!==A.ENV&&(this._properties.activitySetId=1),this._properties.type="embedded",this._properties.loopType="none",this._properties.color=this._foregroundColor),this.drawElement(),this.initElement()}get name(){return this._properties.name}set name(e){this.emit("element_onpropertychange"),this._properties.activity.name=e.name,this._properties.name=e.name;var t="reusable"===this.type?"subprocessId":"activitySetId";this._properties[t]=parseInt(e.id,10),this._updateNameLabel()}get type(){return this._properties.type}get subprocessId(){return this._properties.activitySetId||this._properties.subprocessId}set type(e){this.emit("element_onpropertychange");var t="reusable"===this.type?"subprocessId":"activitySetId",s=this._properties[t];this.deletePropertyByName(t),"reusable"===e?this._properties.subprocessId=s:this._properties.activitySetId=s,this._properties.type=e,this._updateType()}get loopType(){return this._properties.loopType}set loopType(e){this.emit("element_onpropertychange"),this._properties.loopType=e,this._updateLoopTypeIcon()}get multiplyCount(){return this._properties.multiplyCount}set multiplyCount(e){this.emit("element_onpropertychange"),this._properties.multiplyCount=e}get color(){return this._properties.color||"#D6F6FF"}set color(e){this.emit("element_onpropertychange"),this._properties.color=e,this._setColors(this.color,".subprocess__bg",".subprocess__group__text",[".subprocess__subprocess_icon",".subprocess__looptypeicon"])}get standard(){return this._properties.standard}set standard(e){this._properties.standard=e}get standardDocumentation(){return this._properties.standard.conditionDoc}get standardCondition(){return this._properties.standard?this._properties.standard.condition:void 0}set standardDocumentation(e){this.emit("element_onpropertychange"),this.standard||(this.standard={}),this._properties.standard.conditionDoc=e}set standardCondition(e){this.emit("element_onpropertychange"),this.standard||(this.standard={}),this._properties.standard.condition=e}get reusable(){return this._properties.reusable}set reusable(e){this._properties.reusable=e}get reusableEntity(){var e={};return(this.reusable||{}).entityId&&(e={id:this._properties.reusable.entityId,name:this._properties.reusable.entityAttrName}),e}get reusableForms(){return this.reusable?this._properties.reusable.forms:void 0}set reusableEntity(e){this.emit("element_onpropertychange"),this.reusable||(this._properties.reusable={}),null===e?(delete this._properties.reusable.entityId,delete this._properties.reusable.entityAttrName):(this._properties.reusable.entityId=parseInt(e.id,10),this._properties.reusable.entityAttrName=e.name)}get execution(){return this.reusable?this._properties.reusable.execution:void 0}get skipFirst(){return this.reusable?this._properties.reusable.skipFirst:void 0}set execution(e){this.emit("element_onpropertychange"),this._properties.reusable.execution=e}set skipFirst(e){this.emit("element_onpropertychange"),this._properties.reusable.skipFirst=e}get multiInstance(){return this._properties.multiInstance}get multiInstanceType(){return this.multiInstance?this.multiInstance.type:void 0}set multiInstanceType(e){this.emit("element_onpropertychange"),this._properties.multiInstance.type=e,"attribute"===e&&void 0!==this.multiInstanceValue&&delete this._properties.multiInstance.value,"value"===e&&this.multiInstanceAttribute!=={}&&(delete this._properties.multiInstance.attribute,delete this._properties.multiInstance.attributeId)}get multiInstanceValue(){return this.multiInstance?this.multiInstance.value:void 0}set multiInstanceValue(e){this.emit("element_onpropertychange"),this._properties.multiInstance.value=e}get multiInstanceAttribute(){var e={};return this.multiInstance&&(e={id:this.multiInstance.attributeId,name:this.multiInstance.attribute}),e}set multiInstanceAttribute(e){this.emit("element_onpropertychange"),this._properties.multiInstance.attributeId=parseInt(e.id,10),this._properties.multiInstance.attribute=e.name}set multiInstance(e){this.emit("element_onpropertychange"),this._properties.multiInstance=e}addReusableForm(e){this.emit("element_onpropertychange"),this.reusable||(this._properties.reusable={}),this.reusableForms||(this.properties.reusable.forms=[]),this.reusableForms.push(e)}deleteReusableForm(e){this.properties.reusable.forms[e]&&(this.emit("element_onpropertychange"),this.properties.reusable.forms.splice(e,1))}editReusableForm(e,t){this._properties.reusable.forms[e]&&(this.emit("element_onpropertychange"),this._properties.reusable.forms[e]=t)}changeReusableFormPosition(e,t,s,i,a){var n=this._properties.reusable.forms.filter(e=>e.formType===a),r=this._properties.reusable.forms.filter(e=>e.formType!==a);n[t]&&n[e]&&(n[e]=s,n[e].order=e,n[t]=i,n[t].order=t),this._properties.reusable.forms=n.concat(r)}cleanReusableForm(e){this.emit("element_onpropertychange"),this.properties.reusable.forms=this.properties.reusable.forms.filter(t=>t.formType!==e)}drawElement(){var e=de.parse('<g id="icon"><path d="M56,0H8C3.6,0,0,3.6,0,8v48c0,4.4,3.6,8,8,8h48c4.4,0,8-3.6,8-8V8C64,3.6,60.4,0,56,0z M58.7,56c0,1.5-1.2,2.7-2.7,2.7H8 c-1.5,0-2.7-1.2-2.7-2.7V8c0-1.5,1.2-2.7,2.7-2.7h48c1.5,0,2.7,1.2,2.7,2.7V56z" /><path d="M50.7,29.3h-16v-16c0-1.5-1.2-2.7-2.7-2.7c-1.5,0-2.7,1.2-2.7,2.7v16h-16c-1.5,0-2.7,1.2-2.7,2.7c0,1.5,1.2,2.7,2.7,2.7 h16v16c0,1.5,1.2,2.7,2.7,2.7c1.5,0,2.7-1.2,2.7-2.7v-16h16c1.5,0,2.7-1.2,2.7-2.7C53.3,30.5,52.1,29.3,50.7,29.3z" /></g>').select("g").attr({class:"subprocess__subprocess_icon"});e.transform("s0.2, T".concat(Math.floor(this._WIDTH/2)-8,",").concat(Math.floor(this._HEIGHT-20))),this._box=this._viewport.rect(0,0,this._WIDTH,this._HEIGHT,8).attr({class:"subprocess__bg",fill:this.color}),this._label=this.drawForeignObjLabel(0,0,this._WIDTH,this._HEIGHT,this.name,"subprocess__group__text","text_".concat(this.id)),this._label.select("g").attr({class:"subprocess__group"});var t=this._box.appendTo(this._viewport),s=t.getBBox(),i=this.drawSelectionBox(s),a=this._drawLoopTypeIcon();this._graphic=this._viewport.g(i,t,this._label,e,a).mousedown(this.onElementMouseDown).attr({class:"subprocess",id:"".concat(A.SUBPROCESS,"_").concat(this._properties.id)}),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd),this._updateType(),this._setColors(this.color,".subprocess__bg",".subprocess__group__text",[".subprocess__subprocess_icon",".subprocess__looptypeicon"])}_drawLoopTypeIcon(){var e;switch(this.loopType.toUpperCase()){case"STANDARD":e=de.parse('<g id="looptypeicon"><path class="subprocess__looptypeicon" transform="scale(1, -1) translate(0, -100)" d="M529 645c-126 1-247-86-283-207-28-87-12-187 42-260-44 8-89 17-134 26-4-20-8-40-12-59 81-16 162-32 242-47 16 80 32 160 47 240-19 4-39 8-59 11-9-48-19-97-28-145-69 82-68 214 2 295 69 86 200 111 295 57 92-47 143-159 118-259-22-104-124-184-230-182-28 2-42-38-19-53 20-13 45-4 67-3 124 19 229 125 245 250 19 119-46 244-152 300-43 23-92 36-141 36z" /></g>');break;case"MULTIINSTANCE":e=de.parse('<g id="looptypeicon"><path class="subprocess__looptypeicon" transform="scale(1, -1) translate(0, -100)" d="M250 650l0-600 100 0 0 600-100 0z m200 0l0-600 100 0 0 600-100 0z m200 0l0-600 100 0 0 600-100 0z" /></g>');break;case"NONE":e=de.parse('<g id="looptypeicon"></g>')}var t=e.select("g");t.transform("s0.025, T".concat(24,",",Math.floor(this._HEIGHT-8)));var s=e.select(".subprocess__looptypeicon");return s&&s.attr({fill:this._foregroundColor}),t}_updateLoopTypeIcon(){this._graphic.select("#looptypeicon").remove(),this._drawLoopTypeIcon().appendTo(this._graphic)}_updateNameLabel(){this._graphic.select(".subprocess__group__text").node.innerText=this.name}_updateType(){"REUSABLE"===this._properties.type.toUpperCase()?this._graphic.addClass("subprocess--reusable"):this._graphic.removeClass("subprocess--reusable")}}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class Dt extends ft{constructor(e,t,s,i,a,n){super(A.POOL,e,i,t,s,a,n,[A.DELETE,A.LANE,A.TEXT]),this.resizable=!0,this._poolBox=null,this._poolNameBox=null,this._label=null,this._minHeight=0;var r=Ke(this._viewport);a?(this._height=this._properties.size.height,this._width=this._properties.size.width):(this._properties.size={width:r.width>0?r.width+120:A.POOL_SIZE.width,height:r.height>0?r.height+80:A.POOL_SIZE.height},this.properties.lanes=[],this._height=this._properties.size.height,this._width=this._properties.size.width),this.drawElement(),this.initElement()}get width(){return this._width}get height(){return this._height}set height(e){this._height=e}get name(){return this._properties.name}set name(e){this.emit("element_onpropertychange"),this._properties.name=e,this._updateNameLabel()}set minHeight(e){this._minHeight=e}drawElement(){this._poolBox=this._viewport.rect(0,0,this._width,this._height).attr({class:"pool__outer_box"}),this._poolNameBox=this._viewport.rect(0,0,30,this._height).attr({class:"pool__name_box"});var e=this._poolBox.appendTo(this._viewport).getBBox(),t=this.drawSelectionBox(e);this._label=this.drawForeignObjLabel(-this.height,0,this.height,30,this.name,"pool__group__text","pool_".concat(this.id));var s=this._label.select("g");s.attr({class:"pool__group"}),s.transform("R-90"),this._graphic=this._viewport.g(t,this._poolBox,this._poolNameBox,this._label).attr({class:"pool",id:"".concat(A.POOL,"_").concat(this._properties.id)}).mousedown(this.onElementMouseDown),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd),this._updateNameLabel()}onHandleDragStart(){this._graphic.undrag(),this.removeResizeHandles(),this.drawResizeHandles(),this._contextMenu.hide(),this.emit("element_resize_start")}onHandleDrag(e,t,s,i,a){var n=this._selectionBox,r=Ot(this._handles,1)[0],o=n.transform().diffMatrix.invert();o.e=0,o.f=0;var l=Math.round(o.x(e,t)+this.SELECTSIZE/2),h=Math.round(o.y(e,t)+this.SELECTSIZE/2),c=this._viewport.getMousePoint(a,0,0),p=Math.round(c.x-this._graphic.matrix.e),d=Math.round(c.y-this._graphic.matrix.f);d>=this._minHeight&&p>0&&d>0&&this.emit("element_resizing",p,d),r.transform("t".concat([l-p+this._width,h-d+this._height]))}onHandleDragEnd(){this.emit("element_resize_end"),this._properties.size={width:this._width,height:this._height},this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}resize(e,t){this._width=e,this._height=t,this._poolBox.attr({width:e,height:t}),this._poolNameBox.attr({height:t}),this._selectionBox.attr({width:e+this.SELECTSIZE,height:t+this.SELECTSIZE}),this._updateNameLabel(),this._properties.size={width:this._width,height:this._height}}_updateNameLabel(){var e=this._poolNameBox.getBBox();this._graphic.select("#pool_".concat(this.id)).attr({x:-e.height,width:e.height}),this.updateTextLabel("pool__group__text",this._properties.name)}}class Rt extends ft{constructor(e,t,s,i,a){super(A.LANE,e,i,t,s,a,!1,[A.DELETE]),a&&(this._height=this._properties.size.height,this._width=this._properties.size.width,a.name&&""!==a.name||(a.name=A.LANE)),this._minHeight=160,this._maxHeight=Number.POSITIVE_INFINITY,this._nameBoxWidth=30,this._laneBox=null,this._laneNameBox=null,this._label=null,this.drawElement(),this.initElement()}get name(){return this._properties.name}set name(e){this.emit("element_onpropertychange"),this._properties.name=e,this._updateNameLabel()}get width(){return this._width}get height(){return this._height}set maxHeight(e){this._maxHeight=e}get maxHeight(){return this._maxHeight}drawElement(){this._laneBox=this._viewport.rect(this._nameBoxWidth,0,this._width,this._height).attr({class:"lane__outer_box"}),this._laneNameBox=this._viewport.rect(this._nameBoxWidth,0,this._nameBoxWidth,this._height).attr({class:"lane__name_box"});var e=this._laneBox.appendTo(this._viewport).getBBox(),t=this.drawSelectionBox(e);this._label=this.drawForeignObjLabel(-this.height,this._nameBoxWidth,this.height,this._nameBoxWidth,this.name,"lane__group__text","lane_".concat(this.id));var s=this._label.select("g");s.attr({class:"lane__group"}),s.transform("R-90"),this._graphic=this._viewport.g(t,this._laneBox,this._laneNameBox,this._label).attr({class:"lane",id:"".concat(A.LANE,"_").concat(this._properties.id)}).mousedown(this.onElementMouseDown).click(this.onElementClick),this._updateNameLabel()}_updateNameLabel(){var e=this._laneNameBox.getBBox();this._graphic.select("#lane_".concat(this.id)).attr({x:-e.height,width:e.height}),this.updateTextLabel("lane__group__text",this.name)}resizeWidth(e){this._width=e,this._laneBox.attr({width:e}),this._selectionBox.attr({width:e+this.SELECTSIZE})}resizeHeight(e){this._laneBox.attr({height:e}),this._laneNameBox.attr({height:e}),this._selectionBox.attr({height:e+this.SELECTSIZE}),this._height=e,this._updateNameLabel()}_onSelected(){this._drawResizeBar(),this.emit("element_selected")}_onDeselected(){this._removeResizeBar(),this.emit("element_unselected")}_drawResizeBar(){var e=this._selectionBox.getBBox();this._handle=this._viewport.rect(e.x2-e.width/2-this._hSize/2,e.y2-this._hSize/2,this._hSize,this._hSize).attr({class:"resize__handle--row",id:"resize__handle"});var t=this._viewport.g(this._handle).drag(this.onHandleDrag,this.onHandleDragStart,this.onHandleDragEnd).attr({class:"resize",id:"resize_bar"});this._graphic.append(t)}_removeResizeBar(){this._graphic.select("#resize_bar")&&this._graphic.select("#resize_bar").remove()}onHandleDragStart(){this.emit("lane_resize_start")}onHandleDrag(e,t,s,i,a){var n=this._selectionBox.transform().diffMatrix.invert();n.e=0,n.f=0;var r=Math.round(n.y(e,t)+this.SELECTSIZE/2),o=this._viewport.getMousePoint(a,0,0),l=Math.round(o.y-this._graphic.matrix.f);l>=this._minHeight&&l<=this._maxHeight&&this.emit("lane_resizing",l),this._handle.transform("t".concat([0,r-l+this._height]))}onHandleDragEnd(){this.emit("lane_resize_end"),this._removeResizeBar(),this._drawResizeBar()}}class Bt extends ft{constructor(e,t,s,i,a,n){super(A.GROUP,e,i,t,s,a,n,[A.DELETE,A.TEXT]),this.resizable=!0,a||(this._properties.size={width:A.GROUP_SIZE.width,height:A.GROUP_SIZE.height},this._properties.name=""),this.drawElement(),this.initElement()}get name(){return this._properties.name}set name(e){this.emit("element_onpropertychange"),this._properties.name=e,this._updateNameLabel()}drawElement(){var e=this._viewport.rect(0,0,this._properties.size.width,this._properties.size.height,8).attr({class:"group__box"}),t=this._viewport.rect(5,5,this._properties.size.width-20,this._properties.size.height-20,8).attr({class:"group__box__hotspot"}),s=e.appendTo(this._viewport),i=s.getBBox(),a=this.drawSelectionBox(i),n=this.drawLabel(this.name,"group__text",-20,i);this._graphic=this._viewport.g(a,s,t,n).attr({class:"group",id:"".concat(A.GROUP,"_").concat(this._properties.id)}).mousedown(this.onElementMouseDown),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}onResizingStart(){this._contextMenu.hide()}onResizing(e,t){this._width=e,this._height=t,this._selectionBox.attr({width:this._width+this.SELECTSIZE,height:this._height+this.SELECTSIZE}),this._graphic.select(".group__box").attr({width:this._width,height:this._height}),this._graphic.select(".group__box__hotspot").attr({width:Math.abs(this._width-20),height:Math.abs(this._height-20)}),this._graphic.select(".group__text").attr({x:this._width/2})}onResizeEnd(){}_updateNameLabel(){var e=this._graphic.select(".group__text");e.attr("text",this.name),e.attr("x",Math.round(this._properties.size.width/2))}}class Vt extends ft{constructor(e,t,s,i,a,n){super(A.TEXT,e,i,t,s,a,n,[A.DELETE]),this.resizable=!0,a||(this._properties.size={width:A.TEXT_SIZE.width,height:A.TEXT_SIZE.height},this._properties.text=""),this.drawElement(),this.initElement()}get text(){return this._properties.text}set text(e){this.emit("element_onpropertychange"),this._properties.text=e,this.updateTextLabel("annotation__box__text",this._properties.text)}drawElement(){var e=this._viewport.rect(0,0,this._properties.size.width,this._properties.size.height).attr({class:"annotation__bg"}),t=this.drawForeignObjLabel(0,0,this._properties.size.width,this._properties.size.height,this._properties.text,"annotation__box__text","text_box"),s=e.appendTo(this._viewport),i=s.getBBox(),a=this.drawSelectionBox(i),n=this._drawTextBorder(i);this._graphic=this._viewport.g(a,s,t,n).attr({class:"annotation",id:"".concat(A.TEXT,"_").concat(this._properties.id)}).mousedown(this.onElementMouseDown),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}onResizingStart(){this._contextMenu.hide()}onResizing(e,t){this._width=e,this._height=t;var s=this._graphic.select(".annotation__bg"),i=this._graphic.select("#text_box"),a=this._graphic.select(".annotation__border");a&&a.remove(),this._selectionBox.attr({width:this._width+this.SELECTSIZE,height:this._height+this.SELECTSIZE}),s.attr({width:this._width,height:this._height}),i.attr({width:this._width,height:this._height});var n=s.getBBox();this.graphic.add(this._drawTextBorder(n))}onResizeEnd(){}_drawTextBorder(e){return this._viewport.polyline([e.x+10,e.y,e.x,e.y,e.x,e.y,e.x,e.y2,e.x,e.y2,e.x+10,e.y2]).attr({class:"annotation__border"})}}class Ft extends ft{constructor(e,t,s,i,a,n,r,o){super(e,t,a,s,i,n,r,o),this._shapeNamePrefix="",this._typeId=e;var l=this.elementType.split("Data");this._properties.name===this._typeId&&(this._properties.name="Data ".concat(l[1]))}get dataName(){return this._properties.name}get state(){return this._properties.state||""}set state(e){this.emit("element_onpropertychange"),this._properties.state=e;var t=this._getCurrentState(e);this.updateTextLabel("".concat(this._shapeNamePrefix,"__group__text__state"),t)}set name(e){this.emit("element_onpropertychange"),this._properties.name=e,this.updateTextLabel("".concat(this._shapeNamePrefix,"__group__text"),e)}get collection(){return this._properties.collection||!1}set collection(e){this.emit("element_onpropertychange"),this._properties.collection=e,this._updateCollIcon()}get capacity(){return this._properties.capacity||""}set capacity(e){this.emit("element_onpropertychange"),this._properties.capacity=e}get unlimit(){return this._properties.unlimit||!1}set unlimit(e){this.emit("element_onpropertychange"),this._properties.unlimit=e,e&&delete this._properties.capacity}_getCurrentState(e){return void 0===e||""===e?"":"[".concat(e,"]")}drawElement(e,t,s){this._shapeNamePrefix=t;var i=ue.a.parse('<g id="icon">'.concat(e,"</g>")).select("g").attr({class:"".concat(t,"__icon")});i.transform(s);var a=this._viewport.rect(0,0,A.DATA_SIZE.width,A.DATA_SIZE.height).attr({stroke:"none",fill:"none"}),n=i.appendTo(this._viewport),r=a.getBBox(),o=this.drawSelectionBox(r),l=this._drawCollectionIcon(),h=this.drawForeignObjLabel(-40,48,120,80,this._properties.name,this._getCurrentState(this._properties.state),"".concat(t,"__group__text"),"text_".concat(this.id));h.select("g").attr({class:"".concat(t,"__group")}),this._graphic=this._viewport.g(o,n,l,h,a).mousedown(this.onElementMouseDown).attr({class:t,id:"".concat(this._typeId,"_").concat(this._properties.id)}),this._isMovable&&this._graphic.drag(this.onElementMove,this.onElementMoveStart,this.onElementMoveEnd)}_drawCollectionIcon(){var e;switch(this.collection){case!0:e=ue.a.parse('<g id="collIcon"><path class="data__collIcon" transform="scale(1, -1) translate(0, -100)" d="M250 650l0-600 100 0 0 600-100 0z m200 0l0-600 100 0 0 600-100 0z m200 0l0-600 100 0 0 600-100 0z" /></g>');break;case!1:case"":case void 0:e=ue.a.parse('<g id="collIcon"></g>')}var t=e.select("g");return t.transform("s0.020, T10,34"),t}_updateCollIcon(){this._graphic.select("#collIcon").remove(),this._drawCollectionIcon().appendTo(this._graphic)}drawForeignObjLabel(e,t,s,i,a,n,r,o){var l='<g><foreignObject \n      x="'.concat(e,'"\n      y="').concat(t,'"\n      width="').concat(s,'" \n      height="').concat(i,'"\n      id="').concat(o,'">\n    <p class="').concat(r,'">').concat(a,'</p>\n    <p class="').concat(r,'__state">').concat(n,"</p>\n    </foreignObject></g>");return ue.a.parse(l)}}class Ut extends Ft{constructor(e,t,s,i,a,n){super(A.DATA_OBJECT,e,t,s,i,a,n,[A.DELETE,A.TEXT,A.CONNECTOR]),this.drawElement('<path class="data_object__icon__fill" d="M31.3,3.7c-9.2,0-18.4,0-27.6,0c0,19.4,0,38.9,0,58.3c14.3,0,28.6,0,42.9,0c0-14.3,0-28.6,0-42.9 c-5.1,0-10.2,0-15.3,0C31.3,14,31.3,8.9,31.3,3.7z" /> <path class="data_object__icon__fill" d="M35.1,4.7c0,3.6,0,7.1,0,10.7c3.5,0,6.9,0,10.4,0C42,11.9,38.6,8.3,35.1,4.7z" /> <path d="M35.6,0C23.8,0,11.9,0,0,0c0,21.9,0,43.9,0,65.8c16.8,0,33.6,0,50.4,0c0-16.9,0-33.8,0-50.7C45.4,10.1,40.5,5.1,35.6,0z M35.1,4.7c3.5,3.6,6.9,7.1,10.4,10.7c-3.5,0-6.9,0-10.4,0C35.1,11.9,35.1,8.3,35.1,4.7z M46.6,62.1c-14.3,0-28.6,0-42.9,0 c0-19.4,0-38.9,0-58.3c9.1,0,18.4,0,27.6,0c0,5.2,0,10.3,0,15.5c5.1,0,10.2,0,15.3,0C46.6,33.5,46.6,47.8,46.6,62.1z" />',"data_object","s0.60 t8"),this.initElement()}}class Wt extends Ft{constructor(e,t,s,i,a,n){super(A.DATA_INPUT,e,t,s,i,a,n,[A.DELETE,A.TEXT,A.CONNECTOR]),this.drawElement('<polygon class="data_input__icon__fill" points="8.9 19 17.6 19 17.6 24.4 25.2 17.3 17.6 10.3 17.6 15.7 8.9 15.7"/> <polygon class="data_input__icon__fill" points="34.6 4.7 34.6 15.3 44.9 15.3"/> <path class="data_input__icon__fill" d="m30.9 3.7h-27.2v57.6h42.3v-42.3h-15.1v-15.3zm-14.9 24.5v-7.6h-8.7v-6.6h8.7v-7.6l11.6 10.9-11.6 10.9z"/> <path d="m35.2 0h-35.2v65h49.7v-50.1c-4.8-5-9.6-9.9-14.5-14.9zm-0.6 4.7l10.3 10.6h-10.3v-10.6zm11.4 56.6h-42.3v-57.6h27.2v15.3h15.1v42.3z"/> <path d="M16,8.4V14H7.3v6.6H16v7.6l11.6-10.8L16,6.4V8.4z M17.6,10.3l7.6,7.1l-7.6,7.1V19H8.9v-3.3h8.7V10.3z"/>',"data_input","s0.60 t8"),this.initElement()}}class zt extends Ft{constructor(e,t,s,i,a,n){super(A.DATA_OUTPUT,e,t,s,i,a,n,[A.DELETE,A.TEXT]),this.drawElement('<path class="data_output__icon__fill" d="M30.9,3.7c-9.1,0-18.2,0-27.2,0v57.6H46V19H30.9V3.7z M16,28.2v-7.6H7.3V14H16V6.4l11.6,10.9L16,28.2z"/> <polygon class="data_output__icon__fill" points="34.6 4.7 34.6 15.3 44.9 15.3"/> <path d="m35.2 0h-35.2v65h49.7v-50.1c-4.8-5-9.6-9.9-14.5-14.9zm-0.6 4.7l10.3 10.6h-10.3v-10.6zm11.4 56.6h-42.3v-57.6h27.2v15.3h15.1v42.3z"/> <polygon points="16 14 7.3 14 7.3 20.6 16 20.6 16 28.2 27.6 17.3 16 6.4"/>',"data_output","s0.60 t8"),this.initElement()}}class Ht extends Ft{constructor(e,t,s,i,a,n){super(A.DATA_STORE,e,t,s,i,a,n,[A.DELETE,A.TEXT,A.CONNECTOR]),this.drawElement('<path class="data_store__icon__fill" d="M33.6,15.7c-3.7,0.8-8.4,1.2-13.2,1.2c-4.8,0-9.5-0.4-13.2-1.2c-1.9-0.4-3.5-0.9-4.8-1.6 c-0.1-0.1-0.3-0.2-0.4-0.2v2.5c0.1,0.3,0.5,0.8,1.4,1.3c1,0.5,2.4,1,4.2,1.4c3.5,0.7,8.1,1.1,12.8,1.1c4.6,0,9.3-0.4,12.8-1.1 c1.7-0.4,3.2-0.8,4.2-1.4c0.9-0.5,1.3-1,1.4-1.3v-2.5c-0.1,0.1-0.3,0.2-0.4,0.2C37.1,14.8,35.5,15.3,33.6,15.7z"/><path class="data_store__icon__fill" d="M33.6,10.3c-3.7,0.8-8.4,1.2-13.2,1.2c-4.8,0-9.5-0.4-13.2-1.2C5.4,9.9,3.8,9.4,2.5,8.8 C2.4,8.7,2.2,8.6,2.1,8.5V11c0.1,0.3,0.5,0.8,1.4,1.3c1,0.5,2.4,1,4.2,1.4c3.5,0.7,8.1,1.1,12.8,1.1c4.6,0,9.3-0.4,12.8-1.1 c1.7-0.4,3.2-0.8,4.2-1.4c0.9-0.5,1.3-1,1.4-1.3V8.5c-0.1,0.1-0.3,0.2-0.4,0.2C37.1,9.4,35.5,9.9,33.6,10.3z"/><path class="data_store__icon__fill" d="M3.5,6.9c1,0.5,2.4,1,4.2,1.4c3.5,0.7,8.1,1.1,12.8,1.1c4.6,0,9.3-0.4,12.8-1.1c1.7-0.4,3.2-0.8,4.2-1.4 c0.8-0.4,1.2-0.8,1.4-1.1c-0.2-0.3-0.6-0.7-1.4-1.1c-1-0.5-2.4-1-4.2-1.3c-3.5-0.8-8.1-1.2-12.8-1.2c-4.6,0-9.3,0.4-12.8,1.2 C6,3.7,4.5,4.2,3.5,4.6C2.8,5.1,2.3,5.5,2.2,5.8C2.3,6.1,2.8,6.5,3.5,6.9z"/><path class="data_store__icon__fill" d="M20.4,0C20.4,0,20.3,0,20.4,0C20.3,0,20.4,0,20.4,0C20.4,0,20.4,0,20.4,0z"/><path class="data_store__icon__fill" d="M33.6,21.1c-3.7,0.8-8.4,1.2-13.2,1.2c-4.8,0-9.5-0.4-13.2-1.2c-1.9-0.4-3.5-0.9-4.8-1.6 c-0.1-0.1-0.3-0.2-0.4-0.2v14.6c0.1,0.3,0.5,0.8,1.4,1.3c1,0.5,2.4,1,4.2,1.4c2.7,0.6,6,0.9,9.5,1.1c1,0,2,0.1,3.1,0.1c0,0,0,0,0,0 c0.1,0,0.3,0,0.4,0c0.5,0,1,0,1.5,0c3.5-0.1,6.9-0.4,9.8-0.9c0.4-0.1,0.9-0.2,1.3-0.3c1.7-0.4,3.2-0.8,4.2-1.4 c0.9-0.5,1.3-1,1.4-1.3V19.2c-0.1,0.1-0.3,0.2-0.4,0.2C37.1,20.2,35.5,20.6,33.6,21.1z"/><path d="M40.8,5.4c-0.3-1.1-1.3-2-2.5-2.6c-1.3-0.7-2.9-1.2-4.8-1.6c-3-0.6-6.7-1-10.6-1.2c-0.1,0-0.1,0-0.2,0c-0.8,0-1.6,0-2.4,0 c0,0,0,0,0,0c0,0-0.1,0-0.1,0c-4.7,0-9.4,0.4-13,1.2c-1.9,0.4-3.5,1-4.8,1.6C1.3,3.4,0.4,4.3,0.1,5.4C0,5.5,0,5.6,0,5.7v0.1 c0,0.1,0,0.1,0,0.1c0,8.8,0,19,0,28.3v0.1c0.3,1.3,1.3,2.1,2.5,2.8c1.3,0.7,2.9,1.2,4.8,1.6c3.7,0.8,8.4,1.2,13.2,1.2 c4.8,0,9.5-0.4,13.2-1.2c1.9-0.4,3.5-0.9,4.8-1.6c1.2-0.7,2.2-1.5,2.5-2.8v-0.1c0-9.7,0-18.7,0-28.2V5.8V5.7 C40.9,5.6,40.8,5.5,40.8,5.4z M3.5,4.6c1-0.5,2.4-1,4.2-1.3c3.5-0.8,8.1-1.2,12.8-1.2c4.6,0,9.3,0.4,12.8,1.2 c1.7,0.4,3.2,0.8,4.2,1.3c0.8,0.4,1.2,0.8,1.4,1.1c-0.2,0.3-0.6,0.7-1.4,1.1c-1,0.5-2.4,1-4.2,1.4C29.7,9,25.1,9.4,20.5,9.4 c-4.6,0-9.3-0.4-12.8-1.1C6,7.9,4.5,7.5,3.5,6.9C2.8,6.5,2.3,6.1,2.2,5.8C2.3,5.5,2.8,5.1,3.5,4.6z M38.8,33.9 c-0.1,0.3-0.5,0.8-1.4,1.3c-1,0.5-2.4,1-4.2,1.4c-0.4,0.1-0.8,0.2-1.3,0.3c-2.9,0.5-6.3,0.8-9.8,0.9c-0.5,0-1,0-1.5,0 c-0.1,0-0.1,0-0.2,0c-0.1,0-0.1,0-0.2,0c0,0,0,0,0,0c-1,0-2.1,0-3.1-0.1c-3.5-0.1-6.8-0.5-9.5-1.1c-1.7-0.4-3.2-0.8-4.2-1.4 c-1-0.5-1.3-1-1.4-1.3V19.2c0.1,0.1,0.3,0.2,0.4,0.2c1.3,0.7,2.9,1.1,4.8,1.6c3.7,0.8,8.4,1.2,13.2,1.2c4.8,0,9.5-0.4,13.2-1.2 c1.9-0.4,3.5-0.9,4.8-1.6c0.1-0.1,0.3-0.2,0.4-0.2V33.9z M38.8,16.4c-0.1,0.3-0.5,0.8-1.4,1.3c-1,0.5-2.4,1-4.2,1.4 c-3.5,0.7-8.1,1.1-12.8,1.1c-4.6,0-9.3-0.4-12.8-1.1c-1.7-0.4-3.2-0.8-4.2-1.4c-1-0.5-1.3-1-1.4-1.3v-2.5c0.1,0.1,0.3,0.2,0.4,0.2 c1.3,0.7,2.9,1.1,4.8,1.6c3.7,0.8,8.4,1.2,13.2,1.2c4.8,0,9.5-0.4,13.2-1.2c1.9-0.4,3.5-0.9,4.8-1.6c0.1-0.1,0.3-0.2,0.4-0.2V16.4z M38.8,11c-0.1,0.3-0.5,0.8-1.4,1.3c-1,0.5-2.4,1-4.2,1.4c-3.5,0.7-8.1,1.1-12.8,1.1c-4.6,0-9.3-0.4-12.8-1.1 c-1.7-0.4-3.2-0.8-4.2-1.4c-1-0.5-1.3-1-1.4-1.3V8.5c0.1,0.1,0.3,0.2,0.4,0.2c1.3,0.7,2.9,1.1,4.8,1.6c3.7,0.8,8.4,1.2,13.2,1.2 c4.8,0,9.5-0.4,13.2-1.2c1.9-0.4,3.5-0.9,4.8-1.6c0.1-0.1,0.3-0.2,0.4-0.2V11z"/>',"data_store","s1"),this.initElement(),this._properties.unlimit||(this._properties.unlimit=!1)}}class Gt extends me.a{constructor(e,t){super(),this._elementType=A.WORKFLOW,this.properties=t||{id:e},t.name&&""!==t.name||"Offline"!==A.ENV||(t.name="Default_Process")}get id(){return this._properties.id}get properties(){return this._properties}set properties(e){this._properties=e}get elementType(){return this._elementType}get documentation(){return this._properties.documentation?this._properties.documentation.text:""}getConditionEvent(e){if(this._properties.events){var t=this._properties.events.find(t=>t.id===e);if(t)return t.condition||""}}get events(){return this._properties.events||[]}set events(e){this.emit("element_onpropertychange"),this._properties.events=e}set newEvent(e){this._properties.events.push(e)}set forms(e){this.emit("element_onpropertychange"),this._properties.forms=e}get forms(){return this._properties.forms}get name(){return this._properties.name}set name(e){this.emit("element_onpropertychange"),this._properties.name=e,this.emit("process_name_changed")}set documentation(e){this.emit("element_onpropertychange"),this.documentation||(this._properties.documentation={id:e.id}),this._properties.documentation.text=e.text}setBindingsEventByIndex(e,t){this.emit("element_onpropertychange"),this._properties.events[e].bindings=t}setBindingEvent(e,t,s){-1===t?this.events[e].bindings.push(s):this._properties.events[e].bindings[t]=s}deleteBindingInIndex(e,t){this.emit("element_onpropertychange"),this._properties.events[e].bindings.splice(t,1)}setSpecificBindingAttribute(e,t,s,i=null){var a=this.objectIndex(e,"events");if(-1!==a){var n=(this.events[a].bindings||[]).findIndex(e=>parseInt(e.busClaParId,10)===parseInt(t.id,10));-1!==n&&(this.events[a].bindings[n].busClaParBndType=s,this.emit("element_onpropertychange"),"V"===s&&i&&(this.events[a].bindings[n].busClaParBndValue=i),"E"!==s&&"P"!==s||!i||(this.events[a].bindings[n].attId=i.attId,this.events[a].bindings[n].attTooltip=i.attTooltip,this.events[a].bindings[n].attName=i.attName))}}objectIndex(e,t,s="id"){return(Array.isArray(t)?t:this._properties[t]||[]).findIndex(t=>parseInt(t[s],10)===parseInt(e[s],10))}setPropertyObject(e,t,s,i){var a=this.objectIndex(e,t);if(-1!==a&&this._properties[t])if(this.emit("element_onpropertychange"),Array.isArray(s)&&Array.isArray(i)){var n=0;s.forEach(e=>{this._properties[t][a][e]=i[n],n++})}else this._properties[t][a][s]=i}deletePropertyByName(e){this._properties[e]&&delete this._properties[e]}}class jt extends ft{constructor(e,t,s,i,a,n,r,o,l){super(A.CONNECTOR,e,t,null,null,s,l,[A.DELETE]),this._path=null,this._selectionPath=null,this._elements=i,this._endMarker=n,this._startMarker=a,this._expressionMarker=r,this._wizardMarker=o,this._segmentPoints=ue.a.set(),this._fromEl=He(this._properties.from,this._elements),this._toEl=He(this._properties.to,this._elements),this._CONTROL_POINT_RADIUS=4,this._clickCount=0,this._timeout=300,this._ox=0,this._oy=0,this._oldElMoving={srcEl:null,x:0,y:0},this._fromEl&&this._toEl&&(this.properties.points||(this.properties.points=[]),this._points=Se()(this.properties.points)||[],s.type!==A.CONNECTOR_TYPE_ASSOCIATION||s.direction||(s.direction="none"),s.type!==A.CONNECTOR_TYPE_TRANSITION||s.class||(s.class="N"),this._fromEl.elementType===A.GATEWAY&&("exclusive"===this._fromEl.type||"inclusive"===this._fromEl.type?s.kind="expression":"parallel"!==this._fromEl.type&&"event"!==this._fromEl.type||(s.kind="none")),this._onConnectorMouseOver=this._onConnectorMouseOver.bind(this),this._onConnectorMouseOut=this._onConnectorMouseOut.bind(this),this._onDblClick=this._onDblClick.bind(this),this.drawElement(),this.initElement())}get connectorName(){return this._properties.name||""}get from(){return this._properties.from}get to(){return this._properties.to}get connectorClass(){return this._properties.class||"n"}get expression(){return this._properties.expression}get kind(){return this._properties.kind||"none"}get direction(){return this._properties.direction||"none"}get type(){return this._properties.type}get executionOrder(){return this._properties.executionOrder}set connectorName(e){this.emit("element_onpropertychange"),this._properties.name=e,this._updateNameLabel()}set from(e){this._properties.from=e}set to(e){this._properties.to=e}set connectorClass(e){this.emit("element_onpropertychange"),this._properties.class=e,this._updateConnectorClass()}set kind(e){this.emit("element_onpropertychange"),this._properties.kind=e,this._fromEl.elementType!==A.GATEWAY&&this._updateConditionType()}set expression(e){this.emit("element_onpropertychange"),this._properties.expression=e}set executionOrder(e){this.emit("element_onpropertychange"),this._properties.executionOrder=e}set direction(e){this.emit("element_onpropertychange"),this._properties.direction=e,this._updateDirection(e)}setInitialDirection(e){this._properties.direction=e,this._updateDirection(e)}set points(e){this.properties.points=Se()(e),this.properties.points[0]={x:this._fromEl.graphic.matrix.e+this._fromEl.width/2-A.ELEMENT_SELECT_SIZE/2,y:this._fromEl.graphic.matrix.f+this._fromEl.height/2-A.ELEMENT_SELECT_SIZE/2},this.properties.points[this.properties.points.length-1]={x:this._toEl.graphic.matrix.e+this._toEl.width/2-A.ELEMENT_SELECT_SIZE/2,y:this._toEl.graphic.matrix.f+this._toEl.height/2-A.ELEMENT_SELECT_SIZE/2}}drawElement(){for(var e=null,t=0,s=this._points.length;t<s;t++)0===t?e="M ".concat(this._points[0].x," ").concat(this._points[0].y," "):e+="L ".concat(this._points[t].x," ").concat(this._points[t].y," ");this._path=this._viewport.path(e).attr({class:"connector--".concat(this.properties.type),markerEnd:this._endMarker}),this._selectionPath=this._viewport.path(e).attr({class:"connector__selection"}),this._isMovable&&this._path.dblclick(this._onDblClick);var i=this._path.getBBox(),a=this.drawSelectionBox(i,"selectionBox selectionBox--connector"),n=this._path.getTotalLength()/2,r=this._path.getPointAtLength(n);this._label=this._drawForeignObjLabel(r.x,r.y,this.connectorName,"connector__group__text","text_".concat(this.id)),this._label.select("g").attr({class:"connector__group",dy:-10}),this._graphic=this._viewport.g(this._selectionPath,a,this._path,this._label,this._segmentPoints).click(this.onElementMouseDown).attr({class:"connector",id:"".concat(A.CONNECTOR,"_").concat(this._properties.id)}),this.toBack(),this._isMovable&&this._graphic.mouseover(this._onConnectorMouseOver).mouseout(this._onConnectorMouseOut),this._updateConditionType(),this._updateConnectorClass(),this.properties.type===A.CONNECTOR_TYPE_ASSOCIATION&&this._updateDirection(),this.updateConnection()}_drawForeignObjLabel(e,t,s,i,a){var n='<g><foreignObject \n      x="'.concat(e,'"\n      y="').concat(t,'"\n      width="80" \n      height="80"\n      id="').concat(a,'">\n    <p class="').concat(i,'">').concat(s,"</p></foreignObject></g>");return ue.a.parse(n)}_updateConnectorClass(){switch(this.connectorClass.toUpperCase()){case"N":this._path.removeClass("connector--loopback"),this._path.attr({markerEnd:this._endMarker});break;case"W":this._path.attr({markerEnd:this._wizardMarker});break;case"L":this._path.addClass("connector--loopback")}}_updateConditionType(){switch(this.kind.toUpperCase()){case"NONE":this._path.attr({markerStart:""});break;case"EXPRESSION":this._fromEl.elementType!==A.GATEWAY&&this._path.attr({markerStart:this._expressionMarker})}}_updateDirection(){switch(this.direction.toUpperCase()){case"NONE":this._path.attr({markerEnd:"",markerStart:""});break;case"DIRECTIONAL":this._path.attr({markerEnd:this._endMarker});break;case"BOTH":this._path.attr({markerEnd:this._endMarker,markerStart:this._startMarker})}}updateConnectionStart(){this.toBack()}updateConnection(e={x:0,y:0},t=!1){if(null!==this._fromEl&&null!==this._toEl){var s,i,a,n,r,o,l,h,c=A.ELEMENT_SELECT_SIZE/2,p=this._fromEl.width/2,d=this._fromEl.height/2,u=this._toEl.width/2,_=this._toEl.height/2,m=null;if(this._points.length<3){s=this._fromEl.graphic.matrix.e-c+p,i=this._fromEl.graphic.matrix.f-c+d,l=qe(o=(a=this._toEl.graphic.matrix.e-c+u)-s,r=(n=this._toEl.graphic.matrix.f-c+_)-i,s,i,p,d),h=qe(-o,-r,a,n,u,_),(l.includes(NaN)||h.includes(NaN))&&(l=l.map(e=>isNaN(e)?-4e4:e),h=h.map(e=>isNaN(e)?-4e3:e));for(var g=0,v=this._points.length;g<v;g++)0===g?(m="M ".concat(l[0]," ").concat(l[1]," "),this._points[g]={x:l[0],y:l[1]}):(m+="L ".concat(h[0]," ").concat(h[1]," "),this._points[g]={x:h[0],y:h[1]});this._path.attr({d:m}),this._selectionPath.attr({d:m})}else{for(var b=0,T=this._points.length;b<T;b++)if(0===b)p=this._fromEl.width/2,d=this._fromEl.height/2,u=0,_=0,s=this._fromEl.graphic.matrix.e-c+p,i=this._fromEl.graphic.matrix.f-c+d,(l=qe(o=(a=this._points[b+1].x+e.x/2)-s,r=(n=this._points[b+1].y+e.y/2)-i,s,i,p,d)).includes(NaN)?(m="M ".concat(s," ").concat(i," "),this._points[b]={x:s,y:i}):(m="M ".concat(l[0]," ").concat(l[1]," "),this._points[b]={x:l[0],y:l[1]});else if(b>0&&b<T-1){var y={};this._isSnapOn&&!t?(y.x=Math.round(We(this._points[b].x+e.x/2,this._snapSize)+this._snapSize/2),y.y=Math.round(We(this._points[b].y+e.y/2,this._snapSize)+this._snapSize/2)):(y.x=this._points[b].x+e.x/2,y.y=this._points[b].y+e.y/2),m+="L ".concat(y.x," ").concat(y.y," "),this._points[b]={x:y.x,y:y.y}}else p=0,d=0,u=this._toEl.width/2,_=this._toEl.height/2,s=this._points[b-1].x+e.x/2,i=this._points[b-1].y+e.y/2,(h=qe(-(o=(a=this._toEl.graphic.matrix.e-c+u)-s),-(r=(n=this._toEl.graphic.matrix.f-c+_)-i),a,n,u,_)).includes(NaN)||(m+="L ".concat(h[0]," ").concat(h[1]," "),this._points[b]={x:h[0],y:h[1]});this._path.attr({d:m}),this._selectionPath.attr({d:m})}if(this._graphic){var E=this._path.getBBox();this._selectionBox.attr({x:Math.round(E.x-A.ELEMENT_SELECT_SIZE/2),y:Math.round(E.y-A.ELEMENT_SELECT_SIZE/2),width:Math.round(E.width+A.ELEMENT_SELECT_SIZE),height:Math.round(E.height+A.ELEMENT_SELECT_SIZE)})}this._updateNameLabel(),this.points=this._points}}_updateNameLabel(){var e=this._path.getTotalLength()/2,t=this._path.getPointAtLength(e),s=this._graphic.select("foreignObject"),i=this._graphic.select("p").node.getBoundingClientRect();s.attr({x:Math.round(t.x-i.width/2),y:Math.round(t.y)}),this.updateTextLabel("connector__group__text",this.connectorName)}_onDblClick(e){this._addNewSegmentToConnector(e)}_onConnectorMouseOver(){this._path.attr({strokeWidth:5})}_onConnectorMouseOut(){this._path.attr({strokeWidth:2})}_onSelected(){this._drawSegmentPoints(),this.emit("element_selected")}_onDeselected(){this._removeSegmentPoints(),this.emit("element_unselected")}_addNewSegmentToConnector(e){var t=this._viewport.getInverseScreenPoint(e.clientX,e.clientY),s=this._closestPoint(this._path,[t.x,t.y]),i=this._getLengthForPointInPath(s,this._path),a=this._getNextPositionInPointsArray(i);this.emit("connector_point_new"),this._points.splice(a,0,s),this.points=this._points,this._removeSegmentPoints(),this._drawSegmentPoints()}_removeSegmentPoints(){this._segmentPoints.forEach(e=>{e.undrag(),e.unmouseout(),e.unmouseover(),e.unclick(),e.remove()}),this._segmentPoints.clear()}_drawSegmentPoints(){for(var e=this,t=0,s=this._points.length;t<s;t++)t>0&&t<s-1&&this._segmentPoints.push(this._graphic.circle(Math.round(this._points[t].x),Math.round(this._points[t].y),this._CONTROL_POINT_RADIUS).data("point",t).attr({class:"connector__segment_point"}).mouseover((function(){this.attr({r:2*e._CONTROL_POINT_RADIUS})})).mouseout((function(){this.attr({r:e._CONTROL_POINT_RADIUS})})).click((function(t){e._clickCount++,1===e._clickCount&&(t.preventDefault(),setTimeout(()=>{1===e._clickCount||2===e._clickCount&&(e._contextMenu.hide(),e.emit("connector_point_deleted"),e._points.splice(this.data("point"),1),e._removeSegmentPoints(),e.updateConnection(),e._drawSegmentPoints(),e._onConnectorMouseOut(),e.points=e._points,e._contextMenu.show(),t.stopPropagation()),e._clickCount=0},e._timeout||300))})).drag((function(t,s,i,a,n){var r=e._viewport.getMousePoint(n,0,0);e._isSnapOn&&(r.x=Math.round(We(r.x,e._snapSize)+e._snapSize/2),r.y=Math.round(We(r.y,e._snapSize)+e._snapSize/2)),this.attr({cx:r.x,cy:r.y}),e._points[this.data("point")]={x:r.x,y:r.y},e.updateConnection()}),(function(){e._ox=this.attr("cx"),e._oy=this.attr("cy"),e.emit("connector_point_move_start")}),(function(){e._ox!==this.attr("cx")||e._oy!==this.attr("cy")?(e.emit("connector_point_move_end"),e.points=e._points):e.emit("connector_point_no_move_end")})))}updateSegmentsPosition(e){if(this._toEl.selected&&this._fromEl.selected&&this._points.length>2){this._removeSegmentPoints();for(var t=1,s=this._points.length-1;t<s;t++)this._oldElMoving.srcEl===e?(this._points[t].x+=e.mx-this._oldElMoving.x,this._points[t].y+=e.my-this._oldElMoving.y):(this._points[t].x+=e.mx,this._points[t].y+=e.my);this._oldElMoving={srcEl:e,x:e.mx,y:e.my},this._drawSegmentPoints(),this.updateConnection()}}resetMovingPointSegment(){this._oldElMoving={srcEl:null,x:0,y:0},this.points=this._points}_getNextPositionInPointsArray(e){for(var t=0,s=this._points.length;t<s;t++){if(this._getLengthForPointInPath(this._points[t],this._path)>e)return t}return 0}_closestPoint(e,t){for(var s,i,a,n,r=e.getTotalLength(),o=8,l=1/0,h=0;h<=r;h+=o)(n=this._distance2(a=e.getPointAtLength(h),t))<l&&(s=a,i=h,l=n);for(o/=2;o>.5;){var c,p=void 0,d=void 0,u=void 0,_=void 0,m=void 0;(c=i-o)>=0&&(_=this._distance2(p=e.getPointAtLength(c),t))<l?(s=p,i=c,l=_):(u=i+o)<=r&&(m=this._distance2(d=e.getPointAtLength(u),t))<l?(s=d,i=u,l=m):o/=2}return s={x:Math.round(s.x),y:Math.round(s.y)}}_distance2(e,t){var s=e.x-t[0],i=e.y-t[1];return s*s+i*i}_getLengthForPointInPath(e,t){for(var s,i=t.getTotalLength(),a=i/100,n=i,r=0;r<100;r++){var o=t.getPointAtLength(r*a),l=this._distance2(o,[e.x,e.y]);l<n&&(n=l,s=r)}return s*a}}class qt{constructor(e){this._editor=e}createElement(e,t,s,i,a,n,r=!0){var o;switch(e){case A.TASK:o=new It(t,s,i,a,n,r);break;case A.START_EVENT:o=new wt(t,s,i,a,n,r);break;case A.END_EVENT:o=new Mt(t,s,i,a,n,r);break;case A.INTERMEDIATE_EVENT:o=new Lt(t,s,i,a,n,r);break;case A.GATEWAY:o=new xt(t,s,i,a,n,r);break;case A.SUBPROCESS:o=new Nt(t,s,i,a,n,r),this._checkSubprocessID(o);break;case A.POOL:o=new Dt(t,s,i,a,n,r);break;case A.LANE:o=new Rt(t,s,i,a,n);break;case A.GROUP:o=new Bt(t,s,i,a,n,r);break;case A.TEXT:o=new Vt(t,s,i,a,n,r);break;case A.DATA_OBJECT:o=new Ut(t,s,i,a,n,r);break;case A.DATA_INPUT:o=new Wt(t,s,i,a,n,r);break;case A.DATA_OUTPUT:o=new zt(t,s,i,a,n,r);break;case A.DATA_STORE:o=new Ht(t,s,i,a,n,r);break;case A.WORKFLOW:o=new Gt(t,n),this._editor.workflow=o;break;case A.CONNECTOR:o=new jt(t,a,n,this._editor.elements,this._editor._startMarker,this._editor._endMarker,this._editor._expressionMarker,this._editor._wizardMarker,r)}return o}_checkSubprocessID(e){var t=e.properties;"Offline"!==A.ENV||t.activitySetId||(t.activitySetId=this._editor.idIndex++)}}var Yt=s("2aXo"),Kt=s.n(Yt),Zt=s("vAVA"),Xt=s("Iab2");function Jt(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function Qt(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){Jt(n,i,a,r,o,"next",e)}function o(e){Jt(n,i,a,r,o,"throw",e)}r(void 0)}))}}s("DaQG");function $t(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function es(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){$t(n,i,a,r,o,"next",e)}function o(e){$t(n,i,a,r,o,"throw",e)}r(void 0)}))}}class ts extends class{constructor(e){this._editor=e}getPNGCanvas(){var e=this;return Qt((function*(){e._editor.unSelectAllElements();var t=e._editor._gridManager.isGridOn;e._editor.unSelectAllElements(),e._editor.resetView(),t&&e._editor.showGrid(!1);var s=Ye(e._editor.elements),i=yield Object(Zt.svgAsDataUri)(document.getElementById("app"),{backgroundColor:"#fff",width:s.width+40,height:s.height+40,left:s.x-20,top:s.y-20,excludeUnusedCss:!1,scale:1}),a=e._addImage(i).then(e=>{var t=document.createElement("canvas"),s=t.getContext("2d");return t.width=e.width,t.height=e.height,s.drawImage(e,0,0,e.width,e.height),t});return t&&e._editor.showGrid(!0),a}))()}generateXPDLFile(){var e=this._editor.buildXMLProcess(),t=new Blob([e],{type:"text/plain;charset=utf-8"});Object(Xt.saveAs)(t,"".concat(Ze(this._editor.workflow.properties.name),".xpdl"))}generateProcessPNG(){var e=Ye(this._editor.elements),t=document.getElementById("app");this._editor.unSelectAllElements(),Object(Zt.saveSvgAsPng)(t,"".concat(Ze(this._editor.workflow.properties.name),".png"),{backgroundColor:"#fff",width:e.width+40,height:e.height+40,left:e.x-20,top:e.y-20,excludeUnusedCss:!1,scale:1})}getPNGDataURL(){var e=this;return Qt((function*(){var t=e._editor._gridManager.isGridOn;e._editor.unSelectAllElements(),e._editor.resetView(),t&&e._editor.showGrid(!1);var s=Ye(e._editor.elements),i=yield Object(Zt.svgAsDataUri)(document.getElementById("app"),{backgroundColor:"#fff",width:s.width+40,height:s.height+40,left:s.x-40,top:s.y-40,excludeUnusedCss:!1,scale:1}),a=e._addImage(i).then(e=>{var t=document.createElement("canvas"),s=t.getContext("2d");return t.width=e.width,t.height=e.height,s.drawImage(e,0,0,e.width,e.height),t.toDataURL("image/png").substring("data:image/png;base64,".length)});return t&&e._editor.showGrid(!0),a}))()}_addImage(e){return new Promise((t,s)=>{var i=document.createElement("img");i.onload=()=>t(i),i.onerror=s,i.src=e})}}{constructor(e){super(),this._editor=e,this._h1=22,this._h2=18,this._PAGE_SIZE="a4"}generateProcessDocumentation(){var e=this;return es((function*(){var t,i,a=new((yield Promise.resolve().then(s.t.bind(null,"5RHE",7))).default)("p","pt",e._PAGE_SIZE,!0),n=new DOMParser,r=yield he.a.get(A.CLASSES_DESCRIPTION_URL),o=n.parseFromString(r.data,"text/xml");if("Production"===A.ENV){var l=window.top.document.querySelectorAll("iframe.active")[0],h=l.contentDocument||l.contentWindow.document;t=h.querySelector("#dataGenProTitle").innerText||"Apia Process",i=h.querySelector("#txtDesc").innerText||""}else t="Apia Process",i="Process description text from Apia";var c=40,p=0,d=0,u=0,_=0;a.setFontSize(9),a.text(M.a.t("doc.proDesDocHeader"),c,c);var m=a.internal.pageSize.getHeight()/2;a.setFontSize(32);for(var g=a.splitTextToSize(t,380),v=0;v<g.length;v++){var b=a.internal.pageSize.width/2-a.getStringUnitWidth(g[v])*(a.internal.getFontSize()/2);a.text(g[v],b,m),m=32+m}a.autoTable({startY:m,theme:"grid",headStyles:{fontSize:16,fontStyle:"normal",halign:"center",fillColor:"#ffffff",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[i]],body:[]});var T=yield e.getPNGCanvas();a.addPage(e._PAGE_SIZE,"l");var y=a.internal.pageSize.getWidth(),E=a.internal.pageSize.getHeight(),S=y/T.width,f=E/T.height,I=S>f?f:S;a.addImage(T.toDataURL("image/png"),"png",(y-T.width*I)/2,0,T.width*I,T.height*I,void 0,"FAST"),a.addPage(e._PAGE_SIZE,"p"),a.setFontSize(e._h1),a.setFontStyle("bold"),a.text(M.a.t("doc.proDesWorkProLbl"),c,80),p=100,e._editor.workflow.properties.documentation.text&&(a.setFontSize(10),a.setFontStyle("normal"),a.autoTable({startY:p,margin:{left:c},body:[[{content:e._editor.workflow.properties.documentation.text,theme:"plain",styles:{fontSize:10,halign:"left",fillColor:"#ffffff"}}]]}),p=a.previousAutoTable.finalY+30),a.setFontSize(12),a.setFontStyle("bold"),e._getEvents(e._editor.workflow.events,o).length>0&&(a.text(M.a.t("doc.proDesProEvtLbl"),c,p,{align:"left"}),p+=18,a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#7FDBFF",textColor:"#000000"},margin:{top:100,right:c,bottom:0,left:c},head:[[M.a.t("doc.proDesProEvtEvtHeaderLbl"),M.a.t("doc.proDesProBizClsHeaderLbl"),M.a.t("doc.proDesProDescHeaderLbl")]],body:e._getEvents(e._editor.workflow.events,o)}),p=a.previousAutoTable.finalY+60),p+=30;var C=ze(A.POOL,e._editor.elements);C.length>0&&(a.setFontSize(e._h1),a.setFontStyle("bold"),a.text(M.a.t("doc.proDesPoolLbl"),c,p),p+=10,a.autoTable({startY:p,theme:"grid",margin:{top:c,right:c,bottom:c,left:c},body:[[M.a.t("doc.proDesPoolDetailsNameLbl"),C[0].properties.name],[M.a.t("doc.proDesPoolDetailsDocLbl"),C[0].properties.documentation?C[0].properties.documentation.text:""]],columnStyles:{0:{cellWidth:160,fillColor:"#DDDDDD",textColor:"#000000",fontStyle:"bold"}}}),p=a.previousAutoTable.finalY+60);var P=ze(A.LANE,e._editor.elements);P.length>0&&(a.setFontSize(e._h1),a.setFontStyle("bold"),a.text(M.a.t("doc.proDesLanesLbl"),c,p),p+=10,a.autoTable({startY:p,headStyles:{fillColor:"#DDDDDD",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesLanesDetailsNameLbl"),M.a.t("doc.proDesLanesDetailsDocLbl")]],body:e._getLanes(P)}),p=a.previousAutoTable.finalY+60),a.setFontSize(e._h1),a.setFontStyle("bold"),a.text(M.a.t("doc.proDesTasksLbl"),c,p),p+=30;var k=ze(A.TASK,e._editor.elements);k.sort((e,t)=>e.properties.title>t.properties.title?1:-1);var w,L=!0,x=!1;try{for(var N,O,D=function(e){var t;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(t=e[Symbol.asyncIterator]))return t.call(e);if(Symbol.iterator&&null!=(t=e[Symbol.iterator]))return t.call(e)}throw new TypeError("Object is not async iterable")}(k);L=(N=yield D.next()).done,O=yield N.value,!L;L=!0){var R=O;d>0&&(a.addPage(e._PAGE_SIZE,"p"),p=60),_=1,u=1;var B=R.title,V=R.properties.groups,F=R.properties.events,U=R.properties.states,W=R.properties.boundaryEvents,z=void 0;z=R.properties.role?R.properties.role.name:"",a.autoTable({startY:p,theme:"grid",headStyles:{fontSize:e._h2,fontWeight:"bold",fillColor:"#ffffff",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[["".concat(++d,". ").concat(B)]],body:[]}),p=a.previousAutoTable.finalY+10,R.properties.documentation&&(a.autoTable({startY:p,margin:{left:c},body:[[{content:R.properties.documentation.text,theme:"plain",styles:{fontSize:10,halign:"left",fillColor:"#ffffff"}}]]}),p=a.previousAutoTable.finalY+30),p+=18,a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(u," ").concat(M.a.t("doc.proDesTaskDetailsLbl"),":"),c,p,{align:"left"}),p+=10,a.autoTable({startY:p,theme:"grid",margin:{top:c,right:c,bottom:c,left:c},body:[[M.a.t("doc.proDesTaskDetailsNameLbl"),R.properties.name],[M.a.t("doc.proDesTaskDetailsTypeLbl"),R.properties.taskType],[M.a.t("doc.proDesTaskDetailsConLbl"),R.properties.condition],[M.a.t("doc.proDesTaskDetailsRoleLbl"),z]],columnStyles:{0:{cellWidth:160,fillColor:"#DDDDDD",textColor:"#000000",fontStyle:"bold"}}}),p=a.previousAutoTable.finalY+18,V&&(p+=18,a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(++u," ").concat(M.a.t("doc.proDesTaskGrpLbl"),":"),c,p,{align:"left"}),p+=14,a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#DDDDDD",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskGrpNameHeader"),M.a.t("doc.proDesTaskGrpCondHeader")]],body:e._getTaskGroups(V)})),p=a.previousAutoTable.finalY+30;var H=je(R,A.TEXT,e._editor.elements),G=je(R,A.DATA_OBJECT,e._editor.elements),j=je(R,A.DATA_STORE,e._editor.elements),q=je(R,A.DATA_INPUT,e._editor.elements),Y=je(R,A.DATA_OUTPUT,e._editor.elements),K=[...G,...q,...Y];H.length>0&&(p+=18,a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(++u," ").concat(M.a.t("doc.proDesTaskAnnotationLbl"),":"),c,p,{align:"left"}),p+=14,a.autoTable({startY:p,theme:"grid",margin:{top:c,right:c,bottom:c,left:c},body:[[M.a.t("doc.proDesPoolDetailsNameLbl"),H[0].properties.text||""],[M.a.t("doc.proDesPoolDetailsDocLbl"),H[0].properties.documentation?H[0].properties.documentation.text:""]],columnStyles:{0:{cellWidth:160,fillColor:"#DDDDDD",textColor:"#000000",fontStyle:"bold"}}}),p=a.previousAutoTable.finalY+30),K.length>0&&(p+=18,a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(++u," ").concat(M.a.t("doc.proDesDoLbl"),":"),c,p,{align:"left"}),p+=14,a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#DDDDDD",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskDOTypeHeader"),M.a.t("doc.proDesTaskDONameHeader"),M.a.t("doc.proDesTaskDOStateHeader"),M.a.t("doc.proDesTaskDOCollHeader"),M.a.t("doc.proDesTaskDODocsHeader")]],body:e._getTaskDo(K)}),p=a.previousAutoTable.finalY+30),j.length>0&&(p+=18,a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(++u," ").concat(M.a.t("doc.proDesDtaStoreLbl"),":"),c,p,{align:"left"}),p+=14,a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#DDDDDD",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskDOStoreNameHeader"),M.a.t("doc.proDesTaskDOStoreStateHeader"),M.a.t("doc.proDesTaskDOStoreCapacityHeader"),M.a.t("doc.proDesTaskDOStoreLimitHeader"),M.a.t("doc.proDesTaskDOStoreDocsHeader")]],body:e._getTaskDtaStore(j)}),p=a.previousAutoTable.finalY+60),U&&(p+=14,a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(++u," ").concat(M.a.t("doc.proDesTaskStateLbl"),":"),c,p,{align:"left"}),p+=14,a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#DDDDDD",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskStateEvtHeader"),M.a.t("doc.proDesTaskStateNameHeader"),M.a.t("doc.proDesTaskStateDescHeader")]],body:e._getTaskStates(U)})),p=a.previousAutoTable.finalY+30;var Z=(yield e._getFormDataByTaskId(R.properties.id)).getElementsByTagName("form");Z.length>0&&(a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(++u," ").concat(M.a.t("doc.proDesTaskFormsLbl"),":"),c,p,{align:"left"}));for(var X=0;X<Z.length;X++){p+=18;var J=e._getTaskFormData(Z[X]);a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#ffffff",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[["".concat(d,".").concat(u,".").concat(_++," ").concat(Z[X].getAttribute("frmTitle"))]],body:[]}),a.autoTable({startY:a.previousAutoTable.finalY,theme:"grid",headStyles:{fillColor:"#DDDDDD",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskFormsNameHeader"),M.a.t("doc.proDesTaskFormsDescHeader")]],body:[[Z[X].getAttribute("frmName"),Z[X].getAttribute("frmDesc")]],pageBreak:"avoid"}),J.taskFormEvents.length>0&&a.autoTable({startY:a.previousAutoTable.finalY,theme:"grid",headStyles:{fillColor:"#7FDBFF",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskFormsEvtNameHeader"),M.a.t("doc.proDesTaskFormsEvtTypeHeader"),M.a.t("doc.proDesTaskFormsEvtDescHeader")]],body:J.taskFormEvents,pageBreak:"avoid"}),J.formFieldAttributes.length>0&&a.autoTable({startY:a.previousAutoTable.finalY,theme:"grid",headStyles:{fillColor:"#DDDDDD",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskFormsFldsNameHeader"),M.a.t("doc.proDesTaskFormsFldsFieldHeader"),M.a.t("doc.proDesTaskFormsFldsTypeHeader"),M.a.t("doc.proDesTaskFormsFldsEditHeader"),M.a.t("doc.proDesTaskFormsFldsReqHeader"),M.a.t("doc.proDesTaskFormsFldsGridHeader"),M.a.t("doc.proDesTaskFormsFldsDescHeader")]],body:J.formFieldAttributes,pageBreak:"avoid"}),J.taskFieldsEvents.length>0&&a.autoTable({startY:a.previousAutoTable.finalY,theme:"grid",headStyles:{fillColor:"#7FDBFF",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[["Field","Event Name","Event Type","Description"]],body:J.taskFieldsEvents,pageBreak:"avoid"}),p=a.previousAutoTable.finalY+30}F&&(a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(++u," ").concat(M.a.t("doc.proDesTaskEventsLbl"),":"),c,p,{align:"left"}),p+=14,a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#7FDBFF",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskEventsEvtHeader"),M.a.t("doc.proDesTaskEventsBizHeader"),M.a.t("doc.proDesTaskEventsDescHeader")]],body:e._getEvents(F,o),pageBreak:"avoid"}),p=a.previousAutoTable.finalY+30),W.length>0&&(a.setFontSize(12),a.setFontStyle("bold"),a.text("".concat(d,".").concat(++u," ").concat(M.a.t("doc.proDesTaskBoundLbl"),":"),c,p,{align:"left"}),p+=14,a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#7FDBFF",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesTaskBoundEvtHeader"),M.a.t("doc.proDesTaskBoundTypeHeader"),M.a.t("doc.proDesTaskBoundDtlHeader")]],body:e._getBoundaryEvents(W),pageBreak:"avoid"}),p=a.previousAutoTable.finalY+30)}}catch(e){x=!0,w=e}finally{try{L||null==D.return||(yield D.return())}finally{if(x)throw w}}p+=30;var Q=ze(A.GATEWAY,e._editor.elements);Q.length>0&&(a.setFontSize(e._h1),a.setFontStyle("bold"),a.text(M.a.t("doc.proDesGatewayLbl"),c,p),p+=10,a.autoTable({startY:p,theme:"grid",headStyles:{fillColor:"#7FDBFF",textColor:"#000000"},margin:{top:c,right:c,bottom:c,left:c},head:[[M.a.t("doc.proDesGatewaysNameHeader"),M.a.t("doc.proDesGatewaysTypeHeader"),M.a.t("doc.proDesGatewaysExecTypeHeader"),M.a.t("doc.proDesGatewaysDocumentationHeader")]],body:e._getGatewayDetails(Q)}),p=a.previousAutoTable.finalY+60),"Production"===A.ENV?Xe(a.output("arraybuffer"),"".concat(Kt()(t),".pdf")):a.save(Kt()(t))}))()}_getLanes(e){var t=[];return e.forEach((e,s)=>{t[s]=[e.properties.name||"",e.properties.documentation?e.properties.documentation.text:""]}),t}_getTaskDtaStore(e){var t=[];return e.forEach((e,s)=>{t[s]=[e.properties.name||"",e.properties.state||"",e.properties.capacity||"",e.properties.unlimit||"",e.properties.documentation?e.properties.documentation.text:""]}),t}_getTaskDo(e){var t=[];return e.forEach((e,s)=>{t[s]=[e.elementType||"",e.properties.name||"",e.properties.state||"",e.properties.collection||"false",e.properties.documentation?e.properties.documentation.text:""]}),t}_getGatewayDetails(e){var t=[];return e.forEach((e,s)=>{t[s]=[e.properties.name||"---",e.properties.type||"",e.properties.executionType||"",e.documentation||""]}),t}_getEvents(e,t){var s=[];return e.forEach((e,i)=>{s[i]=[e.name,t.querySelector("[*|id='".concat(e.busClaId,"']")).getAttribute("name"),t.querySelector("[*|id='".concat(e.busClaId,"']")).getAttribute("desc")]}),s}_getTaskGroups(e){var t=[];return e.forEach((e,s)=>{t[s]=[e.name,e.condition]}),t}_getTaskStates(e){var t=[];return e.forEach((e,s)=>{t[s]=[e.event,e.name,e.conditionDoc]}),t}_getBoundaryEvents(e){var t=[];return e.forEach((e,s)=>{e.eventType,t[s]=[e.eventName,e.eventType,"ToDo"]}),t}_getFormDataByTaskId(e){return es((function*(){var t,s=new DOMParser;return"Development"===A.ENV?t=yield he.a.get("".concat(A.TASK_FORM_DOC,"/").concat(e)):"Production"===A.ENV&&(t=yield he.a.get("".concat(A.TASK_FORM_DOC,"&taskid=").concat(e))),s.parseFromString(t.data,"text/xml")}))()}_getTaskFormData(e){for(var t=[],s=[],i=[],a=0,n=0;n<e.children.length;n++)if("attribute"===e.children[n].nodeName){var r=e.children[n];s[n]=[r.getAttribute("attLabel"),r.getAttribute("fieldtype"),r.getAttribute("datatype"),r.getAttribute("editable"),r.getAttribute("required"),r.getAttribute("grid"),r.getAttribute("attTooltip")];for(var o=0;o<r.children.length;o++)if("events"===r.children[o].nodeName)for(var l=0;l<r.children[o].children.length;l++)i[a++]=[r.getAttribute("attLabel"),r.children[o].children[l].getAttribute("busClaName"),r.children[o].children[l].getAttribute("evtName"),r.children[o].children[l].getAttribute("busClaDesc")]}else if("events"===e.children[n].nodeName)for(var h=e.children[n],c=0;c<h.children.length;c++)t[c]=[h.children[c].getAttribute("busClaName"),h.children[c].getAttribute("evtName"),h.children[c].getAttribute("busClaDesc")];return{taskFormEvents:t,formFieldAttributes:s,taskFieldsEvents:i}}}var ss=s("MXF5"),is=s.n(ss);class as{constructor(){this.arrayJs=[],this.convert=is.a.parser(!0),this.textValid=!1}_isValidTag(e){return"VALUE"===e||"EVENT"===e||"TASK"===e||"CALENDAR"===e||"STATUS"===e}convertToJson(e){var t=[],s={};return this.convert.onopentag=e=>{switch(e.name.toUpperCase()){case"LEVEL":s[e.attributes.name]=e.attributes.value;break;case"EVENT":case"CALENDAR":case"TASK":case"STATUS":s.id=e.attributes.id,s.name=e.attributes.name;break;case"MESSAGE":case"EXCEPTION":this.textValid=!0}},this.convert.onclosetag=e=>{this._isValidTag(e.toUpperCase())&&(t.push(s),s={}),this.textValid&&(this.textValid=!1,t.push({message:"OK"}))},this.convert.ontext=e=>{this.textValid&&(t.push({message:e}),this.textValid=!1)},this.convert.write(e).close(),t}}var ns='<i class="fas fa-info-circle fa-2x icon"></i><div class="toast-body"><h4></h4><p></p></div>',rs={duration:3e3,position:"bottom-left"},os={infoClass:"fa-info-circle",successClass:"fa-check-circle",warningClass:"fa-exclamation-triangle",dangerClass:"fa-exclamation-circle"},ls={neutral:"neutral",info:"info",success:"success",warning:"warning",danger:"danger"},hs={top:"top",bottom:"bottom",center:"center",left:"left",right:"right"};function cs(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ps(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?cs(Object(s),!0).forEach((function(t){ds(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):cs(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ds(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class us{constructor(){this.containerToast=this._exists()?this._exists():document.createElement("div"),this.body=document.querySelector("body"),this._exists()||(this.containerToast.classList.add("toast-container"),this.containerToast.innerHTML=ns,this.body.insertAdjacentElement("afterbegin",this.containerToast)),this._title=this.containerToast.querySelector("div.toast-body h4"),this._icon=this.containerToast.querySelector("svg.icon"),this._message=this.containerToast.querySelector("div.toast-body p")}_exists(){return document.querySelector(".toast-container")}cleanClass(e,t){e&&e.classList.remove(t)}cleanFirstAllClass(e,t){for(var s=Object.entries(t),i=0;i<s.length;i++)this.cleanClass(e,s[i][1])}get icon(){return this._icon}get title(){return this._title}get message(){return this._message}set icon(e){this._icon=this.containerToast.querySelector("svg.icon"),this.cleanFirstAllClass(this._icon,os),this._icon.classList.add(os["".concat(e,"Class")])}set title(e){this._title&&(this._title.innerText=e)}set message(e){this._message&&(this._message.innerHTML=e)}set position(e){var t=e.split("-");this.cleanFirstAllClass(this.containerToast,hs),t.length>0&&t.forEach(e=>{this.containerToast.classList.add(e)})}moveXY(e){this.containerToast.style.top="".concat(e.y,"px"),this.containerToast.style.left="".concat(e.x,"px")}waitTime(e,t){var s;clearTimeout(s),s=setTimeout(()=>{e(),clearTimeout(s)},t)}fadeIn(){this.containerToast.style.display="flex",this.waitTime(()=>{this.containerToast.classList.add("show")},.2)}fadeOut(){this.containerToast.classList.remove("show"),this.waitTime(()=>{this.containerToast.style.display="none"},.5)}show(e){this.fadeIn(),this.waitTime(()=>{this.fadeOut()},e)}showMessage(e){var t=e.type,s=e.title,i=e.message,a=e.duration,n=e.position,r=e.coordinate;this.cleanFirstAllClass(this.containerToast,ls),this.containerToast.classList.add(t||"neutral"),this.icon=t||"",this.title=s||"",this.message=i||"",r&&this.moveXY(r),n&&(this.position=n),this.show(a||2e3)}showWrongMessage(e){var t=e.title,s=e.message;this.showMessage(ps(ps({},rs),{},{type:"danger",title:t,message:s,duration:4e3}))}}function _s(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ms(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class gs extends me.a{constructor(e,t,s,i){super(),this._nameId=t,this._panel=s;var a=this.panel.querySelector("#wrapper_".concat(e));a.setAttribute("id","".concat(a.id,"_").concat(this.nameId)),this._wrapper=a,this._label=i,this._labelEl=this._wrapper.querySelector(".main__sidepanel__form__label"),this._labelEl&&(this.labelEl="".concat(i,":"))}get nameId(){return this._nameId}get panel(){return this._panel}get wrapper(){return this._wrapper}set nameID(e){this._nameId=e}set panel(e){this._panel=e}set wrapper(e){this._wrapper=e}set labelEl(e){this._labelEl.innerText=e}get label(){return this._label}clean(){this.wrapper.remove()}disabled(e,t){e.setAttribute("disabled",t)}showInvalidSession(){(new us).showMessage(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(s),!0).forEach((function(t){ms(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):_s(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({type:"danger",title:M.a.t("component.txtComponentToastTitleError"),message:M.a.t("component.txtComponentToastMessage")},{duration:15e3,position:"bottom-left"}))}}class vs extends gs{constructor(e,t,s,i){super("expander",e,t,i),this.expandId=s,this._init()}get isExpand(){return JSON.parse(this._expandZone.getAttribute("data-visible"))}get inputEl(){return this.showInput}set inputEl(e){this.showInput.placeholder=e}get expandZone(){return this._expandZone}_init(){this.expandBtn=this.wrapper.querySelector(".btn"),this.showInput=this.wrapper.querySelector("input[type=text]"),this._expandZone=this.panel.querySelector("#".concat(this.expandId)),this._expandZone.setAttribute("data-visible",!1),this.expandBtn.addEventListener("click",()=>{this.expand()})}expand(){var e="fa-arrow-up",t="fa-arrow-down",s=this.expandBtn.querySelector("svg");this.isExpand?(s.classList.replace(e,t),this._expandZone.setAttribute("data-visible",!1)):(s.classList.replace(t,e),this._expandZone.setAttribute("data-visible",!0),this.emit("expand"))}showValue(e){if(e.length>0){for(var t="(".concat(e.length,") - "),s=0;s<2&&s<e.length;){var i=e[s];t=t.concat("".concat(i)),1!==s&&s!==e.length-1&&(t=t.concat(", ")),s++}e.length>2&&(t=t.concat(" ... ")),this.showInput.setAttribute("placeholder",t)}else this.showInput.setAttribute("placeholder","")}}function bs(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Ts(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function ys(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class Es extends gs{constructor(e,t,s,i,a){super("list",e,t,s),this._arrayList=i,this._idItem="id",this._editStatus=!1,this._disabledStatus=!1,this._rowEditableSelected=null,this.MAX_ROWS=6,this._initComponent(),this._initEvents(a),this._initListTable(),this._load=0}get editStatus(){return this._editStatus}set editStatus(e){this._editStatus=e,this.addAction.disabled=this._editStatus}get idItem(){return this._idItem}set idItem(e){this._idItem=e}get arrayList(){return this._arrayList}set arrayList(e){this._arrayList=e,this._initListTable()}set arrayListData(e){if(this._cleanElementsList(),this._arrayList.data=e,e.length>0){var t=this.wrapper.querySelector(".list");this._cleanElementsList(),this._createListElement(t,this._arrayList.data)}this.selected()&&this.selected().classList.toggle("select"),this._toggleBlankRow(),this.moveUpAction.disabled=!0,this.moveDownAction.disabled=!0}get rowsItem(){return this.wrapper.querySelectorAll(".list .row")}get rowEditableSelected(){return this._rowEditableSelected}set rowEditableSelected(e){this._rowEditableSelected=e}rowById(e){return this.wrapper.querySelector("ul[data-key='".concat(e,"']"))}get rowSelected(){var e;if(this.selected()){var t=this.selected().getAttribute("data-key");e=this.arrayList.data.find(e=>parseInt(e[this.idItem],10)===parseInt(t,10))}return e}set rowSelected(e){this.unSelectAll(),this.addAction.disabled=this.rowEditableSelected&&!0;var t=this.rowById(e[this.idItem]);t&&t.classList.add("select")}get isOverflowing(){return this._arrayList.data.length>this.MAX_ROWS}updateActionsButtons(){if(this.rowSelected){var e=this.arrayList.data.findIndex(e=>parseInt(e[this.idItem],10)===parseInt(this.rowSelected[this.idItem],10));if(-1!==e){var t=this.arrayList.data.length-1;this.moveUpAction.disabled=0===e,this.moveDownAction.disabled=e===t}}}get disabled(){return this._disabledStatus}set disabled(e){if(this._disabledStatus=e,this.addAction.disabled=e,this.moveUpAction.disabled=!0,this.moveDownAction.disabled=!0,this.rowSelected&&!e){var t=this.arrayList.data.findIndex(e=>parseInt(e[this.idItem],10)===parseInt(this.rowSelected[this.idItem],10));if(-1!==t){var s=this.arrayList.data.length-1;this.moveUpAction.disabled=t<s,this.moveDownAction.disabled=t>s}}}unSelectAll(e=!1){this.selected()&&this.selected().classList.remove("select"),this.disabled=e}_cleanElementsList(){this.wrapper.querySelectorAll(".list .row").forEach(e=>e.remove())}refreshList(){var e,t=this.editStatus?this.rowEditableSelected:this.rowSelected,s=this.wrapper.querySelector(".list");(this._cleanElementsList(),this._createListElement(s,this._arrayList.data),t)&&(this.rowsItem.forEach(s=>{parseInt(s.getAttribute("data-key"),10)===parseInt(t[this._idItem],10)&&(e=s)}),e.classList.toggle(this.editStatus?"edit-status":"select"));this.updateActionsButtons(),this._toggleBlankRow()}_initComponent(){var e=this.wrapper.querySelectorAll(".actions .btn");this._elementsList=this.wrapper.querySelector(".list"),this._createdDeleteAll=!1;var t=ys(e,3);this.addAction=t[0],this.moveUpAction=t[1],this.moveDownAction=t[2],this._setDefaultStateAction()}_initEvents(e){this.moveDownAction.addEventListener("click",()=>{this._moveDownItem()}),this.moveUpAction.addEventListener("click",()=>{this._moveUpItem()}),e?this.addAction.addEventListener("click",()=>{this.emit("add_item")}):(this.addAction.remove(),this.moveDownAction.classList.add("btn-col-2"),this.moveUpAction.classList.add("btn-col-2"))}_setDefaultStateAction(){this.moveUpAction.disabled=!0,this.moveDownAction.disabled=!0}_initListTable(){var e=this.wrapper.querySelector(".list"),t=e.querySelectorAll("ul");t.length>0&&t.forEach(e=>e.remove());var s=this._createRowElement(this.arrayList.header,!0);e.appendChild(s),this._createListElement(e,this.arrayList.data),this._toggleBlankRow()}_toggleBlankRow(){var e=this.wrapper.querySelector(".list"),t=e.querySelector("ul[data-empty]");if(null!==t&&(t.remove(),t=null),0===this.arrayList.data.length&&null===t&&1===e.children.length){var s=document.createElement("ul");s.classList.add("row"),s.setAttribute("data-empty",!0),this.arrayList.header.forEach(()=>{var e=this._createCellElement("",!1);s.appendChild(e)}),e.appendChild(s)}}_createDeleteActionElement(){var e=document.createElement("a");e.setAttribute("href","#");var t=document.createElement("i");return t.setAttribute("class","fas fa-times"),e.appendChild(t),e.addEventListener("click",()=>this.deleteItem()),e}_createCheckAllActionElement(e){var t=document.createElement("a"),s=document.createElement("i");return s.setAttribute("class","fas fa-tasks"),t.appendChild(s),t.setAttribute("class","checkbox"),t.style.marginLeft="0.4em",t.addEventListener("click",()=>{this.checkAllItems(e)}),t}_createDeleteAllActionElement(){var e=document.createElement("a");e.classList.add("delete-all");var t=document.createElement("i");return t.setAttribute("class","fas fa-times"),e.appendChild(t),e.addEventListener("click",()=>{this._deleteAllItems()}),e}_createEditActionElement(){var e=document.createElement("a");e.classList.add("edit");var t=document.createElement("i");return t.setAttribute("class","fas fa-pen"),e.appendChild(t),e.addEventListener("click",()=>this.fireEdition(this.target())),e}_createCheckActionElement(e,t){var s=document.createElement("a");s.setAttribute("href","#"),s.setAttribute("name",t.key),s.setAttribute("class","checkbox");var i=document.createElement("i");return e?i.setAttribute("class","far fa-check-square fa-lg"):i.setAttribute("class","far fa-square fa-lg"),s.appendChild(i),s.addEventListener("click",()=>{this.checkItem()}),s}_createAccordingTheActionType(e,t=""){var s,i=e.type||e;switch(i){case"checkbox":s=this._createCheckActionElement(t,e);break;case"delete":s=this._createDeleteActionElement();break;case"edit":s=this._createEditActionElement()}return s.title=i.toUpperCase(),s}_createCellElement(e,t){var s=document.createElement("li");if(t){if("delete-all"!==e&&"edit"!==e&&(s.innerText=e),"string"==typeof e){var i=e.toLowerCase();i!==M.a.t("listComponent.txtListComponentHeaderCond")&&i!==M.a.t("listComponent.txtListComponentHeaderInOut")&&i!==M.a.t("listComponent.txtListComponentHeaderType")&&i!==M.a.t("listComponent.txtListComponentHeaderEntity")&&i!==M.a.t("listComponent.txtListComponentHeaderProcess")||s.classList.add("condition-cell"),"event"===i&&s.classList.add("medium-cell"),"binding"===i&&s.classList.add("binding-cell")}void 0!==e.type&&(s.innerText=e.title,s.classList.add("cell-center"),s.classList.add("action-cell")),"delete-all"!==e&&"edit"!==e||s.classList.add("action-cell")}else{var a=this.arrayList.actions.find(t=>e[0]===t.key);if(a){s.setAttribute("class","cell-center");var n=this._createAccordingTheActionType(a||"delete",e[1]);s.appendChild(n),s.classList.add("action-cell")}else s.setAttribute("title",e[1]||""),s.innerText=e[1]||""}return s}_createRowElement(e,t){var s=document.createElement("ul");if(e.forEach(e=>{var i=this._createCellElement(e,t);if(("delete-all"===e||"edit"===e)&&t&&(i.classList.add("cell-center"),this.arrayList.deleteActionAll&&"delete-all"===e)){var a=this._createDeleteAllActionElement();this._createdDeleteAll=!0,i.appendChild(a)}this.arrayList.notShow.find(t=>e[0]===t)||s.appendChild(i)}),!t){s.setAttribute("class","row");var i=e.find(e=>e[0]===this._idItem);if(i&&s.setAttribute("data-key",i[1]),this.arrayList.editAction){var a=this._createCellElement("",!1);a.classList.add("cell-center");var n=this._createAccordingTheActionType("edit");a.appendChild(n),a.classList.add("action-cell"),s.appendChild(a)}if(this.arrayList.deleteAction){var r=this._createCellElement("",!1);r.classList.add("cell-center");var o=this._createAccordingTheActionType("delete");r.appendChild(o),r.classList.add("action-cell"),s.appendChild(r)}s.addEventListener("click",()=>{this.selectElement()})}return s}_createListElement(e,t){t&&t.forEach(t=>{var s=Object.entries(t),i=this._createRowElement(s,!1);e.appendChild(i)})}target(){var e;if(void 0!==event.target)for(e=event.target;"ul"!==e.nodeName.toLowerCase();)e=e.parentNode;return e}selected(){return this.wrapper.querySelector("ul.row.select")}selectElement(){var e=this.selected();null!==e&&(e.getAttribute("data-key")!==this.target().getAttribute("data-key")&&e.classList.remove("select"));if(!this.editStatus&&!this.disabled){this.target().classList.contains("select")||this.target().classList.add("select");var t=this.selected(),s=this.arrayList.data.find(e=>parseInt(e[this._idItem],10)===parseInt(t.getAttribute("data-key"),10));this.emit("selected_item",s),this._enableOrDisableActionBtn()}}_enableOrDisableActionBtn(){if(null!==this.selected()&&void 0!==this.selected()){var e=this.wrapper.querySelector(".list").firstElementChild;this.moveUpAction.disabled=e===this.selected().previousElementSibling,this.moveDownAction.disabled=null===this.selected().nextElementSibling}else this._setDefaultStateAction()}_check(e,t){var s=t?"far fa-square fa-lg":"far fa-check-square fa-lg";return e.setAttribute("class",s),e}checkItem(){event.stopPropagation();var e,t=event.target,s=this.rowEditableSelected&&this.rowEditableSelected.id;if("checkbox"===t.parentNode.getAttribute("class")){e=this.target().getAttribute("data-key");var i=this.arrayList.data.findIndex(t=>parseInt(t[this._idItem],10)===parseInt(e,10)),a=event.target.parentNode.getAttribute("name"),n=this.arrayList.data[i];this._check(t,n[a]),n[a]=!n[a],this.emit("checked_item",{value:n[a],position:i,keyName:a}),this.rowEditableSelected&&+e===s?this.rowEditableSelected=n:this.rowSelected=n,this._editStatus||this._enableOrDisableActionBtn()}}checkAllItems(e){this.arrayList.data.forEach(t=>{t[e.key]=e.all}),this.wrapper.querySelectorAll(".checkbox i").forEach(t=>{t.parentNode.name===e.key&&this._check(t,e.all)}),e.all=!e.all}addItem(e){if(e&&!this.arrayList.data.find(t=>parseInt(t[this._idItem],10)===parseInt(e.id,10))){this.arrayList.data.push(e);var t=Object.entries(e),s=this._createRowElement(t,!1);this._elementsList.appendChild(s),this.updateActionsButtons()}this._toggleBlankRow()}_deleteInArray(e){var t=this.arrayList.data.findIndex(t=>parseInt(t[this._idItem],10)===parseInt(e,10));-1!==t&&this.arrayList.data.splice(t,1)}fireEdition(e){event.stopPropagation(),this.selectElement();var t=this.wrapper.querySelector(".row.edit-status"),s=!1;t?(s=parseInt(t.getAttribute("data-key"),10)===parseInt(e.getAttribute("data-key"),10),this.rowEditableSelected?(this.moveUpAction.disabled=!0,this.moveDownAction.disabled=!0):(this.moveUpAction.disabled=!1,this.moveDownAction.disabled=!1)):this._setDefaultStateAction();if((!t&&!this.editStatus||this.editStatus&&s)&&!this.disabled){if(this.editStatus=!this.editStatus,e.classList.toggle("edit-status"),e&&this.editStatus){var i=e.getAttribute("data-key");this.rowsItem.forEach(e=>e.classList.remove("select")),this.rowEditableSelected=this.arrayList.data.find(e=>parseInt(e[this._idItem],10)===parseInt(i,10))}else this.selectElement(),this.rowEditableSelected=null;this.emit("edit_item",this.editStatus)}}deleteItem(){if(event.stopPropagation(),!this.editStatus&&!this.disabled){var e=this.target(),t=parseInt(e.getAttribute("data-key"),10),s=this.arrayList.data.find(e=>parseInt(e[this._idItem],10)===parseInt(t,10));e.remove(),this._toggleBlankRow(),this.emit("delete_item",s),this._enableOrDisableActionBtn(),this.showDeleteItem(s)}}showDeleteItem(e){var t=new us,s=this._label.match(/(^\w+)/g)||"Delete Item",i="".concat(e.busClaName?"<b>".concat(M.a.t("listComponent.txtListComponentHeaderToastMessageBusinessClass"),":</b> ").concat(e.busClaName,"<br>"):"","\n     ").concat(e.name?"<b>".concat(M.a.t("listComponent.txtListComponentHeaderToastMessageName"),"</b> ").concat(e.name,"<br>"):"","\n     ").concat(e.haveCond?"<b>".concat(M.a.t("listComponent.txtListComponentHeaderToastMessageCondition"),"</b> ").concat(e.haveCond):"");t.showMessage(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?bs(Object(s),!0).forEach((function(t){Ts(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):bs(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({type:"info",title:"".concat(M.a.t("listComponent.txtListComponentHeaderToastMessageTitle")," ").concat(s),message:i},{duration:15e3,position:"bottom-left"}))}_deleteAllItems(){this.editStatus||(0===this.arrayList.data.length||this.disabled||confirm(M.a.t("listComponent.txtListComponentHeaderConfirmMessage"))&&(this.arrayList.data=[],this.rowsItem.forEach(e=>e.remove()),this._toggleBlankRow(),this.emit("delete_all_items")))}_scrollToRow(e,t,s=!0){var i=e;e instanceof Node||(i=this.rowById(e[this.idItem]),s&&(this.rowSelected=e)),i.scrollIntoView({behavior:"smooth",block:"nearest"}),s&&(t&&t(),this.updateActionsButtons())}_move(e){var t,s,i=0,a=0;this.rowsItem.forEach((n,r)=>{if(this.selected().getAttribute("data-key")===n.getAttribute("data-key")){i="up"===e?r-1:r+1;var o=this.arrayList.data[i];this.arrayList.data[i]=this.arrayList.data[r],this.arrayList.data[r]=o,a=r;var l=this.rowsItem[i],h="up"===e?"beforebegin":"afterend";l.insertAdjacentElement(h,n),t=this.arrayList.data[i],s=this.arrayList.data[r]}}),this._scrollToRow(this.selected()),this.emit("move",i,a,t,s,this.arrayList.data)}_moveUpItem(){this.editStatus||null!==this.selected().previousElementSibling&&(this._move("up"),this._enableOrDisableActionBtn())}_moveDownItem(){this.editStatus||null!==this.selected().nextElementSibling&&(this._move("down"),this._enableOrDisableActionBtn())}}function Ss(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function fs(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ss(Object(s),!0).forEach((function(t){Is(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ss(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Is(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Cs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ps(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function As(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){Ps(n,i,a,r,o,"next",e)}function o(e){Ps(n,i,a,r,o,"throw",e)}r(void 0)}))}}class ks extends gs{constructor(e,t,s,i=""){var a,n;super("condition",e,t,s),a=this,this._conditionArea=this.wrapper.querySelector(".condition_area"),this._conditionArea.value="",this.help=this.wrapper.querySelector("a.condition_question"),this.validate=this.wrapper.querySelector("a.condition_validate"),this.syntaxRules=this.wrapper.querySelector(".condition_syntax_rules"),this._isValid=!1,this.placeholder=i,this._hideValidate(!0),this.help.addEventListener("click",()=>{this.syntaxRules.hidden=!this.syntaxRules.hidden}),this.validate.addEventListener("click",As((function*(){yield a._onConditionAreaValidated()}))),this._conditionArea.addEventListener("blur",As((function*(){yield a._onConditionAreaValidated()}))),this._conditionArea.addEventListener("input",()=>{"Production"!==A.ENV&&(clearTimeout(n),n=setTimeout(()=>{this._onConditionAreaChanged(),clearTimeout(n)},800)),"Production"===A.ENV&&(this.isValid=!1,this._hideValidate(!1))})}get isValid(){return this._isValid}set isValid(e){this._isValid=e}get conditionAreaEl(){return this._conditionArea}get conditionArea(){return this._conditionArea.value.trim()}set conditionArea(e){this._conditionArea.value=e}set placeholder(e){this._conditionArea.placeholder=e}set disabled(e){this.conditionAreaEl.disabled=e}get disabled(){return this.conditionAreaEl.disabled}_hideValidate(e){e?this.validate.classList.add("invisible"):this.validate.classList.remove("invisible")}resetValidate(){this.isValid=!1,this.validate.removeAttribute("data-valid")}_onConditionAreaChanged(){this.emit("change_condition",this.conditionArea)}_validate(){var e=this;return As((function*(){var t=e.conditionArea,s="".concat(A.VALIDATE_COND_URL).concat(encodeURI(t));if("Production"===A.ENV&&!e.disabled)try{var i=yield he.a.post(s);i&&i.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession();var a=Cs((new as).convertToJson(i.data),1)[0];return e.isValid="OK"===a.message,e._hideValidate(!0),a}catch(e){throw Error("".concat(M.a.t("conditionalComponent.txtConditionalComponentErrorMessage"),"\n ").concat(e))}return!0}))()}_onConditionAreaValidated(){var e=this;return As((function*(){if("Production"===A.ENV){var t=new us,s=yield e._validate(),i={duration:3e3,position:"bottom-left"};if(e.isValid)e._onConditionAreaChanged(),""!==e.conditionArea&&t.showMessage(fs({type:"success",title:M.a.t("conditionalComponent.txtConditionalComponentToastTitleSuccess"),message:M.a.t("conditionalComponent.txtConditionalComponentToastTitleSuccessMessage")},i));else if(s.message){var a=s.message.split(".  Algunos")[0];t.showMessage(fs({type:"danger",title:M.a.t("conditionalComponent.txtConditionalComponentToastTitle"),message:a},i))}}}))()}}function ws(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function Ms(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){ws(n,i,a,r,o,"next",e)}function o(e){ws(n,i,a,r,o,"throw",e)}r(void 0)}))}}class Ls extends gs{constructor(e,t,s,i=!0,a=800,n,r=!1){super("search",e,t,s),this._init(i,a,e,n,r)}set placeholder(e){this._selectEl.placeholder=e}get data(){return this._dataList}get valueEl(){return this._selectEl.value}set valueEl(e){this._selectEl.value=e}get selectEl(){return this._selectEl}set selectEl(e){this._selectEl.value=e}set disabled(e){this._selectEl.disabled=e}get selectedItem(){var e=this.valueEl.toLowerCase().trim();return this._dataList.find(t=>t.name.toLowerCase().trim()===e)}set url(e){this._url=e}get load(){return this._load}set load(e){this._load=e,this.showData()}get alwaysEnableBtn(){return this._alwaysEnableBtn}set alwaysEnableBtn(e){this._alwaysEnableBtn=e,this.addBtn.disabled=!e}get dataList(){return this._dataList}set add(e){this.addBtn.setAttribute("data-visible",e)}_init(e,t,s,i,a){var n=this;this.addBtn=this.wrapper.querySelector(".btn"),this.addBtn.title+=" ".concat(this.label),this._selectEl=this.wrapper.querySelector(".input_control"),this.listItems=this.wrapper.querySelector(".items_list"),this.listItems.setAttribute("id","".concat(this.listItems.id,"_").concat(s)),this._selectEl.setAttribute("list",this.listItems.id),this._dataList=[],this._url=i,this.hasLabel=a,this.valueToFind=this.valueEl.toLowerCase(),this._responseTime=t,this._load=!1,this._alwaysEnableBtn=!1,this._searchAction=this.wrapper.querySelector("a.search_action"),this.addBtn.addEventListener("click",()=>{this.addAction()}),e?this.addBtn.disabled=!this._alwaysEnableBtn:this.addBtn.setAttribute("data-visible",e),this.selectEl.addEventListener("click",()=>{""!==this.valueEl&&(this.valueEl="",this.alwaysEnableBtn=!1)}),this.panel.parentNode.addEventListener("wheel",()=>{this._selectEl.blur()}),this.panel.parentNode.addEventListener("scroll",()=>{this._selectEl.blur()}),this._searchAction.addEventListener("click",Ms((function*(){0!==n._responseTime&&(n.valueEl="",yield n._getResultData(),n._selectEl.focus())})))}addAction(){var e=this.selected();this.emit("add_item",e)}selected(){var e=Array.from(this.listItems.options).find(e=>e.value.toLowerCase().trim()===this.valueEl.toLowerCase()),t={};return void 0!==e?(t={id:e.getAttribute("data-key"),name:e.value},e.label&&(t.label=e.label),this._alwaysEnableBtn||this._enableBtn(!1),this.emit("select_item",t)):(this._alwaysEnableBtn||this._enableBtn(!0),this.emit("select_item",void 0)),t}_enableBtn(e){null!==this.addBtn&&(this.addBtn.disabled=e)}loadData(){var e=this;return Ms((function*(){try{var t=new as,s=yield he.a.get(e._url);s&&s.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession(),e._dataList=t.convertToJson(s.data),0===e.listItems.querySelectorAll("option").length&&e._loadDataList(e._dataList,e.hasLabel)}catch(e){}}))()}_getResultData(){var e=this;return Ms((function*(){e._cleanData(),yield e.loadData()}))()}showData(){var e=this;return Ms((function*(){var t;0===e._responseTime&&e.load&&0===e._dataList.length&&(yield e._getResultData()),e._selectEl.addEventListener("input",()=>{clearTimeout(t),0!==e._responseTime&&(t=setTimeout(Ms((function*(){var s=e._selectEl.value,i=-1!==e._dataList.findIndex(e=>e.name===s);e.valueToFind===s||""===s||i||(yield e._getResultData(),e.valueToFind=s),clearTimeout(t)})),e._responseTime)),e.selected()})}))()}_cleanData(){var e=this.listItems.querySelectorAll("option");if(e.length>0)for(var t=0;t<e.length;t++)e[t].remove()}_loadDataList(e,t){e.forEach(e=>{var s=e.name,i=e.id,a=document.createElement("option");a.setAttribute("value",s),a.setAttribute("data-key",i),a.addEventListener("mouseover",()=>{}),t&&a.setAttribute("label",e.label),this.listItems.appendChild(a)})}}function xs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class Ns extends gs{constructor(e,t,s,i){super("date",e,t,s),this._init(i)}_init(e){var t=this.wrapper.querySelectorAll(".date input"),s=this.wrapper.querySelectorAll(".time input"),i=xs(t,3);this._year=i[0],this._month=i[1],this._day=i[2];var a=xs(s,2);if(this._hour=a[0],this._minute=a[1],this._actual=new Date,e){var n=e.date,r=e.time;this.year=n.year,this.month=n.month,this.day=n.day,this.hour=r.hour,this.minutes=r.minutes}t.forEach(e=>{e.addEventListener("change",()=>{this._onValidateDateTime(e),this._isNotEmpty()&&this.emit("change_date",this.date)})}),s.forEach(e=>{e.addEventListener("change",()=>{this._onValidateDateTime(e),this._isNotEmpty()&&this.emit("change_date",this.date)})})}set date(e){var t=e.date,s=e.time;this.year=t.year,this.month=t.month,this.day=t.day,this.hour=s.hour,this.minutes=s.minutes}get actualYear(){return this._actual.getFullYear()}get actualMonth(){return this._actual.getMonth()+1}get actualDay(){return this._actual.getDate()}get actualHour(){return this._actual.getHours()}get actualMinutes(){return this._actual.getMinutes()}get year(){var e=this._year.value;return""===e?-1:parseInt(e,10)}get month(){var e=this._month.value;return""===e?-1:parseInt(e,10)}get day(){var e=this._day.value;return""===e?-1:parseInt(e,10)}get hour(){var e=this._hour.value;return""===e?-1:parseInt(e,10)}get minutes(){var e=this._minute.value;return""===e?-1:parseInt(e,10)}get date(){return this._isNotEmpty()||this._onValidateDateTime(void 0),new Date(this.year,this.month-1,this.day,this.hour,this.minutes)}set year(e){this._year.value=e}set month(e){this._month.value=this.format(e)}set day(e){this._day.value=this.format(e)}set hour(e){this._hour.value=this.format(e)}set minutes(e){this._minute.value=this.format(e)}format(e){return""!==e&&(e=parseInt(e,10))<10?"0".concat(e):e}clean(){this.year="",this.month="",this.day="",this.hour="",this.minutes=""}_getNumberOfDay(e,t){switch(e){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;case 2:return this._isLeapYear(t)?29:28;default:return 30}}_isLeapYear(e){return e%4==0&&e%100!=0||e%400==0}_isNotEmpty(){return-1!==this.year&&-1!==this.month&&-1!==this.day&&-1!==this.hour&&-1!==this.minutes}_validateYear(){this.year<this.actualYear&&(this.year=this.actualYear)}_validateMonth(){this.year===this.actualYear&&(this.month<this.actualMonth||this.month>12)&&(this.month=this.actualMonth),(this.month>12||this.month<1)&&(this.month=1),this.month=this.format(this.month)}_validateDay(){var e=this._getNumberOfDay(this.month,this.year);this.year===this.actualYear&&this.month===this.actualMonth&&(this.day<this.actualDay||this.day>e)&&(this.day=this.actualDay),this.day>e&&(this.day=e),this.day<1&&(this.day=1),this.day=this.format(this.day)}_validateHour(){this.year===this.actualYear&&this.month===this.actualMonth&&this.day===this.actualDay&&(this.hour<this.actualHour||this.hour>23)&&(this.hour=this.actualHour),this.hour=this.format(this.hour)}_validateMinutes(){this.year===this.actualYear&&this.month===this.actualMonth&&this.day===this.actualDay&&this.hour===this.actualHour&&(this.minutes<this.actualMinutes||this.minutes>59)&&(this.minutes=this.actualMinutes),this.minutes=this.format(this.minutes)}_onValidateDateTime(e){""!==(e?e.value:"")&&(this._validateYear(),this._validateMonth(),this._validateDay(),this._validateHour(),this._validateMinutes())}}class Os extends gs{constructor(e,t,s=[]){super("tabpanel",e,t),this._tabsArray=s,this._init()}get activeTab(){return this._wrapperTabs.querySelector("li a.active")}get visibleTabBody(){return this.panel.querySelector('div.tabpanel_body[data-visible="true"]')}set disabledAllTabs(e){this._tabsElements.forEach(t=>{e?t.classList.add("disabled"):t.classList.remove("disabled")})}getTab(e){return this.panel.querySelector(".tabpanel_body[data-tab=".concat(e,"]"))}_init(){this._wrapperTabs=this.wrapper.querySelector("header.tabpanel_header ul"),this._buildTabs(),this._tabsElements=this._wrapperTabs.querySelectorAll("li a"),this._initEvents()}_buildTabs(){if(this._wrapperTabs&&this._tabsArray.length>0)for(var e=0;e<this._tabsArray.length;e++){var t=this._tabsArray[e],s=document.createElement("a");s.setAttribute("href","#"),s.setAttribute("data-target",t.targetId),s.innerText=t.title,0===e&&s.classList.add("active");var i=this.tabBodyById(s);this._toggleVisible(i,0===e);var a=document.createElement("li");this._wrapperTabs.append(a),a.append(s)}}_initEvents(){this._tabsElements.forEach(e=>{e.addEventListener("click",()=>{this._onActiveTab(e)})})}_isDisabled(e){return e.classList.contains("disabled")}tabBodyById(e){var t=e.getAttribute("data-target");return this.panel.querySelector("#body_".concat(t))}_onActiveTab(e){if(!this._isDisabled(e)){this.activeTab.classList.toggle("active"),e.classList.toggle("active");var t=this.tabBodyById(e);this._toggleVisible(this.visibleTabBody,!1),this._toggleVisible(t,!0)}}_toggleVisible(e,t){e.setAttribute("data-visible",t)}}function Ds(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function Rs(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){Ds(n,i,a,r,o,"next",e)}function o(e){Ds(n,i,a,r,o,"throw",e)}r(void 0)}))}}function Bs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class Vs extends gs{constructor(e,t,s,i=!1,a="",n="",r=!1,o=!1,l=""){super("dropdown",e,t,s),this._init(i,a,n,r,o,l)}get valueEl(){return this._inputSearch.value}get selectedItem(){return this._selectedItem}get disabled(){return this._inputSearch.disabled}set valueEl(e){this._inputSearch.value=e}set local(e){this._isLocal=e}set selectedItem(e){this._selectedItem=e,this.valueEl=e?e.name:"",this._inputSearch.setAttribute("title",e?e.name:"");var t=void 0===e;this._toggleClearInput(t)}set placeholder(e){this._inputSearch.placeholder=e}set disabled(e){this._inputSearch.disabled=e}get url(){return this._url}set url(e){this._url=e,this.reloadData(this._url)}get baseUrl(){return this._baseUrl}set data(e){this._appData=e,this._cleanList(),this._fillList(this._appData)}get data(){return this._appData}_init(e,t,s,i,a,n){this._inputSearch=this.wrapper.querySelector(".dropdown-list__input-control"),this._caretDown=this.wrapper.querySelector(".dropdown-list__input-action"),this._clearInput=this.wrapper.querySelector(".dropdown-list__input-empty-action"),this._itemList=this.wrapper.querySelector(".datalist"),this._addButton=this.wrapper.querySelector("button.btn"),this._taskTitleInput=this.wrapper.parentNode.querySelector("#task_title_input"),this._url=t,this._baseUrl=s,this._hasLabel=i,this._canReload=a,this._add=e,this._selectedItem=void 0,this._hasPreviousFocus=!1,this._isLoad=!1,this._isLocal=!t,this._appData=[],this._actionReload=!1,this.placeholder=n,this._eventsHandlers(),this._toggleVisibleButton(e)}_eventsHandlers(){this._caretDown.addEventListener("click",()=>this._onDropDown()),this._caretDown.addEventListener("blur",()=>this._onBlurCaretDown()),this._inputSearch.addEventListener("click",()=>this._onFousInputSearch()),this._inputSearch.addEventListener("blur",()=>this._onBlurInputSearch()),this._inputSearch.addEventListener("input",()=>this._onFilterInputSearch()),this._clearInput.addEventListener("click",()=>this.onClearInput()),this._addButton.addEventListener("click",()=>this.emit("add_item"))}_toggleVisibleButton(e){this._addButton.setAttribute("data-visible",e)}toggleDisabledButton(e){this._addButton.disabled=e}selectFirst(){if(this.data.length>0){var e=Bs(this.data,1)[0];this.selectedItem=e}}_getData(e){var t=this;return Rs((function*(){if(!t._isLocal){t._appData=[];try{var s=yield he.a.get(e);s&&s.data.toUpperCase().indexOf("HTML")>-1&&t.showInvalidSession(),(new as).convertToJson(s.data).forEach(e=>{var s=e.id,i=e.name,a=e.label,n=e.type,r=a?{id:s,name:i,label:a,type:n}:{id:s,name:i};t._appData.push(r)})}catch(e){throw new Error("".concat(M.a.t("dropDownListComponent.txtDropDownListComponentErrorMessage")," \n"),e)}}}))()}reloadData(e=this._url){var t=this;return Rs((function*(){yield t._getData(e),t._cleanList(),t._fillList(t._appData)}))()}_cleanList(){for(;this._itemList.firstChild;)this._itemList.removeChild(this._itemList.firstChild)}_fillList(e){(e.length>10?e.slice(0,100):e).forEach(e=>{var t=document.createElement("li"),s=document.createElement("span");if(s.innerText=e.name,s.classList.add("datalist__title"),t.append(s),t.setAttribute("data-key",e.id),t.setAttribute("title",e.name),t.classList.add("datalist__item"),e.label){var i=document.createElement("span");i.classList.add("datalist__description"),i.innerText=e.label,i.setAttribute("title",e.label),t.appendChild(i)}if(-1===e.id&&this._canReload){var a=document.createElement("a");a.setAttribute("href","#"),a.classList.add("datalist__reload-button"),a.title="Reload Data",a.addEventListener("mousedown",()=>this._onReloadButton()),t.append(a)}t.addEventListener("mousedown",()=>this._onSelect(t)),this._itemList.appendChild(t)})}_toggleClearInput(e){this._clearInput.setAttribute("data-empty",e),this._inputSearch.setAttribute("data-empty",e)}_toggleList(e){this._itemList.setAttribute("data-visible",e),this._caretDown.setAttribute("data-down",e)}getItemById(e){return this._appData.find(t=>parseInt(t.id,10)===parseInt(e,10))}getItemByName(e){return this._appData.find(t=>e.toUpperCase().trim()===t.name)}_onReloadButton(){this.reloadData(this._url),this._actionReload=!0}_onSelect(e){var t=parseInt(e.getAttribute("data-key"),10),s=this.getItemById(t);s&&(this._inputSearch.value=s.name,this._inputSearch.setAttribute("title",s.name),this._selectedItem=s,this._toggleClearInput(!1)),-1===t&&this.onClearInput(),this.emit("select_item",this._selectedItem)}_onDropDown(){if(!this.disabled){if(this.reloadData(this._url),this._isLoad=!0,this._isLocal&&!this._isLoad){this._cleanList();var e=0===this._appData.length?[{id:-1,name:M.a.t("dropDownListComponent.txtDropDownListComponentNotFoundName"),label:M.a.t("dropDownListComponent.txtDropDownListComponentNotFoundLabel")}]:this._appData;this._fillList(e)}var t=JSON.parse(this._itemList.getAttribute("data-visible"));this._toggleList(!t)}}_calculateDatalistTopRender(){var e=this._inputSearch.clientHeight,t=parseInt(this._inputSearch.getBoundingClientRect().y,10)+parseInt(this._inputSearch.scrollTop,10);if(window.innerHeight+parseInt(this._inputSearch.scrollTop,10)<e+t+320){this._itemList.classList.add("datalist--top");var s=-1*((0!==this._itemList.clientHeight?this._itemList.clientHeight:320)+58);document.documentElement.style.setProperty("--coordY","".concat(s,"px"))}else document.documentElement.classList.remove("datalist--top")}_onBlurCaretDown(){JSON.parse(this._itemList.getAttribute("data-visible"))&&this._toggleList(!1)}_onFousInputSearch(){this._inputSearch.value="",this._hasPreviousFocus&&(this._selectedItem=void 0,this._hasPreviousFocus=!1,this._toggleClearInput(!0)),this._selectedItem&&!this._hasPreviousFocus&&(this._cleanList(),this._fillList(this._appData),this._hasPreviousFocus=!0),this._selectedItem||this.toggleDisabledButton(!0),this._onDropDown()}_onBlurInputSearch(){this._selectedItem?this._inputSearch.value=this._selectedItem.name:this._selectedItem||this._add||this._actionReload||(this._inputSearch.value=""),this._toggleList(!1),this._hasPreviousFocus=!1,this._selectedItem||this._actionReload||(this._cleanList(),this._fillList(this._appData),""===this.valueEl&&this._add&&(this._toggleClearInput(!0),this.toggleDisabledButton(!0))),this._actionReload&&(this._inputSearch.focus(),this._actionReload=!1,this._onDropDown())}_applyFilter(e,t){return t.filter(t=>{var s=t.name,i=t.label,a=e.toUpperCase().trim();return i?s.toUpperCase().includes(a)||i.toUpperCase().includes(a):s.toUpperCase().includes(a)})}_onFilterInputSearch(){var e=this._inputSearch.value;this._selectedItem=void 0,this._cleanList();var t=this._applyFilter(e,this._appData);0===t.length&&t.push({id:-1,name:M.a.t("dropDownListComponent.txtDropDownListComponentNotFoundName"),label:M.a.t("dropDownListComponent.txtDropDownListComponentNotFoundLabel")}),this._fillList(t),JSON.parse(this._itemList.getAttribute("data-visible"))||this._toggleList(!0),this._selectedItem=this.getItemByName(e),this.emit("select_item",this._selectedItem)}onClearInput(){this._toggleClearInput(!0),this._selectedItem=void 0,this._inputSearch.value="",this._hasPreviousFocus=!1,this._cleanList(),this._fillList(this._appData),this.toggleDisabledButton(!0),this.emit("clear_item")}}class Fs extends me.a{constructor(e,t){super(),this._editor=e,this._panel=document.querySelector("#".concat(t,"_panel")),this.toastMessage||(this.toastMessage=new us),null===this._panel?this._panel=document.createDocumentFragment():(this._panel.setAttribute("data-visible",!1),this._documentationInput=this._panel.querySelector("#".concat(t,"_documentation_input")),this._resizeDocumentationHeight(),this._setTimeoutOnPropertyChanged(void 0,()=>this._onDocumentationInputChanged(),this._documentationInput,"input",100))}_resizeDocumentationHeight(){"Offline"===A.ENV&&(this._documentationInput.style.maxHeight="20em",this._documentationInput.style.height="15em")}get documentationInput(){return this._documentationInput?this._documentationInput.value:""}get element(){return this._editor.elementSelected||this._editor.workflow}get panel(){return this._panel}get editor(){return this._editor}set panel(e){this._panel=e}set documentationInput(e){void 0!==this._documentationInput&&(this._documentationInput.value=e)}get isVisible(){return!0===JSON.parse(this.panel.getAttribute("data-visible"))}_elementVisibility(e){var t=e.getAttribute("data-visible");return JSON.parse(t)}_changeVisibility(e,t){e.setAttribute("data-visible",t)}hide(){this._changeVisibility(this._panel,!1)}clean(e){var t=this.panel.querySelector("#wrapper_".concat(e));t&&t.remove()}_includeTemplate(e){var t=document.getElementById("".concat(e,"_template")),s=document.importNode(t.content,!0);return this._panel.appendChild(s),s}_onDocumentationInputChanged(){if(this.element)if(this.element.documentation){this.element.documentation!==this.documentationInput&&(this.element.documentation={text:this.documentationInput})}else{var e=this.editor.idIndex++;this.element.documentation={id:e,text:this.documentationInput}}}_setTimeoutOnPropertyChanged(e,t,s,i,a=100){s.addEventListener(i,()=>{clearTimeout(e),e=setTimeout(()=>{t(),clearTimeout(e)},a)})}_includeComponent(e,t,s,i,a){var n;switch(this._includeTemplate(e),t=this.panel.querySelector("#wrapper_".concat(e)),i){case"afterend":case"beforebegin":s.insertAdjacentElement(i,t);break;default:s.appendChild(t)}var r=a.nameId,o=a.label;switch(e){case"expander":var l=a.expandId;n=new vs(r,this.panel,l,o);var h=this.panel.querySelector("#".concat(l));t.insertAdjacentElement("afterend",h);break;case"search":var c=a.add,p=a.responseTime,d=a.url,u=a.hasLabel;n=new Ls(r,this.panel,o,c,p,d,u);break;case"list":var _=a.arrayList,m=a.add;n=new Es(r,this.panel,o,_,m);break;case"date":n=new Ns(r,this.panel,o);break;case"tabpanel":var g=a.tabs;n=new Os(r,this.panel,g);break;case"dropdown":var v=a.add,b=a.url,T=a.hasLabel,y=a.canReload,E=a.baseUrl;n=new Vs(r,this.panel,o,v,b,E,T,y);break;default:n=new ks(r,this.panel,o)}return n}}var Us={type:"info",title:"Information",duration:3e3,position:"bottom-left"},Ws=(M.a.t("configCmp.txtConfigCmpParameterTypeString"),M.a.t("configCmp.txtConfigCmpParameterTypeNumber"),M.a.t("configCmp.txtConfigCmpParameterTypeDate"),M.a.t("configCmp.txtConfigCmpTaskPanelRoleSearch"),A.ROLES_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskName"),A.TASK_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskCondition"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskGroupLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskGroupSearchLabel"),A.PARTICIPANTS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskGroupCondditionLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskGroupScheduleLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskGroupScheduleSearchLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskGroupScheduleSearchLabel"),A.TASK_SCHEDULE,M.a.t("configCmp.txtConfigCmpTaskPanelTaskGroupScheduleSubprocessLabel"),A.SUBPROCESS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskGroupScheduleTaskLabel"),A.SUBPROCESS_TASKS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskStatesLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskStatesEventLabel"),A.STATES_EVENTS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskStatesStatusLabel"),A.STATES_STATUS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskStatesListLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskStatesConditionLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskEventsLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskEventsSearchLabel"),A.STATES_EVENTS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskEventsBusClasLabel"),A.TASK_BUSCLAS_EVENTS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelTaskEventsListLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskEventsConditionLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskEventsBindingLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelTaskEventsAttributeLabel"),A.TASK_BINDINGS_ATTR_URL,M.a.t("configCmp.txtConfigCmpTaskPanelFormsLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelFormsStepsLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelFormsSearchLabel"),A.TASK_ENT_FORMS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelFormsListLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelFormsConditionLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelMultiInstanceLoopLabel"),A.TASK_MULTIINSTANCE_URL,M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefAttributeLabel"),A.TASK_INPUT_MSG_REF,M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefAttributeListLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefWSSearchLabel"),A.TASK_OUTPUT_WS_URL,M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefWSSearchAddLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefWSBindingListLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefOutputMessageLabel"),M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefAttributeSearchLabel"),A.WORKFLOW_ATTRS_URL,M.a.t("configCmp.txtConfigCmpWorkflowPanelEventsLabel"),A.WORKFLOW_EVENTS_URL,M.a.t("configCmp.txtConfigCmpWorkflowPanelBusClassLabel"),A.WORKFLOW_ACTIONS_URL,M.a.t("configCmp.txtConfigCmpWorkflowPanelBindingAttributeLabel"),A.WORKFLOW_ATTRS_URL,M.a.t("configCmp.txtConfigCmpWorkflowPanelEventsListLabel"),M.a.t("configCmp.txtConfigCmpWorkflowPanelBindingListParamsLabel"),M.a.t("configCmp.txtConfigCmpWorkflowPanelConditionLabel"),M.a.t("configCmp.txtConfigCmpConnectorPanelExpressionLabel"),M.a.t("configCmp.txtConfigCmpSubprocessPanelNameSearchLabel"),A.SUBP_NAME_URL,M.a.t("configCmp.txtConfigCmpSubprocessPanelLoopConditionLabel"),M.a.t("configCmp.txtConfigCmpSubprocessPanelReusableLabel"),M.a.t("configCmp.txtConfigCmpSubprocessPanelReusableEntitySearchLabel"),A.SUBP_REUSABLE_ENT_URL,M.a.t("configCmp.txtConfigCmpSubprocessPanelReusableFormsSearchLabel"),A.SUBP_REUSABLE_ENT_FORMS_URL,M.a.t("configCmp.txtConfigCmpSubprocessPanelReusableFormsListLabel"),M.a.t("configCmp.txtConfigCmpSubprocessPanelMultiInstanceLoopTypeLabel"),A.SUBP_MULTIINSTANCE_URL,{NONE:{groups:!0,loopType:!0,role:!0,forms:!0,schedule:!0,inputMessageRef:!1,outputMessageRef:!1,all:!0},USER:{groups:!0,loopType:!0,role:!0,forms:!0,schedule:!0,inputMessageRef:!0,outputMessageRef:!0,all:!0},MANUAL:{groups:!0,loopType:!0,role:!0,forms:!0,schedule:!0,inputMessageRef:!1,outputMessageRef:!1,all:!0},SERVICE:{groups:!1,loopType:!1,role:!1,forms:!1,schedule:!0,inputMessageRef:!0,outputMessageRef:!0,all:!1},RECEIVE:{groups:!1,loopType:!1,role:!1,forms:!1,schedule:!0,inputMessageRef:!0,outputMessageRef:!1,all:!1},SEND:{groups:!1,loopType:!0,role:!1,forms:!1,schedule:!0,inputMessageRef:!0,outputMessageRef:!1,all:!1},SCRIPT:{groups:!1,loopType:!0,role:!1,forms:!1,schedule:!0,inputMessageRef:!1,outputMessageRef:!1,all:!1}});M.a.t("configCmp.txtConfigCmpSubprocessEventPanelMessageLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventPanelAttributeSearchLabel"),A.EVT_MSG_ATTRS_URL,M.a.t("configCmp.txtConfigCmpSubprocessEventPanelAttributeListLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventPanelWSSearchLabel"),A.EVT_MSG_WS_URL,M.a.t("configCmp.txtConfigCmpSubprocessEventPanelWSListLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventPanelBindingListLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventPanelWSAttributeSearchLabel"),A.EVT_MSG_WS_ATTR_URL,A.EVT_MSG_WS_ATTR_URL,M.a.t("configCmp.txtConfigCmpSubprocessEventPanelTimerLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventPanelTimerAttributeSearchLabel"),A.EVT_TIMER_ATTR_URL,M.a.t("configCmp.txtConfigCmpSubprocessEventPanelTimerStartDateLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventPanelTimerEndDateLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerEventSearchLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerEventSearchPlaceholder"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerbusClasLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerbusClasPlaceholder"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerEventListLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerBindingListLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerConditionLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerConditionPlaceholder"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerBindingAttributeLabel"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerBindingAttributePlaceholder"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerParameterTypeString"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerParameterTypeNumber"),M.a.t("configCmp.txtConfigCmpSubprocessEventManagerParameterTypeDate");class zs extends me.a{constructor(e,t,s){super(),this._panel=s,this._id=e,this._inputs=[],this._include(t,"manager"),this.message||(this.message=new us)}get id(){return this._id}get panel(){return this._panel}get inputs(){return this._inputs}set inputs(e){this._inputs=e}_cleanElements(){this.inputs.forEach(e=>{e.value=""})}_getIndex(e,t,s="id"){return e.findIndex(e=>parseInt(t[s],10)===parseInt(e[s],10))}_include(e,t){var s="".concat(e,"_").concat(t),i=document.getElementById(s),a=document.importNode(i.content,!0);this.panel.appendChild(a)}_changeElementIDs(e){e.forEach(e=>{e.setAttribute("id","".concat(this.id,"_").concat(e.id))})}_includeComponent(e,t,s,i){this._include(e,"template");var a,n=this.panel.querySelector("#wrapper_".concat(e));switch(s){case"afterend":case"beforebegin":t.insertAdjacentElement(s,n);break;default:t.appendChild(n)}var r=i.nameId,o=i.label,l=i.placeholder;switch(e){case"expander":var h=i.expandId;a=new vs(r,this.panel,h,o);var c=this.panel.querySelector("#".concat(h));n.insertAdjacentElement("afterend",c);break;case"search":var p=i.add,d=i.responseTime,u=i.url,_=i.hasLabel;a=new Ls(r,this.panel,o,p,d,u,_);break;case"list":var m=i.arrayList,g=i.add;a=new Es(r,this.panel,o,m,g);break;case"date":a=new Ns(r,this.panel,o);break;case"tabpanel":var v=i.tabs;a=new Os(r,this.panel,v);break;case"dropdown":var b=i.add,T=i.url,y=i.hasLabel,E=i.canReload;a=new Vs(r,this.panel,o,b,T,y,E,l);break;default:a=new ks(r,this.panel,o,l)}return a}_setTimeoutOnPropertyChanged(e,t,s,i=1e3,a){t.addEventListener(s,()=>{clearTimeout(a),a=setTimeout(()=>{e(),clearTimeout(a)},i)})}_getMaxId(e,t="id"){var s=0;return e.forEach(e=>{s=parseInt(e[t],10)>s?parseInt(e[t],10):s}),s}emitChange(e){this.emit("change",e)}disabledAll(e){this.inputs.forEach(t=>{t.disabled=e})}}var Hs=(e,t,s="")=>{var i=t||/[&/\\"<>]/g;return e.replace(i,s)},Gs=e=>/^[a-zA-Z][a-zA-Z0-9_]+[a-zA-Z0-9]$/gi.test(e),js=(e,t=1)=>{var s=parseInt(e,10);return!isNaN(s)&&s>=t},qs=e=>!isNaN(Date.parse(e)),Ys=e=>{var t=e.type,s=e.value,i=!0;if(""!==s.trim())switch(t.toUpperCase()){case"NUMBER":(i=js(s))||(i=!0,e.value=0),e.value=parseInt(s,10);break;case"DATE":(i=qs(s))||(i=!0,e.value=Date.now())}return i};function Ks(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function Zs(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){Ks(n,i,a,r,o,"next",e)}function o(e){Ks(n,i,a,r,o,"throw",e)}r(void 0)}))}}function Xs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Js(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Qs(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Js(Object(s),!0).forEach((function(t){$s(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Js(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function $s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ei extends zs{constructor(e,t,s={}){super(e,"event",t),this._initElements(s),this._changeElementIDs(this.elementsCtrl),this._initEventsElements(),this.loadEventList=0}get elementsCtrl(){return[...this.inputs,this._eventSelect.wrapper,this._busClassSelect.wrapper,this._eventsList.wrapper,this._bindingsList.wrapper,this._eventCondition.wrapper,this.wrapBindingAttributeType]}get eventSelect(){return this._eventSelect.selectedItem}get busClassSelect(){return this._busClassSelect.selectedItem}get eventCondition(){return this._eventCondition.conditionArea}get bindingType(){return this._bindingType.value}get bindingValue(){return this._bindingValue.value.trim()}get bindingAttributeType(){return this.wrapBindingAttributeType.querySelector("input[type=radio]:checked").value}get bindingAttributesTypeAll(){return this.wrapBindingAttributeType.querySelectorAll("input[type=radio]")}get bindingAttribute(){return this._bindingAttribute.selectedItem}set eventSelect(e){this._eventSelect.selectedItem=e}set busClassSelect(e){this._busClassSelect.selectedItem=e}set eventCondition(e){this._eventCondition.conditionArea=e}set bindingType(e){this._bindingType.value=e}set bindingValue(e){this._bindingValue.value=e}set bindingAttributeType(e){this.wrapBindingAttributeType.querySelector("#binding_attr_type_".concat(e)).checked=!0}set bindingAttribute(e){this._bindingAttribute.selectedItem=e}set eventsList(e){this.loadEventList++,"manager_workflow_events"===this.panel.id&&this.loadEventList,this._eventsList.arrayList.data=Se()(e||[]),this._eventsList.refreshList()}set bindingsList(e){this._bindingsList.arrayList.data=e,this._bindingsList.refreshList()}reset(){this.eventSelect=void 0,this.busClassSelect=void 0,this._disableClearAssociatedWithEvent(),this._eventsList.unSelectAll(),this._eventsList.editStatus&&(this._eventsList.editStatus=!1)}_initElements(e){this.EVENT_MANAGER={EVENTS_SEARCH:{nameId:"manager_search_events",label:M.a.t("eventManager.txtProDesEventManagerEventSearchLabel"),add:!1,hasLabel:!1,placeholder:M.a.t("eventManager.txtProDesEventManagerEventSearchPlaceholder")},BUSCLASS_SEARCH:{nameId:"manager_search_busclass",label:M.a.t("eventManager.txtProDesEventManagerBusClasLabel"),add:!1,hasLabel:!1,placeholder:M.a.t("eventManager.txtProDesEventManagerBusClasPlaceholder")},EVENTS_LIST:{nameId:"manager_list_events",label:M.a.t("eventManager.txtProDesEventManagerEventListLabel"),add:!0},BINDINGS_LIST:{nameId:"manager_list_bindings_params",label:M.a.t("eventManager.txtProDesEventManagerBindingListLabel"),add:!1},CONDITION:{nameId:"manager_condition_event",label:M.a.t("eventManager.txtProDesEventManagerConditionLabel"),placeholder:M.a.t("eventManager.txtProDesEventManagerConditionLabel")},BINDING_ATTR_SEARCH:{nameId:"manager_binding_attr_event",label:M.a.t("eventManager.txtProDesEventManagerBindingAttributeLabel"),add:!0,hasLabel:!0,canReload:!0,placeholder:M.a.t("eventManager.txtProDesEventManagerBindingAttributePlaceholder")},LIST_INTERFACE:{header:[M.a.t("eventManager.txtProDesEventManagerListInterfaceHeaderEdit"),M.a.t("eventManager.txtProDesEventManagerListInterfaceHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!0,data:[],notShow:[],actions:[]},PARAMS_TYPE:{S:M.a.t("eventManager.txtProDesEventManagerParameterTypeString"),N:M.a.t("eventManager.txtProDesEventManagerParameterTypeNumber"),D:M.a.t("eventManager.txtProDesEventManagerParameterTypeDate")}},this.OPTIONS_TOAST={type:"info",title:M.a.t("eventManager.txtProDesEventManagerToastTitle"),duration:3e3,position:"bottom-left"};var t=e.eventsUrl,s=e.busClassUrl,i=e.attributesUrl;this._options=e;var a=this.EVENT_MANAGER,n=a.EVENTS_LIST,r=a.BINDINGS_LIST,o=a.EVENTS_SEARCH,l=a.BUSCLASS_SEARCH,h=a.CONDITION,c=a.BINDING_ATTR_SEARCH;o.url=t,l.url=s,c.url=i,n.arrayList=this._createEventsArrayList(),r.arrayList=this._createBindingsParamsArrayList(),this._defaultAttrUrl=A.DEFAULT_ATTRS_URL,this._bindingType=this._panel.querySelector("#event_binding_type"),this._bindingValue=this._panel.querySelector("#event_binding_value"),this.wrapBindingType=this._panel.querySelector("#wrapper_event_binding_type"),this.wrapBindingAttributeType=this._panel.querySelector("#wrapper_event_binding_attr_type"),this.wrapBindingValue=this._panel.querySelector("#wrapper_event_binding_value"),this._eventSelect=this._includeComponent("dropdown",this.wrapBindingType,"beforebegin",o),this._busClassSelect=this._includeComponent("dropdown",this._eventSelect.wrapper,"afterend",l),this._eventsList=this._includeComponent("list",this._busClassSelect.wrapper,"afterend",n),this._eventCondition=this._includeComponent("condition",this._eventsList.wrapper,"afterend",h),this._bindingsList=this._includeComponent("list",this._eventCondition.wrapper,"afterend",r),this._bindingAttribute=this._includeComponent("dropdown",this.wrapBindingAttributeType,"afterend",c),this._bindingAttribute.toggleDisabledButton(!0),this.eventSelected=null,this.bindingSelected=null,this.inputs=[this._bindingType,this._bindingValue],this.reset()}_createEventsArrayList(){return Qs(Qs({},this.EVENT_MANAGER.LIST_INTERFACE),{},{header:["Business Class","Event","cond","edit","delete-all"],notShow:["id","eventId","condition","busClaId","order","bindings","WS"]})}_createBindingsParamsArrayList(){return Qs(Qs({},this.EVENT_MANAGER.LIST_INTERFACE),{},{header:["Parameter","Type","In/Out","Binding"],deleteAction:!1,deleteActionAll:!1,editAction:!1,notShow:["id"]})}_initEventsElements(){this._eventsList.on("selected_item",e=>{this._onSelectEvent(e)}),this._eventsList.on("add_item",()=>{this._onAddEvent()}),this._eventsList.on("edit_item",e=>{this._onEditEvent(e)}),this._eventsList.on("delete_item",e=>{this._onDeleteEvent(e)}),this._eventsList.on("delete_all_items",()=>{this._onDeleteAllEvents()}),this._eventsList.on("move",(e,t,s,i,a=[])=>{this._onMoveEvent(e,t,s,i,a)}),this._eventCondition.on("change_condition",e=>{this._onEventConditionChanged(e)}),this._bindingsList.on("selected_item",e=>{this._onSelectBinding(e)}),this._bindingType.addEventListener("input",()=>{this._onSelectBindingTypeChanged()}),this._setTimeoutOnPropertyChanged(()=>this._onBindingValueChanged(),this._bindingValue,"input",100),this._bindingAttribute.on("select_item",e=>{this._onSelectBindingAttribute(e)}),this._bindingAttribute.on("add_item",()=>{this._onAddNewBindingAttribute()}),this.bindingAttributesTypeAll.forEach(e=>{e.addEventListener("input",()=>{this._onSelectBindingAttributeType()})}),this._eventSelect.on("select_item",e=>{this._onUpdateEvent(["eventId","name"],e)}),this._busClassSelect.on("select_item",e=>{this._onUpdateEvent(["busClaId","busClaName"],e)})}_refreshAndEmitEvent(e){this._eventsList.refreshList(),this.emitChange(e)}_onSelectEvent(e){if(e&&this.eventSelected!==e){this._eventCondition.disabled=!1,this.eventSelected=e;var t=e.condition,s=e.busClaId;this.eventCondition=t,this._eventCondition.disabled=!1,this.bindingType="",this._bindingType.disabled=!0,this.bindingSelected=null,this.bindingValue="",this.bindingAttribute=void 0,this._visibilityBindingsElements(!1),this._bindingsList.unSelectAll(),this._fillBindingsParameters(s)}this._showEventMessageInfo(e)}_fillBindingsParameters(e){this._getBindings(e,this._options.bindingsUrl).then(e=>{this.bindingsList=e})}_onAddEvent(){var e=this.eventSelect,t=this.busClassSelect,s=this._eventsList.arrayList.data;if(e&&t){var i={id:this._getMaxId(s)+1,busClaId:parseInt(t.id,10),busClaName:t.name,eventId:parseInt(e.id,10),name:e.name,condition:"",haveCond:"No",bindings:[],order:s.length};s.push(i),this._refreshAndEmitEvent(s),this._eventsList._scrollToRow(i,()=>this._onSelectEvent(i))}}_onEditEvent(e){var t=e?this._eventsList.rowEditableSelected:this.eventSelected,s=t.busClaId,i=t.busClaName,a=t.eventId,n=t.name;this.eventSelect=e?{id:a,name:n}:void 0,this.busClassSelect=e?{id:s,name:i}:void 0,this.bindingType="",e?(this.eventCondition=t.condition?t.condition:"",this._eventCondition.disabled=!0,this._bindingsList.unSelectAll(),this._bindingsList.disabled=!0):(this._eventCondition.disabled=!1,this._bindingsList.disabled=!1,this._fillBindingsParameters(s)),this._bindingType.disabled=!0,this.bindingSelected&&(this.bindingSelected=null,this.bindingValue="",this.bindingAttribute=void 0),this._visibilityBindingsElements(!1)}_onUpdateEvent(e,t={id:"",name:""}){var s=Xs(e,2),i=s[0],a=s[1],n=this._eventsList.editStatus,r=t.id,o=t.name;if(" "!==t.id&&n){this.eventSelected[i]=parseInt(r,10),this.eventSelected[a]=o;var l=this._eventsList.arrayList.data;"busClaId"===i&&(this.eventSelected.bindings.length=0,this.eventSelected.condition="",this.eventCondition=this.eventSelected.condition,this.eventSelected.haveCond=""!==this.eventSelected.condition?"Yes":"No",this._refreshAndEmitEvent(l),this._fillBindingsParameters(this.eventSelected[i])),this._visibilityBindingsElements(!1),this._refreshAndEmitEvent(l)}}_onDeleteEvent(e){var t=this._eventsList.arrayList.data;if(e){var s=t.filter(t=>t.id!==e.id);this._eventsList.arrayList.data=s,this.eventSelected===e&&this._disableClearAssociatedWithEvent(),this._refreshAndEmitEvent(s)}}_onDeleteAllEvents(){this._eventsList.arrayList.data=[],this._refreshAndEmitEvent([]),this._disableClearAssociatedWithEvent()}_onMoveEvent(e,t,s,i){s.order=parseInt(e,10),i.order=parseInt(t,10);var a=this._eventsList.arrayList.data;this._refreshAndEmitEvent(a)}_onEventConditionChanged(e){if(this.eventSelected){this.eventSelected.condition=e,this.eventSelected.haveCond=""!==this.eventSelected.condition?"Yes":"No";var t=this._eventsList.arrayList.data;this._refreshAndEmitEvent(t)}}_onSelectBinding(e){if(e&&this.bindingSelected!==e){this.bindingSelected=e,this._bindingType.disabled=!1;var t=this._getBindingFromParameter(this.bindingSelected,this.eventSelected.bindings);if(t){var s="V"===t.busClaParBndType?"VALUE":"ATTRIBUTE";this.bindingType=s.toLowerCase(),this._showAccordingBindingType(s,t)}else this.bindingType="",this._visibilityBindingsElements(!1)}this._showBindingMessageInfo(e)}_onSelectBindingTypeChanged(){var e=this.bindingType.toUpperCase(),t=this._getBindingFromParameter(this.bindingSelected,this.eventSelected.bindings);if(t)this._cleanValuesAccordingNewType(e,t),""!==e?this._transformBindingFromValues(t,e):(this.eventSelected.bindings=this._deleteBindingParameter(t,this.eventSelected.bindings),this._fillBindingsParameters(this.eventSelected.busClaId));else{var s=this.bindingSelected,i=s.param,a=s.id;this.eventSelected.bindings=this._createNewBindingParameter({busClaParId:parseInt(a,10),busClaParName:i,busClaParType:this.bindingSelected.type},this.eventSelected.bindings,e)}this._showAccordingBindingType(e,t||{});var n=this._eventsList.arrayList.data;this._refreshAndEmitEvent(n)}_onBindingValueChanged(){var e=this._getBindingFromParameter(this.bindingSelected,this.eventSelected.bindings),t=Ys(this._bindingValue);if(this._fillValidBindingValue(e.busClaParBndValue),e&&t){e.busClaParBndValue=this.bindingValue;var s=this._eventsList.arrayList.data;this._fillBindingsParameters(this.eventSelected.busClaId),this._refreshAndEmitEvent(s)}}_fillValidBindingValue(e=""){"number"===this._bindingValue.type&&""===this.bindingValue&&(this.bindingValue=e)}_onSelectBindingAttribute(e){if(e){var t=this._getBindingFromParameter(this.bindingSelected,this.eventSelected.bindings);if(t){var s=e.id,i=e.name,a=e.label;t.attId=parseInt(s,10),t.attName=a||i,t.attTooltip=i;var n=this._eventsList.arrayList.data;this._fillBindingsParameters(this.eventSelected.busClaId),this._refreshAndEmitEvent(n)}}var r=!e&&""!==this._bindingAttribute.valueEl;this._bindingAttribute.toggleDisabledButton(!r)}_onSelectBindingAttributeType(){var e=this.bindingAttributeType,t=this._getBindingFromParameter(this.bindingSelected,this.eventSelected.bindings);if(t){t.busClaParBndType=e;var s=this._eventsList.arrayList.data;this._refreshAndEmitEvent(s)}}_deleteBindingParameter(e,t){return t.filter(t=>t.busClaParId!==e.busClaParId)}_createNewBindingParameter(e,t,s){var i=Qs({},e);return this._transformBindingFromValues(i,s),[...t,i]}_cleanValuesAccordingNewType(e,t){switch(e){case"ATTRIBUTE":delete t.busClaParBndValue;break;case"VALUE":delete t.attId,delete t.attName,delete t.attTooltip}}_transformBindingFromValues(e,t){switch(t){case"ATTRIBUTE":this._createBindingAttribute(e);break;case"VALUE":this._createBindingValue(e)}}_showAccordingBindingType(e,t={}){this._showBindingAttribute(t,"ATTRIBUTE"===e),this._showBindingValue(t,"VALUE"===e)}_createBindingAttribute(e){e.busClaParBndType="E",e.attId=-1,e.attName="",e.attTooltip=""}_createBindingValue(e){e.busClaParBndType="V",e.busClaParBndValue=""}_showEventMessageInfo(e){var t="<b>Event:</b> ".concat(e.name,"<br>\n      <b>Business Class:</b> ").concat(e.busClaName,"<br>\n      <b>Have a Condition:</b> ").concat(e.haveCond);this.message.showMessage(Qs(Qs({},Us),{},{message:t}))}_showBindingMessageInfo(e){var t=this.EVENT_MANAGER.PARAMS_TYPE,s="\n      <b>Parameter:</b> ".concat(e.param,"<br>\n      <b>Type:</b> ").concat(t[e.type],"<br>\n      <b>In/Out:</b> ").concat(e.inout,"<br>\n      <b>Binding:</b> ").concat(e.binding,"<br>\n    ");this.message.showMessage(Qs(Qs({},Us),{},{message:s}))}_showErrorMessage(e){var t=Qs({},Us);t.type="danger",t.title="Error",t.message=e,this.message.showMessage(t)}_showSuccessInsertionMessage(){var e=Qs({},Us);e.type="success",e.title="Success",e.message="Attribute successfully added",this.message.showMessage(e)}_visibilityBindingsElements(e){et(this.wrapBindingValue,e),et(this._bindingAttribute.wrapper,e),et(this.wrapBindingAttributeType,e)}_showBindingValue(e={},t=!0){this.setFieldValueEachType(t),this._bindingValue.disabled=!t,this.bindingValue=e.busClaParBndValue||"",et(this.wrapBindingValue,t)}_showBindingAttribute(e={},t=!0){var s=e.busClaParBndType,i=e.attId,a=e.attTooltip,n="P"===s?"process":"entity";this.bindingAttributeType=n,this.bindingAttribute=i&&a&&-1!==i&&""!==a?{id:i,name:a}:void 0,et(this.wrapBindingAttributeType,t),et(this._bindingAttribute.wrapper,t),this.setUrlAttributeEachType(t)}setUrlAttributeEachType(e){if(this.bindingSelected&&"Production"===A.ENV&&e){var t=this.bindingSelected.type;this._bindingAttribute.url="".concat(this._defaultAttrUrl,"&attType=").concat(t,"&name=")}}setFieldValueEachType(e){if(this.bindingSelected&&e){var t=this.bindingSelected.type;switch(t){case"N":this._bindingValue.setAttribute("type","number");break;case"D":this._bindingValue.setAttribute("type","date");break;default:this._bindingValue.setAttribute("type","text")}this._toggleNumberFieldAttributes("N"===t)}}_toggleNumberFieldAttributes(e){var t=this._bindingValue.hasAttribute("min"),s=this._bindingValue.hasAttribute("step");!e||t||s?(this._bindingValue.removeAttribute("min"),this._bindingValue.removeAttribute("step")):(this._bindingValue.setAttribute("min","0"),this._bindingValue.setAttribute("max",Number.MAX_SAFE_INTEGER),this._bindingValue.setAttribute("step","1"))}_disableClearAssociatedWithEvent(){this.eventSelected=null,this.eventCondition="",this._eventCondition.disabled=!0,this._bindingsList.arrayListData=[],this.bindingType="",this._bindingType.disabled=!0,this.bindingSelected&&(this.bindingSelected=null,this.bindingValue="",this.bindingAttribute=void 0),this._visibilityBindingsElements(!1)}_getBindings(e,t){var s=this;return Zs((function*(){var i=[];"Development"!==A.ENV&&(t="".concat(t).concat(e));try{var a=yield he.a.get(t);a&&a.data.toUpperCase().indexOf("HTML")>-1&&s.showInvalidSession(),i=(new as).convertToJson(a.data)}catch(e){}var n=tt(i);return s._customBindingsParameters(n)}))()}_customBindingsParameters(e){if(this.eventSelected){var t=st(this.eventSelected.bindings||[],"busClaParId");return e.map(e=>{var s=t[e.id];return Qs(Qs({},e),{},{binding:s?this._getEspecificationBinding(s):"None"})})}return e}_getEspecificationBinding(e){var t="V"===e.busClaParBndType&&""!==e.busClaParBndValue,s="P"===e.busClaParBndType,i="E"===e.busClaParBndType,a=(s||i)&&-1!==e.attId&&e.attId;return t?"Value":a?"Attribute":"None"}_getBindingFromParameter(e,t){return t.find(t=>parseInt(t.busClaParId,10)===parseInt(e.id,10))}_insertNewAttribute(e){var t=this;return Zs((function*(){var s="".concat(A.NEW_BINDINGS_ATTR_URL,"&name=").concat(e,"&attType=S"),i=yield he.a.post(s);if(i&&i.data.toUpperCase().indexOf("HTML")>-1&&t.showInvalidSession(),i){var a=Xs((new as).convertToJson(i.data),1)[0];t._bindingAttribute.selectedItem=a,t._bindingAttribute.reloadData(),t._bindingAttribute.toggleDisabledButton(!0)}}))()}_onAddNewBindingAttribute(){var e=this._bindingAttribute.valueEl;if(!this._bindingAttribute.selectedItem&&"Production"===A.ENV)if(Gs(e))try{this._insertNewAttribute(e).then(()=>this._showSuccessInsertionMessage())}catch(e){}else this._showErrorMessage('The attribute name <b>"'.concat(e,'"</b> is not valid'))}}function ti(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function si(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){ti(n,i,a,r,o,"next",e)}function o(e){ti(n,i,a,r,o,"throw",e)}r(void 0)}))}}function ii(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ai(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ii(Object(s),!0).forEach((function(t){ni(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ii(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ni(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function ri(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class oi extends Fs{constructor(e){super(e,"task"),this._init(),this._initComponents(),this._initEventListenersComponents()}_init(){this._taskNameInput=null,this._taskGroupInput=null,this._taskSearchParticipant=null,this._taskListParticipants=null,this._taskCondParticipant=null,this._taskSkipConditionInput=null,this._taskScheduleInput=null,this._taskScheduleSearch=null,this._taskRoleSearch=null,this._taskDocParticipant=this.panel.querySelector("#task_participant_documentation_input"),this._taskTitleInput=this._panel.querySelector("#task_title_input"),this._taskColorInput=this._panel.querySelector("#task_color_input"),this._taskColorInputName=this._panel.querySelector("#task_color_name_input"),this._taskTypeSelect=this._panel.querySelector("#task_type_select"),this._loopTypeSelect=this._panel.querySelector("#loop_type_select"),this._taskCommentsInput=this._panel.querySelector("#task_comments_input"),this._taskScheduleTypeSelect=this._panel.querySelector("#schedule_type_select"),this._taskStatesInput=null,this._taskSearchEventStates=null,this._taskSearchStates=null,this._taskListEventStates=null,this._taskConditionStates=null,this._taskDocStates=this._panel.querySelector("#task_states_documentation_input"),this._taskEventsInput=null,this._taskFormsInput=null,this._taskListStepForms=null,this._stepForms=[],this._taskTypeForms=this._panel.querySelector("#task_forms_type"),this._taskSearchForms=null,this._taskListForms=null,this._taskConditionForms=null,this._taskDocumentationForms=this._panel.querySelector("#task_forms_documentation_input"),this._stepSelected=void 0,this._taskMultiInstanceLoopType=null,this._taskInputOutputGroup=this._panel.querySelector("#task_group_input_output"),this._taskWsMethodName=this._panel.querySelector("#task_ws_method_name_input"),this._taskWsAttributeType=this._panel.querySelector("#task_attr_type_ws"),this._taskOutputWSBindingType=this._panel.querySelector("#task_binding_type_ws"),this._taskOutputWSBindingValue=this._panel.querySelector("#task_binding_value_ws"),this._wrapTaskGroup=null,this._groupExpandZone=null,this._scheduleExpandZone=this._panel.querySelector("#expand_schedule_zone"),this._statesExpandZone=this._panel.querySelector("#expand_states_zone"),this._eventsExpandZone=this.panel.querySelector("#expand_events_zone"),this._formsExpandZone=this._panel.querySelector("#expand_forms_zone"),this._wrapTaskAttributesTypeEvents=this._panel.querySelector("#wrapper_task_events_binding_attr_type"),this._wrapTaskBindingsTypeEvents=this._panel.querySelector("#wrapper_task_events_binding_type"),this._wrapTaskSearchAttributesEvents=null,this._wrapTaskBindingsValueEvents=this._panel.querySelector("#wrapper_task_events_binding_value"),this._wrapMultiInstanceLoopType=null,this._wrapOutputBindingAttrType=this._panel.querySelector("#wrapper_task_output_msg_ref_binding_attr_type"),this._taskTypeSelect.addEventListener("input",()=>{this._onTaskTypeSelectChanged()}),this._taskColorInput.addEventListener("change",()=>{this._onTaskColorChanged()}),this._loopTypeSelect.addEventListener("input",()=>{this._onLoopTypeSelectChanged()}),this._taskCommentsInput.addEventListener("input",()=>{this._onTaskCommentsChanged()}),this._taskScheduleTypeSelect.addEventListener("input",()=>{this._onSelectScheduleTypeChanged()}),this.TASK_PANEL={ROLE_SEARCH:{nameId:"task_role",label:M.a.t("taskPropsPanel.txtProDesTaskPanelRoleSearch"),add:!0,url:A.ROLES_URL,hasLabel:!1,canReload:!0},TASK_NAME:{nameId:"task_name",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskName"),add:!0,url:A.TASK_URL,hasLabel:!0,canReload:!0},TASK_CONDITION:{nameId:"task_skip_cond",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskCondition")},GROUP:{nameId:"task_group",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskGroupLabel"),expandId:"expand_group_zone"},GROUP_SEARCH:{nameId:"task_participants",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskGroupSearchLabel"),add:!0,url:A.PARTICIPANTS_URL,hasLabel:!1,canReload:!0},GROUP_LIST:{nameId:"task_participants",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskGroupConditionLabel"),add:!0},GROUP_CONDITION:{nameId:"task_participants_cond",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskGroupScheduleLabel")},SCHEDULE:{nameId:"task_schedule",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskGroupScheduleLabel"),expandId:"expand_schedule_zone"},SCHEDULE_SEARCH:{nameId:"task_schedule",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskGroupScheduleSearchLabel"),add:!1,url:A.TASK_SCHEDULE,hasLabel:!1,canReload:!0},SCHEDULE_SUBPROCESS:{nameId:"task_schedule_subprocess",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskGroupScheduleSubprocessLabel"),add:!1,url:A.SUBPROCESS_URL,hasLabel:!1,canReload:!0},SCHEDULE_TASK:{nameId:"task_schedule_tasks",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskGroupScheduleTaskLabel"),add:!1,url:A.SUBPROCESS_TASKS_URL,hasLabel:!1,canReload:!0},STATES:{nameId:"task_states",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskStatesLabel"),expandId:"expand_states_zone"},STATES_EVENT:{nameId:"task_events_states",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskStatesEventLabel"),add:!1,url:A.STATES_EVENTS_URL,hasLabel:!1},STATES_STATUS:{nameId:"task_status_states",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskStatesStatusLabel"),add:!1,url:A.STATES_STATUS_URL,hasLabel:!1,canReload:!0},STATES_LIST:{nameId:"task_events_list_states",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskStatesListLabel"),add:!0},STATES_CONDITION:{nameId:"task_condition_states",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskStatesConditionLabel")},EVENTS:{nameId:"task_events",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskEventsLabel"),expandId:"expand_events_zone"},EVENTS_SEARCH:{nameId:"task_event_select_events",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskEventsSearchLabel"),add:!1,url:A.STATES_EVENTS_URL,hasLabel:!1},EVENTS_BUSCLAS:{nameId:"task_bus_class_events",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskEventsBusClasLabel"),add:!1,url:A.TASK_BUSCLAS_EVENTS_URL,hasLabel:!1,canReload:!0},EVENTS_LIST:{nameId:"task_events_list",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskEventsListLabel"),add:!0},EVENTS_CONDITION:{nameId:"task_events_cond",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskEventsConditionLabel")},EVENTS_BINDINGS:{nameId:"task_events_bindings",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskEventsBindingLabel"),add:!1},EVENTS_ATTR:{nameId:"task_attribute_events",label:M.a.t("taskPropsPanel.txtProDesTaskPanelTaskEventsAttributeLabel"),add:!0,url:A.TASK_BINDINGS_ATTR_URL,hasLabel:!0,canReload:!0},FORMS:{nameId:"task_forms",label:M.a.t("taskPropsPanel.txtProDesTaskPanelFormsLabel"),expandId:"expand_forms_zone"},FORMS_STEPS:{nameId:"task_step_forms_list",label:M.a.t("taskPropsPanel.txtProDesTaskPanelFormsStepsLabel"),add:!0},FORMS_SEARCH:{nameId:"task_find_forms",label:M.a.t("taskPropsPanel.txtProDesTaskPanelFormsSearchLabel"),add:!0,url:A.TASK_ENT_FORMS_URL,hasLabel:!1,canReload:!0},FORMS_LIST:{nameId:"task_forms_list",label:M.a.t("taskPropsPanel.txtProDesTaskPanelFormsListLabel"),add:!0},FORMS_CONDITION:{nameId:"task_forms_cond",label:M.a.t("taskPropsPanel.txtProDesTaskPanelFormsConditionLabel")},MULTIINSTANCE_LOOPTYPE:{nameId:"task_multiinstance_looptype",label:M.a.t("taskPropsPanel.txtProDesTaskPanelMultiInstanceLoopLabel"),add:!0,url:A.TASK_MULTIINSTANCE_URL,hasLabel:!0,canReload:!0},INPUT_MSG_REF:{nameId:"task_input_msg_ref",label:M.a.t("configCmp.txtConfigCmpTaskPanelMSGRefLabel"),expandId:"expand_input_message_ref_zone"},INPUT_MSG_REF_ATTR_SEARCH:{nameId:"task_input_msg_ref_attr_input",label:M.a.t("taskPropsPanel.txtProDesTaskPanelMSGRefAttributeLabel"),add:!0,url:A.TASK_INPUT_MSG_REF,hasLabel:!0,canReload:!0},INPUT_MSG_REF_ATTRS_LIST:{nameId:"task_input_msg_ref_attrs_list",label:M.a.t("taskPropsPanel.txtProDesTaskPanelMSGRefAttributeListLabel"),add:!0},OUTPUT_MSG_REF_WS_SEARCH:{nameId:"task_output_msg_ref_ws_input",label:M.a.t("taskPropsPanel.txtProDesTaskPanelMSGRefWSSearchLabel"),add:!1,url:A.TASK_OUTPUT_WS_URL,hasLabel:!1,canReload:!0},OUTPUT_MSG_REF_WS_LIST:{nameId:"task_output_msg_ref_ws_list",label:M.a.t("taskPropsPanel.txtProDesTaskPanelMSGRefWSSearchAddLabel"),add:!0},OUTPUT_MSG_REF_BINDING_LIST:{nameId:"task_output_msg_ref_binding_list",label:M.a.t("taskPropsPanel.txtProDesTaskPanelMSGRefWSBindingListLabel"),add:!1},OUTPUT_MSG_REF:{nameId:"task_output_msg_ref",label:M.a.t("taskPropsPanel.txtProDesTaskPanelMSGRefOutputMessageLabel"),expandId:"expand_output_message_ref_zone"},OUTPUT_MSG_REF_ATTR_SEARCH:{nameId:"task_output_msg_ref_attr_param",label:M.a.t("taskPropsPanel.txtProDesTaskPanelMSGRefAttributeSearchLabel"),add:!1,url:A.WORKFLOW_ATTRS_URL,hasLabel:!0,canReload:!0}},this.OPTIONS_TOAST={type:"info",title:M.a.t("taskPropsPanel.txtProDesTaskPanelToastTitle"),duration:3e3,position:"bottom-left"},this.PARAMETER_TYPE={S:M.a.t("configCmp.txtConfigCmpParameterTypeString"),N:M.a.t("configCmp.txtConfigCmpParameterTypeNumber"),D:M.a.t("configCmp.txtConfigCmpParameterTypeDate")}}get taskNameInput(){return this._taskNameInput.valueEl}get taskTitleInput(){return this._taskTitleInput.value}get taskColorInput(){return this._taskColorInput.value}get taskTypeSelect(){return this._taskTypeSelect.value}get loopTypeSelect(){return this._loopTypeSelect.value}get taskComments(){return this._taskCommentsInput.checked}get taskSkipCondition(){return this._taskSkipConditionInput.conditionArea}get taskScheduleSearch(){return this._taskScheduleSearch.valueEl}set taskScheduleSearch(e){this._taskScheduleSearch.valueEl=e}get taskScheduleTypeSelect(){return this._taskScheduleTypeSelect.value}set taskScheduleTypeSelect(e){this._taskScheduleTypeSelect.value=e}get taskScheduleSubprocSearch(){return this._taskScheduleSubprocSearch.valueEl}set taskScheduleSubprocSearch(e){this._taskScheduleSubprocSearch.valueEl=e}get taskScheduleTaskSearch(){return this._taskScheduleTaskSearch.valueEl}set taskScheduleTaskSearch(e){this._taskScheduleTaskSearch.valueEl=e}get taskMultiInstanceType(){return this._taskMultiInstanceType.checked?"value":"attribute"}set taskMultiInstanceType(e){this._taskMultiInstanceType.checked=e}get taskMultiplicationNumber(){var e=this._taskMultiplicationNumber.value;return""!==e?parseInt(e,10):e}set taskMultiplicationNumber(e){this._taskMultiplicationNumber.value=e}_getTasksBySubrocessId(){var e=this.element.schedule.subprocess,t="".concat(A.TASK_URL,"&proc_id=").concat(e);this._taskScheduleTaskSearch.showData(t)}get taskSearchParticipant(){return this._taskSearchParticipant.valueEl}set taskSearchParticipant(e){this._taskSearchParticipant.valueEl=e}set taskNameInput(e){this._taskNameInput.valueEl=e}set taskColorInput(e){this._taskColorInput.value=e}set taskColorInputName(e){this._taskColorInputName.value=e}set taskTitleInput(e){this._taskTitleInput.value=e}set taskTypeSelect(e){this._taskTypeSelect.value=e}set loopTypeSelect(e){this._loopTypeSelect.value=e}set taskComments(e){this._taskCommentsInput.checked=e}set taskSkipCondition(e){this._taskSkipConditionInput.conditionArea=e}get taskCondParticipant(){return this._taskCondParticipant.conditionArea}set taskCondParticipant(e){this._taskCondParticipant.conditionArea=e}get taskParticipantDocumentation(){return this._taskDocParticipant.value}set taskParticipantDocumentation(e){this._taskDocParticipant.value=e}set taskRoleSearch(e){this._taskRoleSearch.valueEl=e}get taskRoleSearch(){return this._taskRoleSearch.valueEl}get taskSearchEventStates(){return this._taskSearchEventStates.valueEl}set taskSearchEventStates(e){this._taskSearchEventStates.selectedItem=e}get taskSearchStates(){return this._taskSearchStates.valueEl}set taskSearchStates(e){this._taskSearchStates.selectedItem=e}get taskConditionStates(){return this._taskConditionStates.conditionArea}set taskConditionStates(e){this._taskConditionStates.conditionArea=e}get taskDocStates(){return this._taskDocStates.value}set taskDocStates(e){this._taskDocStates.value=e}get taskSearchEvents(){return this._taskSearchEvents.valueEl}set taskSearchEvents(e){this._taskSearchEvents.valueEl=e}get taskBusClasEvents(){return this._taskBusClasEvents.valueEl}set taskBusClasEvents(e){this._taskBusClasEvents.valueEl=e}get taskConditionEvents(){return this._taskConditionEvents.conditionArea}set taskConditionEvents(e){this._taskConditionEvents.conditionArea=e}get taskBindingsValueEvents(){return this._taskBindingsValueEvents.value}set taskBindingsValueEvents(e){this._taskBindingsValueEvents.value=e}get taskSearchAttributesEvents(){return this._taskSearchAttributesEvents.valueEl}set taskSearchAttributesEvents(e){this._taskSearchAttributesEvents.valueEl=e}get taskBindingsTypeEvents(){return this._taskBindingsTypeEvents.value}set taskBindingsTypeEvents(e){this._taskBindingsTypeEvents.value=e}get taskAttributesTypeEvents(){return this._wrapTaskAttributesTypeEvents.querySelector("input[type=radio]:checked").value}get radiosTypeEvents(){return this._wrapTaskAttributesTypeEvents.querySelectorAll("input[type=radio]")}get taskTypeForms(){return this._taskTypeForms.value}set taskTypeForms(e){this._taskTypeForms.value=e}get taskDocumentationForms(){return this._taskDocumentationForms.value}set taskDocumentationForms(e){this._taskDocumentationForms.value=e}get taskConditionForms(){return this._taskConditionForms.conditionArea}set taskConditionForms(e){this._taskConditionForms.conditionArea=e}get taskSearchForms(){return this._taskSearchForms.valueEl}set taskSearchForms(e){this._taskSearchForms.valueEl=e}set taskFormsInput(e){this._taskFormsInput.inputEl=e}get taskMultiInstanceLoopType(){return this._taskMultiInstanceLoopType.valueEl}set taskMultiInstanceLoopType(e){this._taskMultiInstanceLoopType.valueEl=e}get taskWsMethodName(){return this._taskWsMethodName.value}get taskWsAttributeType(){return this._taskWsAttributeType.value.toUpperCase()}get taskInputMsgRefSearch(){return this._taskInputMsgRefSearch.valueEl}set taskWsMethodName(e){this._taskWsMethodName.value=e}set taskWsAttributeType(e){this._taskWsAttributeType.value=e}set taskInputMsgRefSearch(e){this._taskInputMsgRefSearch.valueEl=e}get taskInputOutputGroup(){return this._taskInputOutputGroup.checked}set taskInputOutputGroup(e){this._taskInputOutputGroup.checked=e,this._changeVisibility(this._taskInputMsgRefExp.wrapper,e),this._changeVisibility(this._taskOutputMsgRefExp.wrapper,e)}get taskOutputWSBindingType(){return this._taskOutputWSBindingType.value}set taskOutputWSBindingType(e){this._taskOutputWSBindingType.value=e}get taskOutputWSBindingValue(){return this._taskOutputWSBindingValue.value}set taskOutputWSBindingValue(e){this._taskOutputWSBindingValue.value=e}set taskOutputWebServiceSearch(e){this._taskOutputWebServiceSearch.valueEl=e}get wsSelected(){return this._wsSelected}set wsSelected(e){this._wsSelected=e}set taskOutputBindingAttrSearch(e){this._taskOutputBindingAttrSearch.valueEl=e}get ouputWsAttributeTypeChecked(){return this._wrapOutputBindingAttrType.querySelector("input[type=radio]:checked")}_initGroupsComponents(){var e=this.TASK_PANEL,t=e.GROUP,s=e.GROUP_SEARCH,i=e.GROUP_LIST,a=e.GROUP_CONDITION;i.arrayList=this._createParticipantsArrayList(),"Production"!==A.ENV&&(s.add=!1),this._taskGroupInput=this._includeComponent("expander",this.wrapTaskName,this.wrapTaskTitle,"afterend",t),this._taskSearchParticipant=this._includeComponent("dropdown",this.wrapTaskSearchParticipants,this._taskGroupInput.expandZone,"inner",s),this._taskListParticipants=this._includeComponent("list",this.wrapListParticipants,this._taskGroupInput.expandZone,"inner",i),this._taskCondParticipant=this._includeComponent("condition",this.wrapConditionParticipant,this._taskGroupInput.expandZone,"inner",a),this._taskSearchParticipant.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelSearchParticipationPlaceholder"),this._taskCondParticipant.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelConditionParticipationPlaceholder"),this._taskDocParticipant.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelDocumentationParticipationPlaceholder"),this._taskCondParticipant.wrapper.insertAdjacentElement("afterend",this.wrapDocParticipants),this._taskGroupInput.expandZone.insertAdjacentElement("afterend",this.wrapTaskType)}_initGenericTaskComponents(){var e=this.TASK_PANEL,t=e.ROLE_SEARCH,s=e.TASK_NAME,i=e.TASK_CONDITION;"Development"===A.ENV&&(s.add=!1),this._taskRoleSearch=this._includeComponent("dropdown",this.wrapRoleTask,this.wrapTaskLoopType,"afterend",t),this._taskNameInput=this._includeComponent("dropdown",this.wrapTaskName,this.wrapTaskTitle,"beforebegin",s),this._taskSkipConditionInput=this._includeComponent("condition",this.wrapSkipCondition,this.wrapTaskComments,"afterend",i),this._taskNameInput.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelTaskNamePlaceholder"),this._taskRoleSearch.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelRolePlaceholder"),this._taskSkipConditionInput.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelConditionToTaskPlaceholder"),this._taskNameInput.toggleDisabledButton(!0),this._taskRoleSearch.toggleDisabledButton(!0),this.wrapTaskDoc.insertAdjacentElement("beforebegin",this.wrapTaskColor)}_initInputOutputMessageRefComponents(){var e=this.TASK_PANEL,t=e.INPUT_MSG_REF,s=e.INPUT_MSG_REF_ATTR_SEARCH,i=e.INPUT_MSG_REF_ATTRS_LIST,a=this.TASK_PANEL,n=a.OUTPUT_MSG_REF,r=a.OUTPUT_MSG_REF_WS_SEARCH,o=a.OUTPUT_MSG_REF_WS_LIST,l=a.OUTPUT_MSG_REF_BINDING_LIST,h=a.OUTPUT_MSG_REF_ATTR_SEARCH;i.arrayList=this._createInputMsgRefAttrsArrayList(),o.arrayList=this._createOutputMsgRefWsArrayList(),l.arrayList=this._createWebServiceBindingsArrayList(),this._taskInputMsgRefExp=this._includeComponent("expander",this.wrapInputMsgRefExp,this.wrapInputOutputGroup,"afterend",t),this._taskInputMsgRefSearch=this._includeComponent("dropdown",this.wrapInputMsgRefSearch,this._taskInputMsgRefExp.expandZone,"inner",s),this._taskInputMsgRefList=this._includeComponent("list",this.wrapInputMsgRefList,this._taskInputMsgRefExp.expandZone,"inner",i),this._taskOutputMsgRefExp=this._includeComponent("expander",this.wrapOutputMsgRefExp,this._taskInputMsgRefExp.expandZone,"afterend",n),this._taskOutputWebServiceSearch=this._includeComponent("dropdown",this.wrapWebServiceSearch,this.wrapOutputWSBindingType,"beforebegin",r),this._taskOutputMsgRefWSList=this._includeComponent("list",this.wrapOutputMsgRefWSList,this._taskOutputWebServiceSearch.wrapper,"afterend",o),this._taskOutputMsgRefBindingList=this._includeComponent("list",this.wrapOutputMsgRefBinList,this._taskOutputMsgRefWSList.wrapper,"afterend",l),this._taskOutputBindingAttrSearch=this._includeComponent("dropdown",this.wrapOutputBindAttr,this._wrapOutputBindingAttrType,"afterend",h),this._wsSelected=null,this._taskInputMsgRefSearch.toggleDisabledButton(!0),this._taskWsMethodName.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelWSNamePlaceholder"),this._taskInputMsgRefSearch.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelWSSelectPlaceholder"),this._changeVisibility(this._taskInputMsgRefExp.wrapper,!1),this._changeVisibility(this._taskOutputMsgRefExp.wrapper,!1)}_initScheduleComponents(){var e=this.TASK_PANEL,t=e.SCHEDULE,s=e.SCHEDULE_SEARCH,i=e.SCHEDULE_SUBPROCESS,a=e.SCHEDULE_TASK;this._taskScheduleInput=this._includeComponent("expander",this.wrapExpanderSchedule,this.wrapHighLight,"afterend",t),this._taskScheduleSearch=this._includeComponent("dropdown",this.wrapScheduleSearch,this.wrapScheduleType,"beforebegin",s),this._taskScheduleSubprocSearch=this._includeComponent("dropdown",this.wrapScheduleSubprocess,this.wrapScheduleType,"afterend",i),this._taskScheduleTaskSearch=this._includeComponent("dropdown",this.wrapScheduleTask,this._taskScheduleSubprocSearch.wrapper,"afterend",a),this._taskScheduleSearch.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelSearchAgendaPlaceholder"),this._taskScheduleSubprocSearch.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelSearchSubProcessPlaceholder"),this._taskScheduleTaskSearch.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelSearchTaskPlaceholder"),this._taskScheduleTaskSearch.local=!0}_initStatesComponents(){var e=this.TASK_PANEL,t=e.STATES,s=e.STATES_EVENT,i=e.STATES_STATUS,a=e.STATES_LIST,n=e.STATES_CONDITION;a.arrayList=this._createEventsStatesArrayList(),this._taskStatesInput=this._includeComponent("expander",this.wrapExpanderStates,this._taskEventsInput.expandZone,"afterend",t),this._taskSearchEventStates=this._includeComponent("dropdown",this.wrapEventStates,this._taskStatesInput.expandZone,"inner",s),this._taskSearchStates=this._includeComponent("dropdown",this.wrapStatesSearch,this._taskStatesInput.expandZone,"inner",i),this._taskListEventStates=this._includeComponent("list",this.wrapListEventsStates,this._taskStatesInput.expandZone,"inner",a),this._taskConditionStates=this._includeComponent("condition",this.wrapConditionStates,this._taskStatesInput.expandZone,"inner",n),this._taskSearchEventStates.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelSearchEventPlaceholder"),this._taskSearchStates.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelSearchStatusPlaceholder"),this._taskConditionStates.placeholder=M.a.t("taskPropsPanel.txtProDesTaskPanelConditionToEventPlaceholder"),this._taskConditionStates.wrapper.insertAdjacentElement("afterend",this.wrapDocStates)}_initEventsComponents(){var e=this.TASK_PANEL.EVENTS;this._taskEventsInput=this._includeComponent("expander",this.wrapExpanderEvents,this._taskFormsInput.expandZone,"afterend",e),this._taskEvents=new ei("task",this._taskEventsInput.expandZone,{eventsUrl:A.TASK_EVENTS_URL,busClassUrl:A.TASK_BUSCLAS_EVENTS_URL,attributesUrl:A.TASK_BINDINGS_ATTR_URL,bindingsUrl:A.TASK_BINDINGS_URL})}_initFormsComponents(){var e=this.TASK_PANEL,t=e.FORMS,s=e.FORMS_STEPS,i=e.FORMS_SEARCH,a=e.FORMS_LIST,n=e.FORMS_CONDITION;s.arrayList=this._createStepFormsArrayList(),a.arrayList=this._createFormsArrayList(),this._taskFormsInput=this._includeComponent("expander",this.wrapExpanderForms,this._taskRoleSearch.wrapper,"afterend",t),this._taskListStepForms=this._includeComponent("list",this.wrapListStepForms,this.wrapTypeForms,"beforebegin",s),this._taskSearchForms=this._includeComponent("dropdown",this.wrapTaskSearchForms,this.wrapTypeForms,"afterend",i),this._taskListForms=this._includeComponent("list",this.wrapListForms,this._taskSearchForms.wrapper,"afterend",a),this._taskConditionForms=this._includeComponent("condition",this.wrapFormsCondition,this._taskListForms.wrapper,"afterend",n),this._taskSearchForms.toggleDisabledButton(!0),this._taskSearchForms.placeholder="Search a Form",this._taskConditionForms.placeholder="Insert any condition to form",this._taskDocumentationForms.placeholder="Insert a documentation to form"}_initMultiInstanceLoopTypeComponents(){var e=this.TASK_PANEL.MULTIINSTANCE_LOOPTYPE;this.wrapTaskType.insertAdjacentElement("afterend",this.wrapTaskLoopType),this._wrapMultiInstanceType=this._panel.querySelector("#wrap_task_multiinstance_type_select"),this.wrapTaskLoopType.insertAdjacentElement("afterend",this._wrapMultiInstanceType),this._taskMultiInstanceLoopType=this._includeComponent("dropdown",this._wrapMultiInstanceLoopType,this._wrapMultiInstanceType,"afterend",e),this._taskMultiInstanceType=this._panel.querySelector("#task_multiinstance_type_select"),this._taskMultiplicationNumber=this._panel.querySelector("#task_multiinstance_number_type"),this._taskMultiInstanceLoopType.placeholder="Search an Attribute",this._taskMultiInstanceLoopType.toggleDisabledButton(!0),this._wrapMultiInstanceLoopType=this._taskMultiInstanceLoopType.wrapper,this._wrapMultiplicationNumber=this._taskMultiplicationNumber.parentNode.parentNode,this._wrapMultiInstanceType.insertAdjacentElement("afterend",this._wrapMultiplicationNumber)}_initComponents(){this.wrapTaskTitle=this._taskTitleInput.parentNode.parentNode,this.wrapTaskColor=this._taskColorInput.parentNode.parentNode,this.wrapTaskDoc=this._documentationInput.parentNode.parentNode,this.wrapTaskLoopType=this._loopTypeSelect.parentNode.parentNode,this.wrapDocParticipants=this._taskDocParticipant.parentNode.parentNode,this.wrapScheduleType=this._taskScheduleTypeSelect.parentNode.parentNode,this.wrapDocStates=this._taskDocStates.parentNode.parentNode,this.wrapTypeForms=this._taskTypeForms.parentNode.parentNode,this.wrapTaskType=this._taskTypeSelect.parentNode.parentNode,this.wrapOutputWSBindingType=this._taskOutputWSBindingType.parentNode.parentNode,this.wrapOutputWSBindingValue=this._taskOutputWSBindingValue.parentNode,this.wrapHighLight=this._taskCommentsInput.parentNode.parentNode,this.wrapInputOutputGroup=this._taskInputOutputGroup.parentNode.parentNode.parentNode,this.wrapTaskComments=this._taskCommentsInput.parentNode.parentNode.parentNode,this._initGenericTaskComponents(),this._initGroupsComponents(),this._initMultiInstanceLoopTypeComponents(),this._initFormsComponents(),this._initEventsComponents(),this._initStatesComponents(),this._initScheduleComponents(),this._initInputOutputMessageRefComponents()}_initEventListenersComponents(){this._taskNameInput.on("select_item",e=>{this._onSelectNameChange(e)}),this._taskNameInput.on("add_item",()=>{this._onAddNewTaskNameInput()}),this._taskNameInput.on("clear_item",()=>{this._onClearNameInput()}),this._taskSearchParticipant.on("add_item",()=>{this._onAddNewParticipant()}),this._taskSearchParticipant.on("select_item",e=>{this._onSelectSearchParticipant(e)}),this._taskListParticipants.on("add_item",()=>{this._onAddParticipantSelect()}),this._taskListParticipants.on("selected_item",e=>{this._onSelectParticipantItem(e)}),this._taskListParticipants.on("delete_item",e=>{this._onDeleteParticipantItem(e)}),this._taskListParticipants.on("delete_all_items",()=>{this._onDeleteAllParticipantItems()}),this._taskCondParticipant.on("change_condition",e=>{this._onParticipantConditionChanged(e)}),this._taskConditionStates.on("change_condition",e=>{this._onStateConditionChanged(e)}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onParticipantDocumentationChanged()},this._taskDocParticipant,"input"),this._taskScheduleSearch.on("select_item",e=>{this._onSelectScheduleAgendaChanged(e)}),this._taskScheduleSubprocSearch.on("select_item",e=>{this._onSelectScheduleSubprocessChanged(e)}),this._taskScheduleTaskSearch.on("select_item",e=>{this._onSelectScheduleTaskChanged(e)}),this._taskScheduleSearch.on("clear_item",()=>{this._onClearSchedulePropertyChanged(["id","scheduleName"])}),this._taskScheduleSubprocSearch.on("clear_item",()=>{this._onClearSchedulePropertyChanged(["subprocess","subprocessName"])}),this._taskScheduleTaskSearch.on("clear_item",()=>{this._onClearSchedulePropertyChanged(["task","taskName"])}),this._taskScheduleInput.on("expand",()=>{this._onExpandScheduleInput()}),this._taskRoleSearch.on("select_item",e=>{this._onSelectRoleTaskChanged(e)}),this._taskRoleSearch.on("clear_item",()=>{this._onClearRoleTasks()}),this._taskRoleSearch.on("add_item",()=>{this._onAddNewRoleSearch()}),this._taskListEventStates.on("add_item",()=>{this._onAddStateList()}),this._taskListEventStates.on("selected_item",e=>{this._onSelectedEventState(e)}),this._taskListEventStates.on("delete_item",e=>{this._onDeleteEvenStatestList(e)}),this._taskListEventStates.on("delete_all_items",()=>{this._onDeleteAllEventStatesList()}),this._taskListEventStates.on("edit_item",e=>{this._onEditEventState(e)}),this._taskSearchEventStates.on("select_item",e=>{this._onSelectEventOrStates(e,"event")}),this._taskSearchStates.on("select_item",e=>{this._onSelectEventOrStates(e,"state")}),this._taskConditionStates.on("change_condition",e=>{this._onConditionAndDocumentationStatesChanged(e,"condition")}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onConditionAndDocumentationStatesChanged(this.taskDocStates,"conditionDoc")},this._taskDocStates,"input"),this._taskEvents.on("change",e=>this._onTaskEventsChanged(e)),this._taskEvents.on("move",(e,t,s,i,a=[])=>{this._onOrderTaskEventsChanged(e,t,s,i,a)}),this._taskFormsInput.on("expand",()=>{this._onExpandForms()}),this._taskListStepForms.on("add_item",()=>{this._onAddTaskStepListForms()}),this._taskListStepForms.on("selected_item",e=>{this._onTaskStepListFormsSelect(e)}),this._taskListStepForms.on("delete_item",e=>{this._onDeleteTaskStepListForms(e)}),this._taskSearchForms.on("select_item",e=>{this._onSelectTaskSearchForms(e)}),this._taskSearchForms.on("add_item",()=>{this._onAddNewTaskForm()}),this._taskListStepForms.on("delete_all_items",()=>{this._onDeleteAllTaskStepListForms()}),this._taskListForms.on("selected_item",e=>{this._onTaskFormListSelect(e)}),this._taskListForms.on("delete_item",e=>{this._onDeleteTaskFormList(e,!1)}),this._taskListForms.on("delete_all_items",()=>{this._onDeleteTaskFormList(!0,!0)}),this._taskListForms.on("add_item",()=>{this._onAddTaskListForms()}),this._taskListForms.on("checked_item",e=>{this._onCheckTaskListForm(e)}),this._taskTypeForms.addEventListener("input",()=>{this._onTaskTypeFormsSelectChanged()}),this._taskConditionForms.on("change_condition",e=>{this._onTaskConditionAndDocFormsChanged("condition",e)}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onTaskConditionAndDocFormsChanged("conditionDoc",this.taskDocumentationForms)},this._taskDocumentationForms,"input"),this._taskListStepForms.on("move",(e,t,s,i,a=[])=>{this._onOrderStepFormsChanged(e,t,s,i,a)}),this._taskListForms.on("move",(e,t,s,i,a=[])=>{this._onOrderFormsChanged(e,t,s,i),this.element.setPropertyObject(this._stepSelected,"forms","".concat(s.formType,"Forms"),a)}),this._taskSkipConditionInput.on("change_condition",e=>{this._onTaskSkipConditionChanged(e)}),this._taskMultiInstanceLoopType.on("select_item",e=>{this._onTaskMultiInstanceChanged(e)}),this._taskMultiInstanceLoopType.on("add_item",()=>{this._onAddMultiInstanceAttribute()}),this._taskInputOutputGroup.addEventListener("input",()=>{this._onInputOutputGroupChanged()}),this._taskInputMsgRefExp.on("expand",()=>{this._onExpandInputMessageRefExp()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onTaskWsMethodNameChanged()},this._taskWsMethodName,"input"),this._taskWsAttributeType.addEventListener("input",()=>{this._onSelectTaskWsAttributeType()}),this._taskInputMsgRefList.on("edit_item",e=>{this._onEditTaskInputMsgRefList(e)}),this._taskInputMsgRefList.on("add_item",()=>{this._onAddTaskInputMsgRefList()}),this._taskInputMsgRefList.on("delete_item",e=>{this._onDeleteTaskInputMsgRefList(e)}),this._taskInputMsgRefList.on("delete_all_items",()=>{this._onDeleteAllTaskInputMsgRefList()}),this._taskInputMsgRefList.on("selected_item",e=>{this._onSelectInputMsgRefList(e)}),this._taskInputMsgRefList.on("checked_item",e=>{this._onCheckInputMsgRefList(e)}),this._taskInputMsgRefSearch.on("select_item",e=>{this._onTaskInputMsgRefSearchChanged(e)}),this._taskInputMsgRefSearch.on("add_item",()=>{this._onAddNewInputMsgAttribute()}),this._taskOutputMsgRefExp.on("expand",()=>{this._onExpandOutputMsgRefExp()}),this._taskOutputMsgRefWSList.on("add_item",()=>{this._onAddWebServiceIntoList()}),this._taskOutputMsgRefWSList.on("edit_item",e=>{this._onEditWebServiceIntoList(e)}),this._taskOutputMsgRefWSList.on("selected_item",e=>{this._onSelectWebServiceIntoList(e)}),this._taskOutputWebServiceSearch.on("select_item",e=>{this._onSelectOutputWebServiceSearch(e)}),this._taskOutputMsgRefBindingList.on("selected_item",e=>{this._onSelectOutputWsBindingsList(e)}),this._taskOutputMsgRefWSList.on("delete_item",e=>{this._onDeleteWebServiceOutputMsgRefList(e)}),this._taskOutputMsgRefWSList.on("delete_all_items",()=>{this._onDeleteAllWebServiceOutputMsgRefList()}),this._taskOutputWSBindingType.addEventListener("input",()=>{this._onTaskWsAttributeTypeChanged()}),this._wrapOutputBindingAttrType.querySelectorAll("input[type=radio]").forEach(e=>{e.addEventListener("input",()=>{this._onWebServiceBindingAttrTypeChanged()})}),this._taskOutputBindingAttrSearch.on("select_item",e=>{this._onWebServiceBindingAttributeChanged(e)}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onWebServiceBindingValueChanged()},this._taskOutputWSBindingValue,"input",100),this._taskMultiInstanceType.addEventListener("input",()=>{this._onTaskMultiInstanceTypeChanged()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onValidateMultiplicationNumber(),this._onTaskMultiplicationNumberChanged()},this._taskMultiplicationNumber,"input",100)}_canShowComponentAccordingTaskType(e,t){return Ws[t].all?Ws[t].all:Ws[t][e]}_showGenericComponents(e){this._fillTaskTypeAccordingFirstTask(e),this._taskNameInput.selectedItem={id:e.taskId,name:e.taskName,label:e.title},this.taskTitleInput=e.title,this._taskTitleInput.readOnly||this._taskTitleInput.setAttribute("readonly",!0),this.taskColorInput=e.color,this.taskColorInputName=e.color,this.taskTypeSelect=e.taskType,this.taskComments=e.comments,this.taskSkipCondition=e.condition,this._taskSkipConditionInput.resetValidate(),this.documentationInput=e.documentation;var t=this._canShowComponentAccordingTaskType("loopType",e.taskType.toUpperCase());this.loopTypeSelect=t?e.loopType:"none",this._changeVisibility(this.wrapTaskLoopType,t)}_fillTaskTypeAccordingFirstTask(e){var t=["None","User","Manual"],s=[...t,"Service","Receive"],i=[...[...s,"Send","Script"]];this._checkIsFirstTask(e)&&(i=this._checkIsStartEventIsMessage()?[...t]:[...s]),this._fillSelect(this._taskTypeSelect,i)}_cleanSelect(e){for(;e.firstElementChild;)e.removeChild(e.firstElementChild)}_fillSelect(e,t){this._cleanSelect(e),t.forEach(t=>{var s=document.createElement("option");s.value=t.toLowerCase(),s.innerText=t,e.appendChild(s)})}_checkIsFirstTask(e){var t=ri(ze(A.START_EVENT,this.editor.elements),1)[0];if(t){var s=Je(t,this.editor.elements);if(s.length>0)for(var i=0;i<s.length;i++){var a=s[i];if(e.id===a.to)return!0}}return!1}_checkIsStartEventIsMessage(){return"message"===ri(ze(A.START_EVENT,this.editor.elements),1)[0].eventType}_showGroupsComponents(e){var t=this._canShowComponentAccordingTaskType("groups",e.taskType.toUpperCase());if(t){this._changeVisibility(this._taskGroupInput.wrapper,!0),this.taskParticipantDocumentation="",this._taskGroupInput.showValue(this._groupsShowValue());var s=this._createParticipantsArrayList();s.data=this._createCustomConditionList(e.groups||[]),this._taskListParticipants.arrayList=s,this._taskCondParticipant.disabled=!0,this._taskCondParticipant.resetValidate(),this._taskDocParticipant.disabled=!0,this.taskCondParticipant="",this.taskParticipantDocumentation=""}else this._changeVisibility(this._taskGroupInput.wrapper,t),this._changeVisibility(this._taskGroupInput.expandZone,t)}_showScheduleComponents(e){var t=this._canShowComponentAccordingTaskType("schedule",e.taskType.toUpperCase());t?(this._taskScheduleSearch.selectedItem=e.scheduleName?{id:e.scheduleId,name:e.scheduleName}:void 0,this._taskScheduleSubprocSearch.selectedItem=e.scheduleSubprocessName?{id:e.schedule.subprocess,name:e.scheduleSubprocessName}:void 0,this._taskScheduleTypeSelect.value="M"===e.scheduleType?"Manual":"",this._scheduleShowValue(e).then(t=>{this._taskScheduleInput.showValue(t),this._taskScheduleTaskSearch.selectedItem=e.scheduleTask?{id:e.scheduleTask,name:e.scheduleTaskName}:void 0;var s=e.schedule||{};s.subprocess?(this._taskScheduleTaskSearch.local=!1,this._taskScheduleTaskSearch.url="".concat(A.SUBPROCESS_TASKS_URL).concat(s.subprocess)):(this._taskScheduleTaskSearch.local=!0,this._taskScheduleTaskSearch.data=this._getLocalScheduleTasks())}).catch(e=>{}),this.element.schedule||(this.taskScheduleTypeSelect="")):(this._changeVisibility(this._taskScheduleInput.wrapper,t),this._changeVisibility(this._taskScheduleInput.expandZone,t))}_showRoleComponents(e){var t=this._canShowComponentAccordingTaskType("role",e.taskType.toUpperCase());t?(this._changeVisibility(this._taskRoleSearch.wrapper,!0),this._taskRoleSearch.selectedItem=e.role):this._changeVisibility(this._taskRoleSearch.wrapper,t)}_showStatesComponents(e){(this._taskListEventStates.editStatus||this._taskListEventStates.rowEditableSelected)&&(this._taskListEventStates.editStatus=!1,this._taskListEventStates.rowEditableSelected=null);var t=this._statesShowValue(e);this._taskStatesInput.showValue(t),this._taskListEventStates.arrayListData=this._createCustomConditionList(e.states||[]),this._taskConditionStates.conditionAreaEl.disabled=!0,this._taskConditionStates.resetValidate(),this.taskConditionStates="",this._taskDocStates.disabled=!0,this.taskDocStates="",this.taskSearchEventStates=void 0,this.taskSearchStates=void 0}_showEventsComponents(e){this._taskEvents.reset(),this._taskEvents.eventsList=e.events||[],this._taskEventsInput.showValue(this._eventsShowValue(e))}_showFormsComponents(e){var t=this._canShowComponentAccordingTaskType("forms",e.taskType.toUpperCase());if(t){this._changeVisibility(this._taskFormsInput.wrapper,!0);var s=this._formsShowValue(e);this.taskFormsInput=s,this._stepForms=this._getStepsForms(this.element),this._taskListStepForms.arrayListData=this._stepForms,this._taskListForms.arrayListData=[],this._taskSearchForms.selectedItem=void 0,this.taskConditionForms="",this._taskConditionForms.resetValidate(),this.taskDocumentationForms="",this._disableConditionAndDocForms(!0),this._disableTypeAndSearchForms(!0),this._stepSelected=this._getStepFormSelected()}else this._changeVisibility(this._taskFormsInput.wrapper,t),this._changeVisibility(this._taskFormsInput.expandZone,t)}_showLoopTypeComponents(e){var t=this._canShowComponentAccordingTaskType("loopType",e.taskType.toUpperCase());if(this._changeVisibility(this.wrapTaskLoopType,t),t){var s=t&&"none"!==this.loopTypeSelect,i=t&&"attribute"===e.multiInstanceType;this._changeVisibility(this._taskMultiInstanceLoopType.wrapper,s&&i),this._changeVisibility(this._wrapMultiInstanceType,s),this._changeVisibility(this._wrapMultiplicationNumber,s&&!i),this._taskMultiInstanceLoopType.selectedItem=bt()(e.multiInstanceAttribute)?void 0:ai({},e.multiInstanceAttribute),this.taskMultiInstanceType="value"===e.multiInstanceType,this.taskMultiplicationNumber=e.multiInstanceValue||"",this._wrapMultiInstanceType.querySelector(".highlighted").innerText=i?"Attribute":"Value"}else this._changeVisibility(this._taskMultiInstanceLoopType.wrapper,t),this._changeVisibility(this._wrapMultiInstanceType,t),this._changeVisibility(this._wrapMultiplicationNumber,t)}show(e){this._showGenericComponents(e),this._showGroupsComponents(e),this._showScheduleComponents(e),this._showRoleComponents(e),this._showStatesComponents(e),this._showEventsComponents(e),this._showFormsComponents(e),this._showLoopTypeComponents(e),this._showInputOutputMessageRefComponents(e),this._changeVisibility(this._panel,!0)}_transformLabelAccordingTaskType(e){var t=e.taskType.replace(/^./,e.taskType[0].toUpperCase());this.wrapInputOutputGroup.querySelector(".main__sidepanel__form__label").innerText="".concat(t,":")}_clearAllInputOutputComponents(){this.taskInputOutputGroup=!1,this._taskInputMsgRefExp.showValue([]),this._taskInputMsgRefSearch.selectedItem=void 0,this.taskWsMethodName="",this._taskInputMsgRefList.arrayListData=[],this._taskOutputMsgRefExp.showValue([]),this._wsSelected=null,this._taskOutputMsgRefWSList.arrayListData=[],this._taskOutputMsgRefBindingList.arrayListData=[],this._taskOutputWebServiceSearch.selectedItem=void 0,this.taskOutputWSBindingType="none",this.taskOutputWSBindingValue="",this._taskOutputWSBindingType.disabled=!0,this._changeVisibility(this.wrapOutputWSBindingValue,!1),this._changeVisibility(this._wrapOutputBindingAttrType,!1),this._changeVisibility(this._taskOutputBindingAttrSearch.wrapper,!1)}_showInputOutputMessageRefComponents(e){var t=this._canShowIt(e);this._transformLabelAccordingTaskType(e);var s=t.input||t.output;this._clearAllInputOutputComponents();var i=e.taskType;if(!this._checkIsFirstTask(e)||"user"!==i&&"service"!==i||(t.output=!1),t.input){var a=this._inputMessageRefShowValue(e);this._taskInputMsgRefExp.showValue(a),this.taskWsMethodName=e.wsMethodName||"",this._taskInputMsgRefList.arrayListData="P"===this.taskWsAttributeType?e.imrAttrProc||[]:e.imrAttrEnt||[]}if(t.output){var n=this._outputMessageRefShowValue(e);this._taskOutputMsgRefExp.showValue(n),this._taskOutputMsgRefWSList.arrayListData=this._getOutputWebServicesList(e)}this._changeVisibility(this.wrapInputOutputGroup,s),this._taskInputMsgRefExp.isExpand&&this._taskInputMsgRefExp.expand(),this._taskOutputMsgRefExp.isExpand&&this._taskOutputMsgRefExp.expand()}_groupsShowValue(){return(this.element.groups||[]).map(e=>e.name)}_scheduleShowValue(e){var t=this;return si((function*(){var s=[];if(e.schedule)try{[yield t._getScheduleName(e),"M"===e.scheduleType?"Manual":"",e.scheduleSubprocessName||"",yield t._getTaskName(e)].forEach(e=>{""!==e&&s.push(e)})}catch(e){}return s}))()}_statesShowValue(e){var t=[];e.states&&(t=e.states.map(e=>e.event));return t}_eventsShowValue(e){var t=[];e.events&&(t=e.events.map(e=>e.name));return t}_formsShowValue(e){var t="";if(e.forms){var s=e.forms.length;if(s>0){var i="(".concat(s,") - Step");t=s>1?"".concat(i,"s"):i}}return t}_outputMessageRefShowValue(e){var t=[],s=this._getOutputWebServicesList(e);return s&&s.forEach(e=>{t.push(e.busClaName)}),t}_inputMessageRefShowValue(e){var t=[];return e.inputMessageRef&&t.push(e.wsMethodName||""),t}_getTaskName(e){var t=this;return si((function*(){var s="";if(e.scheduleTaskName&&""!==e.scheduleTaskName)s=e.scheduleTaskName;else{if(""===e.scheduleSubprocessName&&e.scheduleTask)return ze(A.TASK,t.editor.elements).forEach(t=>{parseInt(t.taskId,10)===parseInt(e.scheduleTask,10)&&(e.scheduleTaskName=t.taskName)}),e.scheduleTaskName;if(e.schedule)try{var i=yield he.a.get(A.TASK_URL);i&&i.data.toUpperCase().indexOf("HTML")>-1&&t.showInvalidSession(),(new as).convertToJson(i.data).forEach(t=>{parseInt(t.id,10)===parseInt(e.scheduleTask,10)&&(s=t.name)}),e.scheduleTaskName=s}catch(e){}}return s}))()}_getScheduleName(e){var t=this;return si((function*(){var s="";if(e.scheduleName)s=e.scheduleName;else if(e.schedule)try{var i=yield he.a.get(A.TASK_SCHEDULE);i&&i.data.toUpperCase().indexOf("HTML")>-1&&t.showInvalidSession(),(new as).convertToJson(i.data).forEach(t=>{parseInt(t.id,10)===parseInt(e.scheduleId,10)&&(s=t.name)}),e.scheduleName=s}catch(e){}return s}))()}_createParticipantsArrayList(){return{header:[M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderName"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderCond"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!1,data:[],notShow:["id","conditionDoc","condition"],actions:[]}}_createEventsStatesArrayList(){return{header:[M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderEvent"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderStatus"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderCond"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderEdit"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!0,data:[],notShow:["id","idEvent","conditionDoc","condition","idName"],actions:[]}}_createStepFormsArrayList(){return{header:[M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderStep"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderEntity"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderProcess"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!1,data:this._stepForms,notShow:["id"],actions:[]}}_getStepsForms(e){var t=[];return e.forms&&e.forms.forEach(e=>{var s={id:parseInt(e.id,10),name:"Step",entity:e.EForms&&e.EForms.length>0?e.EForms.length:"0",process:e.PForms&&e.PForms.length>0?e.PForms.length:"0"};t.push(s)}),t}_getOutputWebServicesList(e){var t=[],s="BPMNAUTOCOMPLETE";return e.outputMessageRef&&e.outputMessageRef.forEach(e=>{e.busClaName.toUpperCase()!==s&&t.push(e)}),t}_createFormsArrayList(){return{header:["name",{title:"ro",type:"checkbox",key:"readOnly",all:!1},{title:"multi",type:"checkbox",key:"multiply",all:!1},"cond","delete-all"],deleteAction:!0,deleteActionAll:!0,editAction:!1,data:[],notShow:["id","step","order","formType","conditionDoc","condition"],actions:[{key:"readOnly",type:"checkbox"},{key:"multiply",type:"checkbox"}]}}_createInputMsgRefAttrsArrayList(){return{header:[M.a.t("taskPropsPanel.txtProDesTaskPanelHeadername"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderMulti"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderUk"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderEdit"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!0,data:[],notShow:["id","type"],actions:[{key:"multivalued",type:"checkbox"},{key:"uk",type:"checkbox"}]}}_createOutputMsgRefWsArrayList(){return{header:[M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderName"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderEdit"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!0,data:[],notShow:["id","eventId","busClaId","name","order","WS","bindings","haveCond","condition"],actions:[]}}_createWebServiceBindingsArrayList(){return{header:[M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderParam"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderType"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderInOut"),M.a.t("taskPropsPanel.txtProDesTaskPanelHeaderBinding")],deleteAction:!1,deleteActionAll:!1,editAction:!1,data:[],notShow:["id"],actions:[]}}_onExpandScheduleInput(){var e=this;return si((function*(){if(e.element){e._showScheduleComponents(e.element);var t=e._scheduleShowValue(e.element);e._taskScheduleInput.showValue(t)}}))()}_onSelectScheduleAgendaChanged(e){var t=this;return si((function*(){if(e){t.element.createDefaultSchedule(),t.element.scheduleId=parseInt(e.id,10),t.element.scheduleName=e.name;var s=yield t._scheduleShowValue(t.element);t._taskScheduleInput.showValue(s)}}))()}_onSelectRoleTaskChanged(e){e&&(this.element.role=e);var t=!e&&""!==this.taskRoleSearch;this._taskRoleSearch.toggleDisabledButton(!t)}_onClearRoleTasks(){this.element.role.id=void 0,this.element.role.name="",this._taskRoleSearch.reloadData()}_onAddNewRoleSearch(){var e=this;return si((function*(){if(!e._taskRoleSearch.selectedItem&&"Production"===A.ENV&&e.element){var t=e.taskRoleSearch;if(/^[a-zA-Z][a-zA-Z_]+[a-zA-Z]$/gi.test(t))try{var s="".concat(A.NEW_ROLE_URL,"&name=").concat(t),i=yield he.a.post(s);if(i&&i.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession(),i){var a=ri((new as).convertToJson(i.data),1)[0];e.element.role=a,e._taskRoleSearch.selectedItem=a,e._taskRoleSearch.reloadData(),e._taskRoleSearch.toggleDisabledButton(!0);var n=ai({},e.OPTIONS_TOAST);n.type="success",n.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessTitle"),n.message=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessMessage"),e.toastMessage.showMessage(n)}}catch(e){throw Error(M.a.t("taskPropsPanel.txtProDesTaskPanelErrorMessage"))}else{var r=ai({},e.OPTIONS_TOAST);r.type="danger",r.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorTitle"),r.message="".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageRoleName"),' <b>"').concat(t,'"</b> ').concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageIsValid")),e.toastMessage.showMessage(r)}}}))()}_onSelectScheduleTypeChanged(){var e=this;return si((function*(){if(e.element){""!==e.taskScheduleTypeSelect?(e.element.createDefaultSchedule(),e.element.scheduleType="manual"===e.taskScheduleTypeSelect.toLowerCase()?"M":""):e.element.deleteScheduleProperties(["type"]);var t=yield e._scheduleShowValue(e.element);e._taskScheduleInput.showValue(t)}}))()}_onSelectScheduleSubprocessChanged(e){var t=this;return si((function*(){if(e){t.element.createDefaultSchedule(),t.element.scheduleSubprocess=parseInt(e.id,10),t.element.scheduleSubprocessName=e.name,t._taskScheduleTaskSearch.local=!1,t._taskScheduleTaskSearch.data=[],t._taskScheduleTaskSearch.url="".concat(A.SUBPROCESS_TASKS_URL).concat(e.id),t._taskScheduleTaskSearch.selectedItem=void 0;var s=yield t._scheduleShowValue(t.element);t._taskScheduleInput.showValue(s)}}))()}_onSelectScheduleTaskChanged(e){var t=this;return si((function*(){if(e){t.element.createDefaultSchedule(),t.element.scheduleTask=parseInt(e.id,10),t.element.scheduleTaskName=e.name;var s=yield t._scheduleShowValue(t.element);t._taskScheduleInput.showValue(s)}}))()}_onClearSchedulePropertyChanged(e){var t=this;return si((function*(){if(t.element){e.includes("subprocess")&&(t._taskScheduleTaskSearch.selectedItem=void 0,t._taskScheduleTaskSearch.local=!0,t._taskScheduleTaskSearch.data=t._getLocalScheduleTasks()),t.element.deleteScheduleProperties(e);var s=yield t._scheduleShowValue(t.element);t._taskScheduleInput.showValue(s)}}))()}_toggleVisibilityTaskGroup(e){var t="user"===e.taskType||"manual"===e.taskType||"none"===e.taskType;this._changeVisibility(this._taskGroupInput.wrapper,t)}_onSelectNameChange(e){var t=this.element.taskName;e&&t!==e.name&&(this.taskTitleInput=e.label,this.element.taskName=e,this._taskTitleInput.setAttribute("readonly",!0)),""!==this.taskTitleInput&&this._taskTitleInput.readOnly&&"Development"!==A.ENV&&!e&&(this.taskTitleInput=""),"Development"===A.ENV||""===this.taskNameInput||e?""===this.taskNameInput&&this._taskTitleInput.setAttribute("readonly",!0):this._taskTitleInput.removeAttribute("readonly");var s=""!==this.taskNameInput&&void 0===e;this._taskNameInput.toggleDisabledButton(!s)}_onClearNameInput(){this._taskTitleInput.value="";var e={id:"2",name:"Default_Task",label:"Default Task"};this.taskTitleInput=e.label,this.element.taskName=e,this._taskTitleInput.setAttribute("readonly",!0),this._taskNameInput.selectedItem=e}_onAddNewTaskNameInput(){var e=this;return si((function*(){if(!e._taskNameInput.selectedItem&&"Production"===A.ENV&&e.element&&!e._taskTitleInput.readOnly){var t=new RegExp(/^[a-zA-Z][\w]+[a-zA-Z0-9]$/gi),s=e.taskNameInput.trim(),i=""!==e._taskTitleInput?e._taskTitleInput.value.trim():s;if(t.test(s)){var a=encodeURI(s),n=encodeURI(i),r="".concat(A.NEW_TASK_URL,"&name=").concat(a,"&title=").concat(n);try{var o=yield he.a.post(r);if(o&&o.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession(),o){var l=ri((new as).convertToJson(o.data),1)[0];e.element.taskName=l,e.element.title=l.label,e._taskTitleInput.readOnly||e._taskTitleInput.setAttribute("readonly",!0),e._taskNameInput.selectedItem=l,e._taskNameInput.reloadData(),e._taskNameInput.toggleDisabledButton(!0);var h=e.OPTIONS_TOAST;h.type="success",h.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessTitle"),h.message=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessMessageTask"),e.toastMessage.showMessage(h)}}catch(e){throw Error(M.a.t("taskPropsPanel.txtProDesTaskPanelErrorMessageTask"))}}else{var c=ai({},e.OPTIONS_TOAST);c.type="danger",c.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorTitle"),c.message="".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageTaskName"),' <b>"').concat(s,'"</b> ').concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageIsValid")),e.toastMessage.showMessage(c)}}}))()}_onSelectParticipantItem(e){if(e){this._taskCondParticipant.conditionAreaEl.disabled=!1,this._taskCondParticipant.conditionArea=e.condition||"",this.taskParticipantDocumentation=e.conditionDoc||"",this._taskDocParticipant.disabled=!1;var t="\n        <b>".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageParticipantName"),"</b> ").concat(e.name,"<br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageCondition"),"</b> ").concat(e.haveCond,"\n      ");this.toastMessage.showMessage(ai(ai({},this.OPTIONS_TOAST),{},{message:t}))}}_onStateConditionChanged(e){var t=this._taskListEventStates.rowSelected;t&&(this.element.setPropertyObject(t,"states","condition",e),this._taskListEventStates.arrayList.data=this._createCustomConditionList(this.element.states),this._taskListEventStates.refreshList())}_onParticipantConditionChanged(e){var t=this._taskListParticipants.rowSelected;t&&(this.element.setPropertyObject(t,"groups","condition",e),this._taskListParticipants.arrayList.data=this._createCustomConditionList(this.element.groups),this._taskListParticipants.refreshList())}_onParticipantDocumentationChanged(){var e=this._taskListParticipants.rowSelected;e&&this.element.setPropertyObject(e,"groups","conditionDoc",this.taskParticipantDocumentation)}_onSelectSearchParticipant(e){if("Production"===A.ENV){var t=void 0===e&&""!==this.taskSearchParticipant;this._taskSearchParticipant.toggleDisabledButton(!t)}}_onAddNewParticipant(){var e=this;return si((function*(){if(!e._taskSearchParticipant.selectedItem&&"Production"===A.ENV){var t=new RegExp(/^[a-zA-Z][\w]+[a-zA-Z0-9]$/gi),s=e.taskSearchParticipant.trim();if(t.test(s)){var i="".concat(A.NEW_PARTICIPANT_URL,"&name=").concat(encodeURI(s));try{var a=yield he.a.post(i);if(a&&a.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession(),a){var n=ri((new as).convertToJson(a.data),1)[0];e._taskSearchParticipant.selectedItem=n,e._taskSearchParticipant.reloadData(),e._taskSearchParticipant.toggleDisabledButton(!0);var r=ai({},e.OPTIONS_TOAST);r.type="success",r.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessTitle"),r.message=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessMessageParticipant"),e.toastMessage.showMessage(r)}}catch(e){throw Error(M.a.t("taskPropsPanel.txtProDesTaskPanelErrorMessageParticipant"),e)}}else{var o=ai({},e.OPTIONS_TOAST);o.type="danger",o.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorTitle"),o.message="".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageTaskParticipant"),' <b>"').concat(s,'"</b> ').concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageIsValid")),e.toastMessage.showMessage(o)}}}))()}_onAddParticipantSelect(){var e=this._taskSearchParticipant.selectedItem;if(e){this.element.groups||(this.element.createDefaultGroup(),this.element.groups=this._taskListParticipants.arrayList.data);var t=[...this.element.groups],s=e.id,i=e.name;-1===t.findIndex(e=>parseInt(e.id,10)===parseInt(s,10))&&(t.push({id:s,name:i}),this.element.groups=t,this._taskListParticipants.arrayList.data=this._createCustomConditionList(this.element.groups||[]),this._taskListParticipants.refreshList(),this._taskGroupInput.showValue(this._groupsShowValue()),this._taskSearchParticipant.selectedItem=void 0,this._taskListParticipants._scrollToRow({id:s,name:i},()=>this._onSelectParticipantItem({id:s,name:i})))}}_getObjectIndexById(e,t){return t.findIndex(t=>parseInt(t.id,10)===parseInt(e,10))}_onDeleteParticipantItem(e){if(e){var t=this._getObjectIndexById(e.id,this.element.groups),s=this._taskListParticipants.arrayList.data.map(e=>e);-1!==t&&(s.splice(t,1),this.element.groups=s,this._taskGroupInput.showValue(this._groupsShowValue()),this._taskListParticipants.arrayList.data=this._createCustomConditionList(this.element.groups),this._taskListParticipants.refreshList(),this.taskCondParticipant="",this.taskParticipantDocumentation="",this._taskCondParticipant.disabled=!0,this._taskDocParticipant.disabled=!0)}}_onDeleteAllParticipantItems(){this.element.groups=[],this._taskGroupInput.showValue(this._groupsShowValue()),this._taskListParticipants.arrayList.data=this.element.groups}_onAddStateList(){var e=this._taskSearchEventStates.selectedItem,t=this._taskSearchStates.selectedItem,s=this.element.states||[];if(e&&t){var i={id:parseInt(s.length+1,10),idEvent:parseInt(e.id,10),event:e.name,idName:parseInt(t.id,10),name:t.name,condition:"",conditionDoc:""};this.element.createDefaultStates();var a=this.element.states.map(e=>e);a.push(i),this.element.states=a,this._taskListEventStates.arrayList.data=this._createCustomConditionList(this.element.states||[]),this._taskListEventStates.refreshList(),this._taskStatesInput.showValue(this._statesShowValue(this.element)),this._taskListEventStates._scrollToRow(i,()=>this._onSelectedEventState(i))}}_onSelectedEventState(e){if(e){this._taskConditionStates.conditionAreaEl.disabled=!1,this._taskDocStates.disabled=!1,this.taskConditionStates=e.condition||"",this.taskDocStates=e.conditionDoc||"";var t="\n        <b>".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageEvent"),"</b> ").concat(e.event,"<br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageStatus"),"</b> ").concat(e.name,"\n      ");this.toastMessage.showMessage(ai(ai({},this.OPTIONS_TOAST),{},{message:t}))}}_onEditEventState(e){var t=this._taskListEventStates.rowEditableSelected;e&&(this.taskConditionStates=t.condition||"",this.taskDocStates=t.conditionDoc||"",this._taskConditionStates.disabled=!0,this._taskDocStates.disabled=!0),this._taskSearchEventStates.selectedItem=e&&t&&{id:t.idEvent,name:t.event},this._taskSearchStates.selectedItem=e&&t&&{id:t.idName,name:t.name},this._taskListEventStates.refreshList()}_onSelectEventOrStates(e,t){if(e&&this._taskListEventStates.editStatus&&this.element){var s=this._taskListEventStates.rowEditableSelected;if(s){var i="event"===t?["idEvent","event"]:["idName","name"],a=[parseInt(e.id,10),e.name];"state"===t&&(s.condition="",s.conditionDoc="",this.taskConditionStates=s.condition||"",this.taskDocStates=s.conditionDoc||"",this._onConditionAndDocumentationStatesChanged("","condition"),this._onConditionAndDocumentationStatesChanged("","conditionDoc")),this.element.setPropertyObject(s,"states",i,a),this._taskListEventStates.arrayList.data=this._createCustomConditionList(this.element.states||[]),this._taskListEventStates.refreshList()}}}_onConditionAndDocumentationStatesChanged(e,t){var s=this._taskListEventStates.rowSelected||this._taskListEventStates._rowEditableSelected;s&&(this.element.setPropertyObject(s,"states",t,e),this._taskListEventStates.arrayList.data=this._createCustomConditionList(this.element.states||[]),this._taskListEventStates.refreshList())}_onDeleteEvenStatestList(e){var t=this.element.objectIndex(e,"states");if(-1!==t){var s=this.element.states.map(e=>e);s.splice(t,1),this.element.states=s,this._taskListEventStates.arrayList.data=this._createCustomConditionList(this.element.states||[]),this._taskListEventStates.refreshList(),this.taskConditionStates="",this.taskDocStates="",this._taskConditionStates.conditionAreaEl.disabled=!0,this._taskDocStates.disabled=!0,this._taskStatesInput.showValue(this._statesShowValue(this.element))}}_onDeleteAllEventStatesList(){this.element.states=[],this.taskConditionStates="",this.taskDocStates="",this._taskConditionStates.disabled=!0,this._taskDocStates.disabled=!0}_deletePropertyWhenTaskTypeChanged(e){var t=Ws[e],s=Object.entries(t);if(this.element){for(var i=0;i<s.length;i++){var a=s[i][0];this.element.properties[a]&&!s[i][1]&&this.element.deletePropertyByName(a)}this.element.deletePropertyByName("inputMessageRef"),this.element.deletePropertyByName("outputMessageRef"),t.groups||this.element.deletePropertyByName("groups"),this._cleanAndDeleteLoopProperties()}}_cleanAndDeleteLoopProperties(){("none"!==this.element.loopType||this.element.multiInstance)&&(this.element.deletePropertyByName("multiInstance"),this.element.setPropertyWithoutSave("loopType","none"))}_showAccording(e){this._showGroupsComponents(e),this._showLoopTypeComponents(e),this._showRoleComponents(e),this._showFormsComponents(e),this._showInputOutputMessageRefComponents(e)}_onTaskTypeSelectChanged(){var e=this.taskTypeSelect;this.element.taskType=e,this._deletePropertyWhenTaskTypeChanged(e.toUpperCase()),this._showAccording(this.element),this._switchInputOutputArea();var t=this.element.boundaryEvents,s="receive"===e||"send"===e||"service"===e||"script"===e;t.length>0&&s&&t.forEach(e=>{var t=e,s=this.editor.elements.find(e=>e.id===t);s&&("message"===s.eventType&&(s.setTypeWithoutSave("timer"),s.deletePropertyByName("message")))})}_switchInputOutputArea(){this.taskInputOutputGroup&&(this.taskInputOutputGroup=!1,this._onInputOutputGroupChanged(),this._showInputOutputMessageRefComponents(this.element))}_onTaskColorChanged(){this.element.color=this.taskColorInput,this.taskColorInputName=this.taskColorInput}_onLoopTypeSelectChanged(){this.element.loopType=this.loopTypeSelect,this.element.multiInstance?delete this.element.properties.multiInstance:this.element.multiInstance={type:"attribute"},this._showLoopTypeComponents(this.element)}_onTaskMultiInstanceTypeChanged(){var e=this._wrapMultiInstanceType.querySelector(".highlighted");if(this.element){var t="value"===this.taskMultiInstanceType;t?this.taskMultiplicationNumber="":this._taskMultiInstanceLoopType.selectedItem=void 0,this._changeVisibility(this._wrapMultiInstanceLoopType,!t),this._changeVisibility(this._wrapMultiplicationNumber,t),this.element.multiInstanceType=this.taskMultiInstanceType,e.innerText=t?"Value":"Attribute"}}_onValidateMultiplicationNumber(){var e=this.taskMultiplicationNumber;(e<1||isNaN(e))&&(this.taskMultiplicationNumber=1),this.taskMultiplicationNumber=""===e?"":parseInt(e,10)}_onTaskMultiplicationNumberChanged(){if(this.element){var e=this.taskMultiplicationNumber;this.element.multiInstanceValue!==e&&""!==e&&(this.element.multiInstanceValue=e)}}_onTaskNameChanged(){this.element.name=this.taskNameInput}_onTaskCommentsChanged(){this.element.comments=this.taskComments}_onTaskSkipConditionChanged(e){this.element.condition=e}_getBindings(e){var t=this;return si((function*(){var s=[],i=A.TASK_BINDINGS_URL;"Development"!==A.ENV&&(i="".concat(i).concat(e));try{var a=yield he.a.get(i);a.data.toUpperCase().indexOf("HTML")>-1&&t.showInvalidSession(),s=(new as).convertToJson(a.data)}catch(e){}var n=tt(s);return t._customBindingsParameters(n)}))()}_customBindingsParameters(e=[]){if(this.wsSelected){var t=st(this.wsSelected.bindings||[],"busClaParId");return e.map(e=>{var s=t[e.id];return ai(ai({},e),{},{binding:s?this._getEspecificationBinding(s):"None"})})}return e}_getEspecificationBinding(e){var t="V"===e.busClaParBndType&&""!==e.busClaParBndValue&&e.busClaParBndValue,s="P"===e.busClaParBndType,i="E"===e.busClaParBndType,a=(s||i)&&-1!==e.attId&&e.attId;return t?"Value":a?"Attribute":"None"}_onTaskEventsChanged(e){this.element&&(this.element.events=e,this._taskEventsInput.showValue(this._eventsShowValue(this.element)))}_getMaxId(e){var t=0;return e.forEach(e=>{parseInt(e.id,10)>t&&(t=parseInt(e.id,10))}),t}_getStepFormSelected(){var e,t=this._taskListStepForms.rowSelected;this.element&&t&&(e=(this.element.forms||[]).find(e=>parseInt(e.id,10)===parseInt(t.id,10)));return e}_onExpandForms(){this._stepForms=this._getStepsForms(this.element),this._taskListStepForms.arrayListData=this._stepForms}_disableConditionAndDocForms(e){this._taskConditionForms.conditionAreaEl.disabled=e,this._taskDocumentationForms.disabled=e}_disableTypeAndSearchForms(e){this._taskSearchForms.disabled=e,this._taskTypeForms.disabled=e}_onTaskStepListFormsSelect(e){var t=this._getStepFormSelected();if(this._stepSelected!==t){if(this._disableTypeAndSearchForms(!1),this._disableConditionAndDocForms(!0),this._stepSelected=t,this.taskConditionForms="",this.taskDocumentationForms="",this._taskListForms.arrayListData=[],parseInt(e.entity,10)>0||parseInt(e.process,10)>0){var s="entity"===this.taskTypeForms?"E":"P";if(this.element){var i=this._createCustomConditionList(t["".concat(s,"Forms")]);this._taskListForms.arrayListData=i||[]}}var a="\n        <b>".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageFormStep"),"</b><br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageEntityForms"),"</b> ").concat(e.entity,"<br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageProcessForms"),"</b> ").concat(e.process,"\n      ");this.toastMessage.showMessage(ai(ai({},this.OPTIONS_TOAST),{},{message:a}))}}_onTaskFormListSelect(e){if(e){var t=e.condition,s=e.conditionDoc;this.taskConditionForms=t||"",this.taskDocumentationForms=s||"",this._disableConditionAndDocForms(!1);var i="\n        <b>".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageName"),"</b> ").concat(e.name,"<br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageReadOnly"),"</b> ").concat(e.readOnly?"True":"False","<br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageMultiply"),"</b> ").concat(e.multiply?"True":"False","\n      ");this.toastMessage.showMessage(ai(ai({},this.OPTIONS_TOAST),{},{message:i}))}}_createCustomConditionList(e=[]){var t=Se()(e);return t.forEach(e=>{e.haveCond=e.condition&&""!==e.condition?"Yes":"No"}),t}_onTaskTypeFormsSelectChanged(){var e=this._getStepFormSelected(),t="entity"===this.taskTypeForms?"E":"P",s="E"===t?A.TASK_ENT_FORMS_URL:A.TASK_PROC_FORMS_URL;if(e){this._taskSearchForms.url=s;var i=this._createCustomConditionList(e["".concat(t,"Forms")]||[]);this._taskListForms.arrayListData=i,this.taskConditionForms="",this.taskDocumentationForms="",this._disableConditionAndDocForms(!0)}}_onTaskConditionAndDocFormsChanged(e,t){var s=this._getStepFormSelected(),i=this._taskListForms.rowSelected,a="entity"===this.taskTypeForms?"EForms":"PForms",n=this.element.objectIndex(s,"forms"),r=this.element.objectIndex(i,s[a]);if(-1!==r&&-1!==n&&this.element){this.element.setSpecificFormInStepByIndex(n,a,void 0,r,e,t);var o=this.element.forms[n][a];this._taskListForms.arrayList.data=this._createCustomConditionList(o),this._taskListForms.refreshList()}}_onSelectTaskSearchForms(e){var t=!e&&""!==this.taskSearchForms;this._taskSearchForms.toggleDisabledButton(!t)}_onAddNewTaskForm(){var e=this;return si((function*(){if(!e._taskSearchForms.selectedItem&&"Production"===A.ENV&&e.element){var t=e.taskSearchForms;if(/^[a-zA-Z][a-zA-Z0-9_]+[a-zA-Z0-9]$/gi.test(t))try{var s="entity"===e.taskTypeForms?A.NEW_ENT_FORM_URL:A.NEW_FORM_URL,i="".concat(s,"&name=").concat(t),a=yield he.a.post(i);if(a&&a.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession(),a){var n=ri((new as).convertToJson(a.data),1)[0];e.element.role=n,e._taskSearchForms.selectedItem=n,e._taskSearchForms.reloadData(),e._taskSearchForms.toggleDisabledButton(!0);var r=ai({},e.OPTIONS_TOAST);r.type="success",r.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessTitle"),r.message=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessMessageForm"),e.toastMessage.showMessage(r)}}catch(e){throw Error(M.a.t("taskPropsPanel.txtProDesTaskPanelErrorMessageForm"))}else{var o=ai({},e.OPTIONS_TOAST);o.type="danger",o.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorTitle"),o.message="".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageTaskForm"),' <b>"').concat(t,'"</b> ').concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageIsValid")),e.toastMessage.showMessage(o)}}}))()}_onAddTaskStepListForms(){if(this.element){this.element.forms||(this.element.forms=[]);var e=this.element.forms.slice(),t={id:this._getMaxId(e)+1};e.push(t),this.element.forms=e,this._taskListStepForms.arrayList.data=this._getStepsForms(this.element),this._taskListStepForms.refreshList(),this.taskFormsInput=this._formsShowValue(this.element),this._taskListStepForms._scrollToRow(t,()=>this._onTaskStepListFormsSelect(t))}}_onDeleteTaskStepListForms(e){var t=this.element.forms.findIndex(t=>parseInt(t.id,10)===parseInt(e.id,10));if(-1!==t){var s=this.element.forms.slice();s.splice(t,1),this.element.forms=s,this._taskListStepForms.arrayList.data=this._getStepsForms(this.element),this._taskListStepForms.refreshList(),this.taskFormsInput=this._formsShowValue(this.element)}this._disabledWhenDeleteInForms()}_disabledWhenDeleteInForms(){this._disableTypeAndSearchForms(!0),this._disableConditionAndDocForms(!0),this.taskConditionForms="",this.taskDocumentationForms="",this.taskSearchForms="",this._taskListForms.arrayListData=[]}_onDeleteAllTaskStepListForms(){this.element&&(this.element.forms=[],this.taskFormsInput=this._formsShowValue(this.element),this._disabledWhenDeleteInForms())}_onCheckTaskListForm({value:e,position:t,keyName:s}){if(this.element){var i="entity"===this.taskTypeForms?"EForms":"PForms",a=this._taskListStepForms.rowSelected,n=this.element.forms.findIndex(e=>parseInt(e.id,10)===parseInt(a.id,10));if(-1!==n)this.element.forms[n][i][t]&&this.element.setSpecificFormInStepByIndex(n,i,void 0,t,s,e)}}_onAddTaskListForms(){var e=this._getStepFormSelected(),t="entity"===this.taskTypeForms?"EForms":"PForms",s=this._taskSearchForms.selectedItem;if(e&&s){e[t]||(e[t]=[]);var i={id:parseInt(s.id,10),name:s.name,order:e[t].length,readOnly:!1,multiply:!1,formType:t.charAt(0),condition:"",conditionDoc:""},a=e[t].slice();if(-1===a.findIndex(e=>parseInt(e.id,10)===i.id))a.push(i),this.element.setPropertyObject(e,"forms",t,a),this._taskListForms.arrayList.data=this._createCustomConditionList(a),this._taskListForms.refreshList(),this._taskListForms._scrollToRow(i,()=>this._onTaskFormListSelect(i)),this._taskListStepForms.rowSelected[this.taskTypeForms]=e[t].length,this._taskListStepForms.refreshList()}}_onDeleteTaskFormList(e,t=!1){if(e){var s="entity"===this.taskTypeForms?"EForms":"PForms",i=this._getStepFormSelected(),a=t?[]:i[s].slice(),n=this.element.objectIndex(i,"forms"),r=this.element.objectIndex(e,a);if(-1!==r&&-1!==n||t)t||a.splice(r,1),this.element.setSpecificFormInStepByIndex(n,s,a),this._taskListForms.arrayList.data=this._createCustomConditionList(a),this._taskListForms.refreshList(),this._taskListStepForms.rowSelected[this.taskTypeForms]="".concat(i[s].length),this._taskListStepForms.refreshList()}}_onOrderStepFormsChanged(e,t,s,i,a=[]){for(var n=this,r=[],o=function(e){var t=n.element.forms.find(t=>parseInt(t.id,10)===parseInt(a[e].id,10));r.push(t)},l=0;l<a.length;l++)o(l);s.order=e+1,i.order=t+1,this.element.forms=r}_onOrderFormsChanged(e,t,s,i,a=[]){s.order=e,i.order=t}_onOrderTaskEventsChanged(e,t,s,i,a=[]){}_onTaskMultiInstanceChanged(e){if(this.element){var t=this.element.multiInstanceAttributeName||"";if(e&&t!==e.name){var s=ai(ai({},this.element.multiInstance),{},{attribute:e.name,attributeId:parseInt(e.id,10),condition:"All",ordering:"Parallel"});this.element.multiInstance=s}var i=void 0===e&&""!==this.taskMultiInstanceLoopType.trim();this._taskMultiInstanceLoopType.toggleDisabledButton(!i)}}_addNewNumericAttribute(e,t,s,i){var a=this;return si((function*(){if(!t&&"Production"===A.ENV&&a.element){if(/^[a-zA-Z][a-zA-Z_]+[a-zA-Z]$/gi.test(e))try{var n="".concat(A.NEW_NUMERIC_ATTR_URL).concat(e),r=yield he.a.post(n);if(r&&r.data.toUpperCase().indexOf("HTML")>-1&&a.showInvalidSession(),r){var o=ri((new as).convertToJson(r.data),1)[0];s(o),i.selectedItem=o,i.reloadData(),i.toggleDisabledButton(!0);var l=ai({},a.OPTIONS_TOAST);l.type="success",l.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessTitle"),l.message=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessMessageAttr"),a.toastMessage.showMessage(l)}}catch(e){throw Error(M.a.t("taskPropsPanel.txtProDesTaskPanelErrorMessageAttr"))}else{var h=ai({},a.OPTIONS_TOAST);h.type="danger",h.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorTitle"),h.message="".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageTaskAttr"),' <b>"').concat(e,'"</b> ').concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageIsValid")),a.toastMessage.showMessage(h)}}}))()}_onAddMultiInstanceAttribute(){var e=this.taskMultiInstanceLoopType.trim(),t=this._taskMultiInstanceLoopType.selectedItem;this._addNewNumericAttribute(e,t,e=>this._onTaskMultiInstanceChanged(e),this._taskMultiInstanceLoopType)}_onExpandInputMessageRefExp(){}_onTaskWsMethodNameChanged(){if(this.element){this.element.wsMethodName=this.taskWsMethodName;var e=this._inputMessageRefShowValue(this.element);this._taskInputMsgRefExp.showValue(e)}}_onSelectTaskWsAttributeType(){if(this.element){this.element.inputMessageRef||(this.element.inputMessageRef={});var e="P"===this.taskWsAttributeType?"attrProc":"attrEnt";if(this.element.inputMessageRef){var t=this.element.inputMessageRef[e]||[];this._taskInputMsgRefList.arrayList.data=t,this._taskInputMsgRefList.refreshList(),this._getBindings(this.wsSelected.busClaId).then(e=>{this._taskOutputMsgRefBindingList.arrayList.data=e,this._taskOutputMsgRefBindingList.refreshList()})}}}_onEditTaskInputMsgRefList(e){this._taskWsMethodName.disabled=e,this._taskWsAttributeType.disabled=e;var t=this._taskInputMsgRefList.rowEditableSelected;this._taskInputMsgRefSearch.selectedItem=e?{id:t.id,name:t.name}:void 0}_onAddTaskInputMsgRefList(){var e="P"===this.taskWsAttributeType?"attrProc":"attrEnt",t=this._taskInputMsgRefSearch.selectedItem,s=[];(this.element.inputMessageRef||[])[e]&&(s=this.element.inputMessageRef[e]);var i=s.find(e=>parseInt(t.id,10)===parseInt(e.id,10));if(this.element&&t&&!i){var a={id:parseInt(t.id,10),name:t.name,multivalued:!1,type:this.taskWsAttributeType,uk:!1};this.element.insertAttributeInputMsgRef(e,a),this._taskInputMsgRefList.arrayList.data=this.element.inputMessageRef[e],this._taskInputMsgRefList.refreshList(),this._taskInputMsgRefList._scrollToRow(a,()=>this._onSelectInputMsgRefList(a))}}_onDeleteTaskInputMsgRefList(e){var t="P"===this.taskWsAttributeType?"attrProc":"attrEnt";if(this.element&&e){var s=this.element.inputMessageRef[t],i=this.element.objectIndex(e,s);-1!==i&&(this.element.deleteAttributeInputMsgRef(t,i),this._taskInputMsgRefList.refreshList())}}_onDeleteAllTaskInputMsgRefList(){var e="P"===this.taskWsAttributeType?"attrProc":"attrEnt";this.element&&this.element.cleanAttributesInputMsgRef(e)}_onSelectInputMsgRefList(e){if(e){var t="\n        <b>".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageName"),"</b> ").concat(e.name,"<br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageType"),"</b> ").concat("P"===e.type?"Process":"Entity","<br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageMultivalued"),"</b> ").concat(e.multivalued?"True":"False","<br>\n        <b>").concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastMessageUniqueKey"),"</b> ").concat(e.uk?"True":"False","<br>\n      ");this.toastMessage.showMessage(ai(ai({},this.OPTIONS_TOAST),{},{message:t}))}}_onCheckInputMsgRefList(e){var t=e.value,s=e.position,i=e.keyName,a=this._taskInputMsgRefList.arrayList.data,n="multivalued"===i?"uk":"multivalued";t&&(a[s][n]=!t),this._taskInputMsgRefList.refreshList()}_onCheckInputSelectedOnList(e){return this._taskInputMsgRefList._arrayList.data.find(t=>Number(e.id)===Number(t.id))}_onTaskInputMsgRefSearchChanged(e){var t=this._taskInputMsgRefList.rowEditableSelected,s=this._taskInputMsgRefList.editStatus,i=!!e&&this._onCheckInputSelectedOnList(e),a=""!==this._taskInputMsgRefSearch.valueEl&&!s&&!e;if(this._taskInputMsgRefSearch.toggleDisabledButton(!a),t&&e&&s&&!i){var n="P"===this.taskWsAttributeType?"attrProc":"attrEnt",r=this.element.inputMessageRef[n],o=this.element.objectIndex(t,r);if(-1!==o){var l={id:parseInt(e.id,10),name:e.name,multivalued:!1,type:this.taskWsAttributeType,uk:!1};this.element.editAttributesInputMsgRef(n,o,l),this._taskInputMsgRefList.rowEditableSelected=l,this._taskInputMsgRefList.refreshList()}}}_insertNewAttribute(e,t,s){var i=this;return si((function*(){var a="".concat(e).concat(t),n=yield he.a.post(a);if(n&&n.data.toUpperCase().indexOf("HTML")>-1&&i.showInvalidSession(),n){var r=ri((new as).convertToJson(n.data),1)[0];s.selectedItem=r,s.reloadData(),s.toggleDisabledButton(!0)}}))()}_onAddNewInputMsgAttribute(){var e=this;return si((function*(){var t=e._taskInputMsgRefSearch.valueEl.trim();if(!e._taskInputMsgRefSearch.selectedItem&&"Production"===A.ENV)if(Gs(t))try{e._insertNewAttribute(A.NEW_TASK_INPUT_MSG_ATTR,t,e._taskInputMsgRefSearch).then(()=>e._showSuccessInsertionMessage())}catch(e){}else e._showErrorMessage("".concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageTaskAttr"),' <b>"').concat(t,'"</b> ').concat(M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorMessageIsValid")))}))()}_showErrorMessage(e){var t=ai({},this.OPTIONS_TOAST);t.type="danger",t.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastErrorTitle"),t.message=e,this.toastMessage.showMessage(t)}_showSuccessInsertionMessage(){var e=ai({},this.OPTIONS_TOAST);e.type="success",e.title=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessTitle"),e.message=M.a.t("taskPropsPanel.txtProDesTaskPanelToastSuccessMessageAttr"),this.toastMessage.showMessage(e)}_canShowIt(e){var t={input:!1,output:!1};switch(e.taskType){case"send":t.output=!0;break;case"receive":t.input=!0;break;case"service":case"user":t.input="multiinstance"!==e.loopType,t.output=!0}return t}_onInputOutputGroupChanged(){var e=this.taskInputOutputGroup;if(this.element){var t=this._canShowIt(this.element),s=this.element.taskType;!this._checkIsFirstTask(this.element)||"user"!==s&&"service"!==s||(t.output=!1),this._changeVisibility(this._taskInputMsgRefExp.wrapper,e&&t.input),this._changeVisibility(this._taskOutputMsgRefExp.wrapper,e&&t.output),e||(this._changeVisibility(this._taskInputMsgRefExp.wrapper,!1),this._changeVisibility(this._taskOutputMsgRefExp.wrapper,!1),this._taskInputMsgRefExp.isExpand&&this._taskInputMsgRefExp.expand(),this._taskOutputMsgRefExp.isExpand&&this._taskOutputMsgRefExp.expand())}}_onExpandOutputMsgRefExp(){}_onAddWebServiceIntoList(){var e=this._taskOutputWebServiceSearch.selectedItem;if(e&&this.element){0===(this.element.outputMessageRef||[]).length&&this.element.createDefaultBPMNAutoComplete(),this._taskOutputWSBindingType.disabled=!1;var t={id:this._getMaxId(this.element.outputMessageRef)+1,eventId:10,name:"ONCOMPLETE",busClaId:parseInt(e.id,10),busClaName:e.name,order:this.element.outputMessageRef.length,WS:!0};this.element.addWebServiceOutputMsgRef(t),this._taskOutputMsgRefWSList.arrayList.data=this._getOutputWebServicesList(this.element),this._taskOutputMsgRefWSList.refreshList(),this._taskOutputMsgRefWSList._scrollToRow(t,()=>this._onSelectWebServiceIntoList(t)),this._taskOutputMsgRefExp.showValue(this._outputMessageRefShowValue(this.element))}}_disabledOutputAttrType(e){var t=this._wrapOutputBindingAttrType.querySelectorAll("input[type=radio]");t&&t.forEach(t=>{t.disabled=e})}_onEditWebServiceIntoList(e){var t=this;return si((function*(){var s=t._taskOutputMsgRefWSList.rowEditableSelected;if(t._taskOutputWebServiceSearch.selectedItem=e&&s?{id:s.busClaId,name:s.busClaName}:void 0,e)t._taskOutputMsgRefBindingList.arrayList.data=[],t._cleanAndHideAllOutputBindingsCmp(),t._taskOutputMsgRefBindingList.unSelectAll(),t._taskOutputMsgRefBindingList.disabled=!0,t._taskOutputWSBindingType.disabled=!0;else{t._taskOutputMsgRefBindingList.disabled=!1;var i=t._taskOutputMsgRefWSList.rowSelected;if(i){var a=yield t._getBindings(i.busClaId);t._taskOutputMsgRefBindingList.arrayListData=a}t._taskOutputMsgRefBindingList.refreshList()}t._taskOutputMsgRefExp.showValue(t._outputMessageRefShowValue(t.element))}))()}_onSelectOutputWebServiceSearch(e){var t=this;return si((function*(){var s,i=t._taskOutputMsgRefWSList.editStatus;if(e&&i&&t.element){var a=t._taskOutputMsgRefWSList.rowEditableSelected,n=t.element.outputMessageRef||[],r=t.element.objectIndex(a,n,"id");if(s=ai({},a),-1!==r){s.busClaId=parseInt(e.id,10),s.busClaName=e.name,s.bindings=[],t.element.editWebServiceOutputMsgRef(r,s),t._taskOutputMsgRefWSList.arrayList.data=t._getOutputWebServicesList(t.element);var o=yield t._getBindings(s.busClaId);o.forEach(e=>(e.binding="None",e)),t._taskOutputMsgRefBindingList.arrayListData=o,t._taskOutputMsgRefBindingList.refreshList(),t._taskOutputMsgRefWSList.refreshList()}}}))()}_onSelectWebServiceIntoList(e){var t=this;return si((function*(){if(e){if(e!==t.wsSelected){t._taskOutputWSBindingType.disabled=!0,t.wsSelected=e;var s=yield t._getBindings(t.wsSelected.busClaId);t._taskOutputMsgRefBindingList.arrayListData=s,t.taskOutputWSBindingType="none",t._cleanAndHideAllOutputBindingsCmp()}var i="<b>Web Service:</b> ".concat(e.busClaName,"<br>");t.toastMessage.showMessage(ai(ai({},t.OPTIONS_TOAST),{},{message:i}))}}))()}_cleanAndHideAllOutputBindingsCmp(){this.taskOutputWSBindingType="none",this.taskOutputWSBindingValue="",this._wrapOutputBindingAttrType.querySelector("#binding_attr_type_entity").checked=!0,this._changeVisibility(this.wrapOutputWSBindingValue,!1),this._changeVisibility(this._wrapOutputBindingAttrType,!1),this._changeVisibility(this._taskOutputBindingAttrSearch.wrapper,!1)}_onSelectOutputWsBindingsList(e){if(this._cleanAndHideAllOutputBindingsCmp(),e&&this.element&&this._wsSelected){var t=(this._wsSelected.bindings||[]).find(t=>parseInt(e.id,10)===parseInt(t.busClaParId,10));if(this._taskOutputWSBindingType.disabled=!1,t&&"None"!==e.binding){var s=t.busClaParBndType;if("V"===s)this.taskOutputWSBindingType="value",this._taskOutputWSBindingValue.disabled=!1,this._changeVisibility(this.wrapOutputWSBindingValue,!0),this.taskOutputWSBindingValue=t.busClaParBndValue||"";else{this.taskOutputWSBindingType="attribute",this._taskOutputBindingAttrSearch.selectedItem=t.attId&&-1!==t.attId?{id:t.attId,name:t.attTooltip||t.attName}:void 0;var i="P"===s?"process":"entity",a=this._wrapOutputBindingAttrType.querySelector("#binding_attr_type_".concat(i));a&&(a.checked=!0),this._changeVisibility(this._taskOutputBindingAttrSearch.wrapper,!0),this._changeVisibility(this._wrapOutputBindingAttrType,!0)}}var n="\n        <b>Parameter:</b> ".concat(e.param,"<br>\n        <b>Type:</b> ").concat(this.PARAMETER_TYPE[e.type],"<br>\n        <b>In/Out:</b> ").concat(e.inout,"\n        ");this.toastMessage.showMessage(ai(ai({},this.OPTIONS_TOAST),{},{message:n}))}}createNewWebServiceBinding(e,t){var s={busClaParId:parseInt(e.id,10),busClaParType:e.type,busClaParName:e.param,busClaParBndType:""};this.element.addBindingWebServiceOutputMsgRef(t,s)}_onTaskWsAttributeTypeChanged(){var e,t=this.taskOutputWSBindingType.toUpperCase(),s=this._taskOutputMsgRefBindingList.rowSelected,i=this._wsSelected.bindings||[],a=this.element.objectIndex(this._wsSelected,"outputMessageRef"),n=i.findIndex(e=>parseInt(e.busClaParId,10)===parseInt(s.id,10));-1===n&&"NONE"!==t&&(this.createNewWebServiceBinding(s,a),n=this.element.outputMessageRef[a].bindings.length-1);var r=this._wsSelected.bindings[n],o=s.binding.toUpperCase()!==t;o&&(this._taskOutputBindingAttrSearch.selectedItem=void 0,this.taskOutputWSBindingValue="",this._fillBindingsParameters(this._wsSelected.busClaId)),"VALUE"===t&&o&&(this._setFieldValueEachType(s,this._taskOutputWSBindingValue),e="V",this.element.setWebServicePropertyOutputMsgRef(a,n,"busClaParBndType",e),this.taskOutputWSBindingValue="",this._changeVisibility(this.wrapOutputWSBindingValue,!0),this._taskOutputBindingAttrSearch.selectedItem=void 0,this._changeVisibility(this._wrapOutputBindingAttrType,!1),this._changeVisibility(this._taskOutputBindingAttrSearch.wrapper,!1),(r.attId||r.attTooltip||r.attName)&&this.element.deleteAttributeWebServicesProperties(a,n)),"ATTRIBUTE"===t&&o&&(this._setUrlAttributeSearch(this._taskOutputBindingAttrSearch,s.type),e=this.ouputWsAttributeTypeChecked.value.toUpperCase(),this.element.setWebServicePropertyOutputMsgRef(a,n,"busClaParBndType",e),this._taskOutputBindingAttrSearch.selectedItem=void 0,this._changeVisibility(this._wrapOutputBindingAttrType,!0),this._changeVisibility(this._taskOutputBindingAttrSearch.wrapper,!0),this.taskOutputWSBindingValue="",this._changeVisibility(this.wrapOutputWSBindingValue,!1),r.busClaParBndValue&&this.element.deleteValueWebServiceProperty(a,n)),"NONE"===t&&-1!==n&&(this._cleanAndHideAllOutputBindingsCmp(),this.element.deleteBindingWebServiceOutputMsgRef(a,n),this._fillBindingsParameters(this._wsSelected.busClaId))}_fillBindingsParameters(e){this._getBindings(e).then(e=>{this._taskOutputMsgRefBindingList.arrayList.data=e,this._taskOutputMsgRefBindingList.refreshList()})}_setUrlAttributeSearch(e,t){"Production"===A.ENV&&(e.url="".concat(A.DEFAULT_ATTRS_URL,"&attType=").concat(t,"&name="))}_onWebServiceBindingAttrTypeChanged(){var e=this._taskOutputMsgRefBindingList.rowSelected,t=this._wsSelected.bindings||[],s=this.element.objectIndex(this._wsSelected,this.element.outputMessageRef),i=t.findIndex(t=>parseInt(e.id,10)===parseInt(t.busClaParId,10));if(-1!==s&&-1!==i){var a=this.ouputWsAttributeTypeChecked.value;this.element.setWebServicePropertyOutputMsgRef(s,i,"busClaParBndType",a)}}_onWebServiceBindingAttributeChanged(e){var t=this._taskOutputMsgRefBindingList.rowSelected,s=this._wsSelected.bindings||[],i=this.element.objectIndex(this._wsSelected,this.element.outputMessageRef),a=s.findIndex(e=>parseInt(t.id,10)===parseInt(e.busClaParId,10));if(-1!==i&&-1!==a&&e){var n=[parseInt(e.id,10),e.name,e.label];this.element.setWebServicePropertyOutputMsgRef(i,a,["attId","attTooltip","attName"],n),this._fillBindingsParameters(this._wsSelected.busClaId)}}_onWebServiceBindingValueChanged(){var e=this.taskOutputWSBindingValue,t=this._taskOutputMsgRefBindingList.rowSelected,s=this._wsSelected.bindings||[],i=this.element.objectIndex(this._wsSelected,this.element.outputMessageRef),a=s.findIndex(e=>parseInt(t.id,10)===parseInt(e.busClaParId,10)),n=Ys(this._taskOutputWSBindingValue);-1!==i&&-1!==a&&n&&(this._fillValidBindingValue(s[a].busClaParBndValue),this.element.setWebServicePropertyOutputMsgRef(i,a,"busClaParBndValue",e),this._fillBindingsParameters(this._wsSelected.busClaId))}_fillValidBindingValue(e=""){"number"===this._taskOutputWSBindingValue.type&&""===this.taskOutputWSBindingValue&&(this.taskOutputWSBindingValue=e)}_onDeleteWebServiceOutputMsgRefList(e){var t=this.element.objectIndex(e,this.element.outputMessageRef);-1!==t&&(this.element.deleteWebServiceOutputMsgRef(t),this._taskOutputMsgRefWSList.arrayList.data=this._getOutputWebServicesList(this.element),this._taskOutputMsgRefWSList.refreshList(),1===this.element.outputMessageRef.length&&(this.element.outputMessageRef=[]),this._wsSelected&&e&&(!(parseInt(this._wsSelected.id,10)===parseInt(e.id,10))&&this.element.outputMessageRef||(this.wsSelected=null,this._taskOutputMsgRefBindingList.arrayListData=[],this._cleanAndHideAllOutputBindingsCmp())))}_onDeleteAllWebServiceOutputMsgRefList(){this.element&&(this.element.cleanWebServicesOutputMsgRef(),this.wsSelected=null,this._taskOutputMsgRefBindingList.arrayListData=[],this._cleanAndHideAllOutputBindingsCmp())}_getOutgoingConnectors(e){return ze(A.CONNECTOR,this.editor.elements).filter(t=>t.type===A.CONNECTOR_TYPE_TRANSITION&&t.from===e.id)}_getOutgoingElements(e,t){var s=[];return e.forEach(e=>{var i=He(e.to,this.editor.elements);t.find(e=>i.id===e)||s.push(i)}),s}_getLocalScheduleTasks(){var e=ri(De(this.editor.elements),1)[0],t=this._getNextTasks(e,[],[],e.id),s=[];return t.forEach(e=>{var t=e.taskId,i=e.name;s.push({id:t,name:i})}),s}_getNextTasks(e,t,s,i){var a=this._getOutgoingConnectors(e),n=this._getOutgoingElements(a,s);return e.elementType===A.TASK&&e.id!==i&&t.push(e.properties),n.length>0&&(s.push(e.id),n.forEach(e=>this._getNextTasks(e,t,s))),t}_setFieldValueEachType(e,t){if(e){var s=e.type;switch(s){case"N":t.setAttribute("type","number");break;case"D":t.setAttribute("type","date");break;default:t.setAttribute("type","text")}this._toggleNumberFieldAttributes("N"===s,t)}}_toggleNumberFieldAttributes(e,t){var s=t.hasAttribute("min"),i=t.hasAttribute("step");!e||s||i?(t.removeAttribute("min"),t.removeAttribute("step")):(t.setAttribute("min","0"),t.setAttribute("step","1"))}}class li extends Fs{constructor(e){super(e,"gateway"),this._init()}_init(){this._typeSelect=this._panel.querySelector("#gateway_type_select"),this._nameInput=this._panel.querySelector("#gateway_name_input"),this._typeSelect.addEventListener("input",()=>{this._onTypeSelectChanged()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onNameInputChanged()},this._nameInput,"input")}get typeSelect(){return this._typeSelect.value}get nameInput(){return this._nameInput.value}set typeSelect(e){this._typeSelect.value=e}set nameInput(e){this._nameInput.value=e}show(e){this.typeSelect=e.type,this.nameInput=e.name,this.documentationInput=e.documentation,this._changeVisibility(this._panel,!0),e.on("delete_exclusive",()=>{e.deleteAllExecutionOrderConnector(this.editor.elements)}),e.on("change_parallel_event",()=>{e.changeAllConnectorsKind(this.editor.elements)})}_onTypeSelectChanged(){this.element&&(this.element.type.toUpperCase()!==this.typeSelect.toUpperCase()&&(this.element.type=this.typeSelect))}_onNameInputChanged(){if(this.element){var e=this.element.elementType===A.GATEWAY?this.element.name:void 0;this.nameInput=Hs(this.nameInput,/["]/g),e!==this.nameInput&&this.element.elementType===A.GATEWAY&&(this.element.name=this.nameInput)}}_onDocumentationInputChanged(){this.documentationInput=Hs(this.documentationInput),super._onDocumentationInputChanged()}}class hi extends li{constructor(e){super(e),this._init()}_init(){super._init(),this._executionType=this._panel.querySelector("#gateway_execution"),this.wrapExecutionType=this._executionType.parentNode.parentNode,this._executionType.addEventListener("input",()=>{this._onExecutionTypeChanged()})}get executionType(){return this._executionType.value}set executionType(e){this._executionType.value=e}show(e){super.show(e),this._showExecution(e)}_showExecution(e){var t=e.executionType,s=e.type;this.executionType=t||"manual";var i="EXCLUSIVE"===s.toUpperCase()||"INCLUSIVE"===s.toUpperCase();this._changeVisibility(this.wrapExecutionType,i)}_onTypeSelectChanged(){super._onTypeSelectChanged();var e=this.typeSelect.toUpperCase(),t="EXCLUSIVE"===e||"INCLUSIVE"===e;this._changeVisibility(this.wrapExecutionType,t)}_onExecutionTypeChanged(){if(this.element){var e=this.element.executionType,t=this.executionType;e!==t&&(this.element.executionType=t)}}}class ci extends Fs{constructor(e){super(e,"group"),this._init()}_init(){this._nameInput=this._panel.querySelector("#group_name_input"),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onNameInputChanged()},this._nameInput,"input")}get nameInput(){return this._nameInput.value}set nameInput(e){this._nameInput.value=e}show(e){this.nameInput=e.name,this.documentationInput=e.documentation,this._changeVisibility(this._panel,!0)}_onNameInputChanged(){if(this.element){var e=this.element.elementType===A.GROUP?this.element.name:void 0;this.nameInput=Hs(this.nameInput,/["]/g),e!==this.nameInput&&(this.element.name=this.nameInput)}}}class pi extends Fs{constructor(e){super(e,"text"),this._textInput=this._panel.querySelector("#text_text_input"),this._setTimeoutOnPropertyChanged(void 0,()=>this._onTextInput(),this._textInput,"input",100)}get textInput(){return this._textInput.value}set textInput(e){this._textInput.value=e}show(e){this.textInput=e.text,this.documentationInput=e.documentation,this._changeVisibility(this._panel,!0)}_onTextInput(){if(this.element){var e=this.element.text;this.textInput=Hs(this.textInput,/["]/g),e!==this.textInput&&(this.element.text=this.textInput)}}}class di extends Fs{constructor(e){super(e,"pool_lane"),this._init()}_init(){this._nameInput=this._panel.querySelector("#pool_lane_name_input"),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onNameInputChanged()},this._nameInput,"input",100)}get nameInput(){return this._nameInput.value}set nameInput(e){this._nameInput.value=e}show(e){this.nameInput=e.name,this.documentationInput=e.documentation,this._changeVisibility(this._panel,!0)}_onNameInputChanged(){if(this.element){var e=this.element,t=e.elementType,s=e.name,i=t===A.POOL||t===A.LANE,a=i?s:void 0;this.nameInput=Hs(this.nameInput,/["]/g),a!==this.nameInput&&i&&(this.element.name=this.nameInput)}}}function ui(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function _i(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ui(Object(s),!0).forEach((function(t){mi(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ui(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function mi(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function gi(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function vi(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){gi(n,i,a,r,o,"next",e)}function o(e){gi(n,i,a,r,o,"throw",e)}r(void 0)}))}}function bi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class Ti extends Fs{constructor(e){super(e,"event"),this._init(),this._initMessageComponents(),this._initTimerComponents(),this._initEventOfComponents()}_init(){this.EVENT_PANEL={MESSAGE:{nameId:"event_message",label:M.a.t("eventPropsPanel.txtProDesEventPanelMessageLabel"),expandId:"expand_message_zone"},MSG_ATTR_SEARCH:{nameId:"event_message_attrs",label:M.a.t("eventPropsPanel.txtProDesEventPanelAttributeSearchLabel"),add:!0,url:A.EVT_MSG_ATTRS_URL,hasLabel:!0,canReload:!0},MSG_ATTRS_LIST:{nameId:"event_message_attrs_list",label:M.a.t("eventPropsPanel.txtProDesEventPanelAttributeListLabel"),add:!0},MSG_WS_SEARCH:{nameId:"event_message_webservice",label:M.a.t("eventPropsPanel.txtProDesEventPanelWSSearchLabel"),add:!1,url:A.EVT_MSG_WS_URL,hasLabel:!1,canReload:!0},MSG_WS_LIST:{nameId:"event_message_webservices_list",label:M.a.t("eventPropsPanel.txtProDesEventPanelWSListLabel"),add:!0},MSG_BINDINGS_LIST:{nameId:"event_message_bindings_list",label:M.a.t("eventPropsPanel.txtProDesEventPanelBindingListLabel"),add:!1},MSG_WS_ATTR_SEARCH:{nameId:"event_message_ws_attribute",label:M.a.t("eventPropsPanel.txtProDesEventPanelWSAttributeSearchLabel"),add:!1,url:A.EVT_MSG_WS_ATTR_URL,baseUrl:A.EVT_MSG_WS_ATTR_URL,hasLabel:!0,canReload:!0},TIMER:{nameId:"event_timer",label:M.a.t("eventPropsPanel.txtProDesEventPanelTimerLabel"),expandId:"expand_timer_zone"},TIMER_ATTRIBUTE_SEARCH:{nameId:"event_timer_attribute",label:M.a.t("eventPropsPanel.txtProDesEventPanelTimerAttributeSearchLabel"),add:!1,url:A.EVT_TIMER_ATTR_URL,hasLabel:!0,canReload:!0},TIMER_START_DATE:{nameId:"event_timer_start_date",label:M.a.t("eventPropsPanel.txtProDesEventPanelTimerStartDateLabel")},TIMER_END_DATE:{nameId:"event_timer_end_date",label:M.a.t("eventPropsPanel.txtProDesEventPanelTimerStartDateLabel")}},this.OPTIONS_TOAST={type:"info",title:M.a.t("eventPropsPanel.txtProDesEventPanelToastTitleInformation"),duration:3e3,position:"bottom-left"},this._eventNameType=this._panel.querySelector("#event_name_type"),this._detailTypeSelect=this._panel.querySelector("#event_detail_type_select"),this._nameInput=this._panel.querySelector("#event_name_input"),this._eventMsgCatchThrow=this._panel.querySelector("#event_message_catch_throw"),this._eventMsgWebServiceInput=this._panel.querySelector("#event_message_webservice_input"),this._eventMsgAttributesType=this._panel.querySelector("#event_message_attr_type"),this._eventMsgBindingType=this._panel.querySelector("#event_message_binding_type"),this._eventMsgBindingValue=this._panel.querySelector("#event_message_binding_value"),this._eventTimerType=this._panel.querySelector("#event_timer_type_select"),this._eventTimerStartDate=this._panel.querySelector("#event_timer_start_date"),this._eventTimerEndDate=this._panel.querySelector("#event_timer_end_date"),this._eventTimerUnit=this._panel.querySelector("#event_timer_unit"),this._eventTimerValue=this._panel.querySelector("#event_timer_value"),this._eventTimerAttrType=this._panel.querySelector("#event_timer_attribute_type"),this.wrapDetailTypeSelect=this._detailTypeSelect.parentNode.parentNode,this.wrapMsgCatchThrow=this._eventMsgCatchThrow.parentNode.parentNode,this.wrapAttrsType=this._eventMsgAttributesType.parentNode.parentNode,this.wrapWebserviceInput=this._eventMsgWebServiceInput.parentNode.parentNode,this.wrapBindingType=this._eventMsgBindingType.parentNode.parentNode,this.wrapBindingValue=this._eventMsgBindingValue.parentNode.parentNode,this.wrapBindingAttrType=this._panel.querySelector("#wrapper_event_message_binding_attr_type"),this.wrapTimerAttrType=this._eventTimerAttrType.parentNode.parentNode,this._detailTypeSelect.addEventListener("input",()=>{this._onDetailTypeSelectChanged()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onNameInputChanged()},this._nameInput,"input",500),this._eventTimerType.addEventListener("input",()=>{this._onTimerTypeChanged()})}get nameInput(){return this._nameInput.value}get detailTypeSelect(){return this._detailTypeSelect.value.toLowerCase()}set nameInput(e){this._nameInput.value=e}set detailTypeSelect(e){this._detailTypeSelect.value=e}set eventNameType(e){this._eventNameType.value=e}get eventTimerType(){return this._eventTimerType.value}set eventTimerType(e){this._eventTimerType.value=e}get eventTimerStartDate(){return this._eventTimerStartDate.date}set eventTimerStartDate(e){this._eventTimerStartDate.date=e}get eventTimerEndDate(){return this._eventTimerEndDate.date}set eventTimerEndDate(e){this._eventTimerEndDate.date=e}get eventTimerUnit(){return this._eventTimerUnit.value}set eventTimerUnit(e){this._eventTimerUnit.value=e}get eventTimerValue(){var e=this._eventTimerValue.value;return""!==e?parseInt(e,10):e}set eventTimerValue(e){this._eventTimerValue.value=e}get eventTimerAttribute(){return this._eventTimerAttributeSearch.valueEl}set eventTimerAttribute(e){this._eventTimerAttributeSearch.selectedItem=e}set eventTimerAttrType(e){this._eventTimerAttrType.value=e}get eventTimerAttrType(){return this._eventTimerAttrType.value}get eventMsgWebServiceInput(){return this._eventMsgWebServiceInput.value}set eventMsgWebServiceInput(e){this._eventMsgWebServiceInput.value=e}set eventMsgAttributeSearch(e){this._eventMsgAttributeSearch.valueEl=e}get eventMsgAttributeSearch(){return this._eventMsgAttributeSearch.valueEl}get eventMsgAttributeType(){return this._eventMsgAttributesType.value}set eventMsgAttributeType(e){this._eventMsgAttributesType.value=e}get eventMsgCatchThrow(){return this._eventMsgCatchThrow.value}set eventMsgCatchThrow(e){this._eventMsgCatchThrow.value=e}set eventMsgWebServiceSearch(e){this._eventMsgWebServiceSearch.valueEl=e}get eventMsgWebServiceSearch(){return this._eventMsgWebServiceSearch.valueEl}get eventMsgBindingType(){return this._eventMsgBindingType.value}set eventMsgBindingType(e){this._eventMsgBindingType.value=e}get eventMsgBindingValue(){return this._eventMsgBindingValue.value}set eventMsgBindingValue(e){this._eventMsgBindingValue.value=e}set eventMsgWSAttributeSearch(e){this._eventMsgWSAttributeSearch.valueEl=e}get bindingAttrTypes(){return this.wrapBindingAttrType.querySelectorAll("input[type=radio]")}get bindingAttrTypeChecked(){return this.wrapBindingAttrType.querySelector("input[type=radio]:checked").value}set bindingAttrTypeToCheck(e){this.wrapBindingAttrType.querySelector("#binding_attr_type_".concat(e)).checked=!0}get wsSelected(){return this._wsSelected}set wsSelected(e){this._wsSelected=e}_initTimerComponents(){var e=this.EVENT_PANEL,t=e.TIMER,s=e.TIMER_ATTRIBUTE_SEARCH,i=this.EVENT_PANEL,a=i.TIMER_START_DATE,n=i.TIMER_END_DATE;this._eventTimerExp=this._includeComponent("expander",this.wrapTimer,this._eventMessageExp.expandZone,"afterend",t),this._eventTimerAttributeSearch=this._includeComponent("dropdown",this.wrapEvtTimerAttrSearch,this.wrapTimerAttrType,"beforebegin",s);var r=this._getTimerGroup("date");this._eventTimerStartDate=this._includeComponent("date",this.wrapStartDate,r,"inner",a),this._eventTimerEndDate=this._includeComponent("date",this.wrapEndDate,r,"inner",n)}_initMessageComponents(){var e=this.EVENT_PANEL,t=e.MESSAGE,s=e.MSG_ATTR_SEARCH,i=e.MSG_ATTRS_LIST,a=this.EVENT_PANEL,n=a.MSG_WS_SEARCH,r=a.MSG_WS_LIST,o=a.MSG_BINDINGS_LIST,l=a.MSG_WS_ATTR_SEARCH;i.arrayList=this._createMessageAttributesArrayList(),r.arrayList=this._createMessageWebServicesArrayList(),o.arrayList=this._createMessageBindingsArrayList();var h="Production"===A.ENV;s.add=h,this._eventMessageExp=this._includeComponent("expander",this.wrapMessage,this.wrapDetailTypeSelect,"afterend",t),this._eventMsgAttributeSearch=this._includeComponent("dropdown",this.wrapEvtMsgAttrSearch,this.wrapWebserviceInput,"afterend",s),this._eventMsgAttributesList=this._includeComponent("list",this.wrapEvtMsgAttrsList,this.wrapAttrsType,"afterend",i),this._eventMsgWebServiceSearch=this._includeComponent("dropdown",this.wrapEvtMsgWSSearch,this._eventMsgAttributesList.wrapper,"afterend",n),this._eventMsgWebServicesList=this._includeComponent("list",this.wrapEvtMsgWSList,this._eventMsgWebServiceSearch.wrapper,"afterend",r),this._eventMsgWSBindingsList=this._includeComponent("list",this.wrapEvtMsgWSBindingsList,this.wrapBindingType,"beforebegin",o),this._eventMsgWSAttributeSearch=this._includeComponent("dropdown",this.wrapEvtMsgWSAttrSearch,this.wrapBindingAttrType,"afterend",l),this._wsSelected=null,this._eventMsgAttributeSearch.toggleDisabledButton(!0)}_initEventOfComponents(){this._eventTimerStartDate.on("change_date",e=>{this._onEventTimerDateChanged(e,"start")}),this._eventTimerEndDate.on("change_date",e=>{this._onEventTimerDateChanged(e,"end")}),this._eventTimerUnit.addEventListener("input",()=>{this._onEventTimerFrequencyChanged()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onValidateFrequencyValue(),this._onEventTimerFrequencyChanged()},this._eventTimerValue,"input",100),this._eventTimerAttrType.addEventListener("input",()=>{this._onEventTimerAttributeChanged()}),this._eventTimerAttributeSearch.on("select_item",()=>{this._onEventTimerAttributeChanged()}),this._eventMessageExp.on("expand",()=>{this._onEventMessageExpand()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onEventMessageWebServiceChanged()},this._eventMsgWebServiceInput,"input"),this._eventMsgAttributeSearch.on("add_item",()=>{this._onAddNewMessageAttribute()}),this._eventMsgAttributeSearch.on("select_item",e=>{this._onSelectToEditEventMsgAttributeSeacrh(e)}),this._eventMsgAttributesList.on("delete_item",e=>{this._onDeleteEventMsgAttributesList(e)}),this._eventMsgAttributesList.on("delete_all_items",()=>{this._onDeleteAllEventMsgAttributesList()}),this._eventMsgAttributesList.on("add_item",()=>{this._onAddEventMessageAttribute()}),this._eventMsgAttributesList.on("selected_item",e=>{this._onSelectEventMsgAttributesList(e)}),this._eventMsgAttributesList.on("edit_item",e=>{this._onEditEventMsgAttributesList(e)}),this._eventMsgAttributesList.on("checked_item",e=>{this._onCheckedEventMsgAttributesList(e)}),this._eventMsgAttributesType.addEventListener("input",()=>{this._onEventMsgAttributesTypeChanged()}),this._eventMsgCatchThrow.addEventListener("input",()=>{this._onEventMsgCatchThrowChanged()}),this._eventMsgWebServicesList.on("add_item",()=>{this._onAddEventMsgWebServicesList()}),this._eventMsgWebServicesList.on("selected_item",e=>{this._onSelectMsgWebServicesList(e)}),this._eventMsgWebServicesList.on("edit_item",e=>{this._onEditMsgWebServicesList(e)}),this._eventMsgWebServicesList.on("delete_item",e=>{this._onDeleteEventMsgWebServicesList(e)}),this._eventMsgWebServicesList.on("delete_all_items",()=>{this._onDeleteAllEventMsgWebServices()}),this._eventMsgWebServiceSearch.on("select_item",e=>{this._onSelectToEditEventMsgWebServiceSearch(e)}),this._eventMsgWSBindingsList.on("selected_item",e=>{this._onSelectEventMsgWSBindings(e)}),this._eventMsgBindingType.addEventListener("input",()=>{this._onEventMsgWSBindingTypeChanged()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onEventMsgWSBindingValueChanged()},this._eventMsgBindingValue,"input"),this.bindingAttrTypes.forEach(e=>{e.addEventListener("click",()=>{this._onEventMsgWSBindingAttributeChanged("attrType")})}),this._eventMsgWSAttributeSearch.on("select_item",e=>{this._onEventMsgWSBindingAttributeChanged("attribute",e)})}_setDetailTypeSelect(e){var t=["None","Message","Signal","Timer"];if(this._cleanTypeSelect(),e.elementType===A.END_EVENT&&(t.pop(),t=t.concat(["Terminate","Error"])),e.elementType===A.INTERMEDIATE_EVENT&&e.isAttached){t.shift(),t=[...t,"Multiple","Error"];var s=this.editor.elements.find(t=>t.elementType===A.TASK&&t.id===e.target);if(s){var i=s.taskType;"receive"!==i&&"send"!==i&&"service"!==i&&"script"!==i||t.shift()}}t.forEach(e=>this._createOptionElement(e))}_getTypeToShow(e){var t=bi(e.elementType.split("Event"),1)[0];return"".concat(t.toUpperCase()," ").concat(M.a.t("eventPropsPanel.txtProDesEventPanelTypeToShow"))}show(e){this._setDetailTypeSelect(e),this.eventNameType=this._getTypeToShow(e),this.detailTypeSelect=e.eventType,this.nameInput=e.eventName,this.documentationInput=e.documentation,this._showTimerComponentsAccordingToType(e),this._showMessageComponentsAccordingToType(e),this._changeVisibility(this._panel,!0)}_getDateObject(e){return{date:{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()},time:{hour:e.getHours(),minutes:e.getMinutes()}}}_showTimerComponentsAccordingToType(e){var t=e.elementType!==A.INTERMEDIATE_EVENT,s=this._getTimerShowValue(e);if(this._changeVisibility(this._eventTimerExp.wrapper,"timer"===e.eventType||"multiple"===e.eventType),this._changeVisibility(this._eventTimerEndDate.wrapper,t),this._eventTimerExp.showValue(s),this._eventTimerExp.isExpand&&"timer"!==e.eventType&&this._eventTimerExp.expand(),this._cleanTimerDateComponents(),this._cleanTimerFrequencyComponents(),this._cleanTimerAttributeComponents(),"timer"===e.eventType&&e.timer){var i=e.dateTimer||{};i&&(this.eventTimerType="date"),i.start&&(this.eventTimerStartDate=this._getDateObject(i.start)),i.end&&(this.eventTimerEndDate=this._getDateObject(i.end));var a=e.frequencyTimer;a&&(this.eventTimerUnit=a.unit,this.eventTimerValue=a.value,this.eventTimerType="frequency");var n=e.attributeTimer;if(n){this.eventTimerType="attribute",this.eventTimerAttrType=n.type;var r=n.id,o=n.name;this.eventTimerAttribute={id:r,name:o}}this._onTimerTypeChanged()}this._changeVisibility(this._eventMessageExp.wrapper,"message"===e.eventType||"multiple"===e.eventType)}_showMessageComponentsAccordingToType(e){var t=e.elementType,s=e.eventType,i=t===A.START_EVENT,a=t===A.INTERMEDIATE_EVENT,n=t===A.END_EVENT,r="message"===s||"multiple"===s,o="throw"===e.catchThrowMessage,l=a&&o,h=this._getMessageShowValue(e);this._toggleEventMessageComponents(e),!r&&this._eventMessageExp.isExpand&&this._eventMessageExp.expand(),this._eventMessageExp.showValue(h),r&&(i||a&&!l)&&this._fillStartOrItermEventMessageComponents(e,a),r&&(n||l)&&this._fillEndEventMessageComponents(e)}_cleanStartItermEventMessageCmp(){this.eventMsgCatchThrow="catch",this.eventMsgWebServiceInput="",this.eventMsgAttributeType="entity",this._eventMsgAttributeSearch.selectedItem=void 0,this._eventMsgAttributesList.arrayListData=[]}_cleanEndEventMessageCmp(){this._eventMsgWebServiceSearch.selectedItem=void 0,this._eventMsgWebServicesList.arrayListData=[],this._eventMsgWSBindingsList.arrayListData=[],this.eventMsgBindingType="none",this._eventMsgBindingType.disabled=!0,this.eventMsgBindingValue="",this._eventMsgWSAttributeSearch.selectedItem=void 0,this.bindingAttrTypeToCheck="entity",this.wsSelected=null}_fillStartOrItermEventMessageComponents(e,t){this._cleanStartItermEventMessageCmp();var s=this.eventMsgAttributeType;t&&(this.eventMsgCatchThrow=e.catchThrowMessage||"catch"),this.eventMsgWebServiceInput=e.webServiceMessage||"",this._eventMsgAttributesList.editStatus&&(this._eventMsgAttributesList.editStatus=!1),this._eventMsgAttributesList.arrayListData="process"===s?e.processAttributesMessage||[]:e.entityAttributesMessage||[]}_fillEndEventMessageComponents(e){this._cleanEndEventMessageCmp();var t=this._getFilteredWebServicesArray(e.webServices||[]);this._eventMsgWebServicesList.arrayListData=t,this._eventMsgWSBindingsList.arrayListData=[],this.eventMsgCatchThrow=e.catchThrowMessage||"throw",this._eventMsgWebServicesList.editStatus&&(this._eventMsgWebServicesList.editStatus=!1)}_getFilteredWebServicesArray(e){var t=[];return this.element.webServices&&(t=e.filter(e=>"BPMNAutoComplete"!==e.busClaName)),t}_getBindings(e){var t=this;return vi((function*(){var s=[],i=A.EVT_MSG_WS_BINDINGS_URL;"Development"!==A.ENV&&(i="".concat(i).concat(e));try{var a=yield he.a.get(i);a&&a.data.toUpperCase().indexOf("HTML")>-1&&t.showInvalidSession(),s=(new as).convertToJson(a.data)}catch(e){throw Error("".concat(M.a.t("eventPropsPanel.txtProDesEventPanelErrorObtainParameter")," \n").concat(e))}return tt(t._customBindingsParameters(s))}))()}_getTimerShowValue(e){var t=[];return e.timer&&(e.dateTimer&&t.push("DATE"),e.frequencyTimer&&t.push("FREQUENCY"),e.attributeTimer&&t.push("ATTRIBUTE")),t}_updateMessageExpValue(e){var t=this._getMessageShowValue(e);this._eventMessageExp.showValue(t)}_customBindingsParameters(e=[]){if(this.wsSelected){var t=st(this.wsSelected.bindings||[],"busClaParId");return e.map(e=>{var s=t[e.id];return _i(_i({},e),{},{binding:s?this._getEspecificationBinding(s):"None"})})}return e}_getEspecificationBinding(e){var t="V"===e.busClaParBndType&&""!==e.busClaParBndValue,s="P"===e.busClaParBndType,i="E"===e.busClaParBndType,a=(s||i)&&-1!==e.attId&&e.attId;return t?"Value":a?"Attribute":"None"}_getMessageShowValue(e){var t=[],s=e.elementType,i=s===A.START_EVENT,a=s===A.INTERMEDIATE_EVENT,n=s===A.END_EVENT,r="throw"===e.catchThrowMessage,o=a&&r;if(e.message&&(i||a&&!o)&&!n&&t.push(e.webServiceMessage||""),e.message&&(n||o)&&!i&&e.webServices){e.webServices.forEach(e=>{"BPMNAutoComplete"!==e.busClaName&&t.push(e.busClaName)})}return t}_getTimerGroup(e){return this._eventTimerExp.expandZone.querySelector("#wrapper_timer_".concat(e))}_getActiveTimerGroup(){return this._eventTimerExp.expandZone.querySelector(".timer_group[data-visible=true]")}_toggleEventMessageComponents(e){this._cleanEndEventMessageCmp(),this._cleanAndHideBindingsComponents();var t=e.elementType===A.START_EVENT,s=e.elementType===A.INTERMEDIATE_EVENT,i=e.elementType===A.END_EVENT,a=e.catchThrowMessage||"catch",n=t||s&&"catch"===a,r=e.eventType,o=e.isAttached,l=i||s&&"throw"===a,h=s&&"multiple"!==r&&"message"===r&&!o;this._changeVisibility(this.wrapMsgCatchThrow,h),this._toggleCatchEventMessageComponents(n),this._toggleThrowEventMessageComponents(l)}_toggleCatchEventMessageComponents(e){this._changeVisibility(this.wrapWebserviceInput,e),this._changeVisibility(this.wrapAttrsType,e),this._changeVisibility(this._eventMsgAttributeSearch.wrapper,e),this._changeVisibility(this._eventMsgAttributesList.wrapper,e)}_toggleThrowEventMessageComponents(e){this._changeVisibility(this._eventMsgWebServiceSearch.wrapper,e),this._changeVisibility(this._eventMsgWebServicesList.wrapper,e),this._changeVisibility(this._eventMsgWSBindingsList.wrapper,e),this._changeVisibility(this.wrapBindingType,e),this._changeVisibility(this.wrapBindingValue,!1),this._changeVisibility(this.wrapBindingAttrType,!1),this._changeVisibility(this._eventMsgWSAttributeSearch.wrapper,!1)}_isActiveTimerGroup(e){return this._getActiveTimerGroup().id.split("wrapper_timer_")[1]===e}_onTimerTypeChanged(){var e=this.eventTimerType,t=this._getActiveTimerGroup(),s=this._getTimerGroup(e);if(this.element){var i=t.getAttribute("data-timer");i!==e&&(this._onDeleteTimerProperty(i),this._isActiveTimerGroup(e)||(this._changeVisibility(t,!1),this._changeVisibility(s,!0)))}}_getFilteredAttributesByType(e,t){var s=e.toUpperCase().charAt(0);return t.filter(e=>e.type===s)}_createMessageAttributesArrayList(){return{header:[M.a.t("eventPropsPanel.txtProDesEventPanelMsgAttributeHeaderName"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgAttributeHeaderMulti"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgAttributeHeaderUk"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgAttributeHeaderEdit"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgAttributeHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!0,data:[],notShow:["id","type"],actions:[{key:"multivalued",type:"checkbox"},{key:"uk",type:"checkbox"}]}}_createMessageWebServicesArrayList(){return{header:[M.a.t("eventPropsPanel.txtProDesEventPanelMsgWsHeaderName"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgWsHeaderEdit"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgWsHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!0,data:[],notShow:["id","eventId","busClaId","name","WS","order","bindings","haveCond","condition"],actions:[]}}_createMessageBindingsArrayList(){return{header:[M.a.t("eventPropsPanel.txtProDesEventPanelMsgBindingHeaderParameter"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgBindingHeaderType"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgBindingHeaderInOut"),M.a.t("eventPropsPanel.txtProDesEventPanelMsgBindingHeaderBinding")],deleteAction:!1,deleteActionAll:!1,editAction:!1,data:[],notShow:["id"],actions:[]}}_createOptionElement(e){var t=document.createElement("option");t.setAttribute("value",e.toLowerCase()),t.innerText=e,this._detailTypeSelect&&this._detailTypeSelect.appendChild(t)}_onDetailTypeSelectChanged(){var e=this.detailTypeSelect;if(this.element){var t=this.element.eventType;t!==e&&(this.element.webServices="message"===t&&"none"===e?this.element.webServices.filter(e=>"BPMNAutoComplete"===e.busClaName):[],this.element.deletePropertyByName(("timer"!==e||"multiple"!==e)&&"timer"),this.element.deletePropertyByName(("message"!==e||"multiple"!==e)&&"message"),this.element.type=e,this._showTimerComponentsAccordingToType(this.element),this._showMessageComponentsAccordingToType(this.element))}}_onNameInputChanged(){this.element.name=this.nameInput}_cleanTypeSelect(){var e=this._detailTypeSelect.querySelectorAll("option");0!==e.length&&e.forEach(e=>e.remove())}_cleanTimerDateComponents(){this._eventTimerStartDate.clean(),this._eventTimerEndDate.clean()}_cleanTimerFrequencyComponents(){this.eventTimerUnit="Minutes",this.eventTimerValue=""}_cleanTimerAttributeComponents(){this.eventTimerAttrType="entity",this.eventTimerAttribute=void 0}_onDeleteTimerProperty(e){if(this.element){switch((this.element.timer||{})[e]&&this.element.deleteTimerProperty(e),e.toUpperCase()){case"DATE":this._cleanTimerDateComponents();break;case"FREQUENCY":this._cleanTimerFrequencyComponents();break;case"ATTRIBUTE":this._cleanTimerAttributeComponents()}var t=this._getTimerShowValue(this.element);this._eventTimerExp.showValue(t)}}_onEventTimerDateChanged(e,t){if(e&&this.element){this.element.setDateTimerByType(e,t);var s=this._getTimerShowValue(this.element);this._eventTimerExp.showValue(s)}}_onValidateFrequencyValue(){var e=this.eventTimerValue;(e<1||isNaN(e))&&(this.eventTimerValue=1),""===e&&(this.eventTimerValue="")}_onEventTimerFrequencyChanged(){var e={unit:this.eventTimerUnit,value:this.eventTimerValue};if((this.element.frequencyTimer||{}).unit!==e.unit&&(e.value="",this.element.frequencyTimer=e,this.eventTimerValue=e.value),this.element&&""!==this.eventTimerValue){var t=this.element.frequencyTimer||{};if(e.unit!==t.value||e.value!==t.value){this.element.frequencyTimer=e;var s=this._getTimerShowValue(this.element);this._eventTimerExp.showValue(s),this.eventTimerValue=e.value}}}_onEventTimerAttributeChanged(){var e=this._eventTimerAttributeSearch.selectedItem||{},t={type:this.eventTimerAttrType};if(this.element){var s=e.id,i=e.name;t=_i(_i({},t),{},{id:parseInt(s||0,10),name:i||""});var a=this.element.attributeTimer||{};if(t.type!==a.type||t.id!==a.id||t.name!==a.name){t.type!==a.type&&(this.eventTimerAttribute=void 0,t=_i(_i({},t),{},{id:0,name:""})),this.element.attributeTimer=t;var n=this._getTimerShowValue(this.element);this._eventTimerExp.showValue(n)}}}_onEventMessageExpand(){this.element.message||(this._cleanStartItermEventMessageCmp(),this._cleanEndEventMessageCmp())}_onEventMessageWebServiceChanged(){if(this.element){var e=this.element.webServiceMessage,t=this.eventMsgWebServiceInput;if(e!==t){this.element.webServiceMessage=t;var s=this._getMessageShowValue(this.element);this._eventMessageExp.showValue(s)}}}_onAddNewMessageAttribute(){var e=this;return vi((function*(){var t=e._eventMsgAttributeSearch.selectedItem,s=e.eventMsgAttributeSearch;if(!t&&"Production"===A.ENV&&e.element)if(new RegExp(/^[a-zA-Z][\w]+[a-zA-Z0-9]$/gi).test(s)){var i="".concat(A.EVT_MSG_NEW_ATTRS_URL).concat(encodeURI(s));try{var a=yield he.a.post(i),n=new as;if(a&&a){a.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession();var r=bi(n.convertToJson(a.data),1)[0];e._eventMsgAttributeSearch.selectedItem=r,e._eventMsgAttributeSearch.reloadData(),e._eventMsgAttributeSearch.toggleDisabledButton(!0);var o=_i({},e.OPTIONS_TOAST);o.type="success",o.title=M.a.t("eventPropsPanel.txtProDesEventPanelToastTitleSuccess"),o.message=M.a.t("eventPropsPanel.txtProDesEventPanelToastTitleSuccessMessage"),e.toastMessage.showMessage(o)}}catch(e){throw Error("".concat(M.a.t("eventPropsPanel.txtProDesEventPanelErrorInsertAttribute"),": \n ").concat(e))}}else{var l=_i({},e.OPTIONS_TOAST);l.type="danger",l.title=M.a.t("eventPropsPanel.txtProDesEventPanelToastTitleError"),l.message="".concat(M.a.t("eventPropsPanel.txtProDesEventPanelErrorMessageAttrName"),' <b>"').concat(s,'"</b> ').concat(M.a.t("eventPropsPanel.txtProDesEventPanelErrorMessageNotValid")),e.toastMessage.showMessage(l)}}))()}_onAddEventMessageAttribute(){var e=this._eventMsgAttributeSearch.selectedItem,t=this.eventMsgAttributeType;if(e&&this.element){var s={id:parseInt(e.id,10),name:e.name,multivalued:!1,uk:!1,type:t.toUpperCase().charAt(0)},i="process"===t?"attrProc":"attrEnt";if(!this.element.existMessageAttribute(e.id,i)){this.element.addMessageAttribute(s,t);var a=this._getMessageShowValue(this.element),n="process"===t?this.element.processAttributesMessage:this.element.entityAttributesMessage;this._eventMsgAttributesList.arrayList.data=n,this._eventMsgAttributesList.refreshList(),this._eventMessageExp.showValue(a)}this._eventMsgAttributesList._scrollToRow(s,()=>this._onSelectEventMsgAttributesList(s))}}_onEventMsgAttributesTypeChanged(){var e=this.eventMsgAttributeType;if(this.element){var t="process"===e?this.element.processAttributesMessage:this.element.entityAttributesMessage;this._eventMsgAttributesList.arrayList.data=t||[],this._eventMsgAttributesList.refreshList()}}_onEventMsgCatchThrowChanged(){var e=this.eventMsgCatchThrow,t=this.element||{};t.catchThrowMessage!==e&&(t.catchThrowMessage=e,this._toggleEventMessageComponents(t),this._updateMessageExpValue(t))}_onSelectEventMsgAttributesList(e){if(e){var t=_i({},this.OPTIONS_TOAST);t.message="\n        <b>".concat(M.a.t("eventPropsPanel.txtProDesEventPanelToastMessageAttrName")," </b>").concat(e.name,"<br>\n        <b>").concat(M.a.t("eventPropsPanel.txtProDesEventPanelToastMessageMultivalued")," </b>").concat(e.multivalued?"True":"False","<br>\n        <b>").concat(M.a.t("eventPropsPanel.txtProDesEventPanelToastMessageUniqueKey")," </b>").concat(e.uk?"True":"False","\n      "),this.toastMessage.showMessage(t)}}_onEditEventMsgAttributesList(e){var t=this._eventMsgAttributesList.rowEditableSelected,s=this._eventMsgAttributeSearch.selectedItem,i=!!s&&this._onCheckedEventMsgAttributesList(s),a=e&&t&&!i;this._eventMsgAttributeSearch.selectedItem=a?{id:t.id,name:t.name}:void 0,this._eventMsgWebServiceInput.disabled=a,this._eventMsgAttributesType.disabled=a}_onCheckedEventMsgAttributesList(e){var t=e.value,s=e.position,i=e.keyName,a=this._eventMsgAttributesList.arrayList.data,n="multivalued"===i?"uk":"multivalued";t&&(a[s][n]=!t),this._eventMsgAttributesList.refreshList()}_onCheckEditEventMsgAttributeOnList(e){return this._eventMsgAttributesList._arrayList.data.find(t=>Number(e.id)===Number(t.id))}_onSelectToEditEventMsgAttributeSeacrh(e){var t=this.eventMsgAttributeType,s=this._eventMsgAttributesList.rowEditableSelected,i=this._onCheckEditEventMsgAttributeOnList(e),a=this._eventMsgAttributesList.editStatus;if(this.element&&e&&s&&a&&!i){var n={id:parseInt(e.id,10),name:e.name,multivalued:!1,uk:!1,type:t.toUpperCase().charAt(0)};this.element.editMessageAttribute(s.id,t,n);var r="process"===t?this.element.processAttributesMessage:this.element.entityAttributesMessage;this._eventMsgAttributesList.rowEditableSelected=n,this._eventMsgAttributesList.arrayList.data=r,this._eventMsgAttributesList.refreshList()}var o=!e&&""!==this.eventMsgAttributeSearch&&!a;this._eventMsgAttributeSearch.toggleDisabledButton(!o)}_onDeleteEventMsgAttributesList(e){var t=this.eventMsgAttributeType;if(this.element&&e){this.element.deleteMessageAttribute(e.id,t);var s="process"===t?this.element.processAttributesMessage:this.element.entityAttributesMessage;this._eventMsgAttributesList.arrayList.data=s,this._eventMsgAttributesList.refreshList()}}_onDeleteAllEventMsgAttributesList(){var e=this.eventMsgAttributeType;this.element&&this.element.deleteAllMessageAttributes(e)}_refreshWebServicesList(e){this._eventMsgWebServicesList.arrayList.data=this._getFilteredWebServicesArray(e.webServices),this._eventMsgWebServicesList.refreshList();var t=this._getMessageShowValue(e);this._eventMessageExp.showValue(t)}_onAddEventMsgWebServicesList(){var e=this._eventMsgWebServiceSearch.selectedItem;if(e&&this.element){if(!this.element.existWebService(e.id)){var t=_i({busClaId:parseInt(e.id,10),busClaName:e.name},{eventId:10,name:"ONCOMPLETE"}),s={WS:!0,busClaId:102,busClaName:"BPMNAutoComplete",eventId:11,id:1,name:"ONREADY",order:0};this.element.webServices&&0===this.element.webServices.length&&!this.element.webServices.includes(s)&&(this.element.webServices.push(s),this._refreshWebServicesList(this.element)),this.element.addWebService(t),this._refreshWebServicesList(this.element),this._eventMsgWebServicesList._scrollToRow({id:this.element.webServices.length,name:t.busClaName},()=>{this._onSelectMsgWebServicesList(t)}),this._eventMsgWebServiceSearch.selectedItem=void 0}}}_onSelectMsgWebServicesList(e){var t=this;return vi((function*(){if(e&&t.element){if(e!==t.wsSelected){t.wsSelected=t._eventMsgWebServicesList.rowSelected;var s=yield t._getBindings(e.busClaId);t._eventMsgWSBindingsList.arrayListData=s,t._cleanAndHideBindingsComponents()}var i=_i(_i({},t.OPTIONS_TOAST),{},{message:"<b>".concat(M.a.t("eventPropsPanel.txtProDesEventPanelToastMessageName"),"</b> ").concat(e.busClaName)});t.toastMessage.showMessage(i)}}))()}_cleanAndHideBindingsComponents(){this.eventMsgBindingType="none",this._eventMsgBindingType.disabled=!0,this.eventMsgBindingValue="",this.bindingAttrTypeToCheck="entity",this._eventMsgWSAttributeSearch.selectedItem=void 0,this._changeVisibility(this.wrapBindingValue,!1),this._changeVisibility(this.wrapBindingAttrType,!1),this._changeVisibility(this._eventMsgWSAttributeSearch.wrapper,!1)}_onEditMsgWebServicesList(e){var t=this;return vi((function*(){var s=t.element&&e,i=t._elementVisibility(t._eventMsgWSAttributeSearch.wrapper),a=t._elementVisibility(t.wrapBindingAttrType),n=t._elementVisibility(t.wrapBindingValue),r=t._eventMsgWebServicesList.rowEditableSelected;s&&(i||a||n)&&t._cleanAndHideBindingsComponents(),e?(t._eventMsgBindingType.disabled=!0,t._eventMsgWSBindingsList.unSelectAll(),t._eventMsgWSBindingsList.disabled=!0):t._eventMsgWSBindingsList.disabled=!1,t.eventMsgBindingType="none",t._eventMsgWebServiceSearch.selectedItem=r?{id:r.busClaId,name:r.busClaName}:void 0}))()}_onSelectToEditEventMsgWebServiceSearch(e){var t=this;return vi((function*(){var s=t._eventMsgWebServicesList.rowEditableSelected,i=t._eventMsgWebServicesList.editStatus;if(e&&t.element&&i&&s){var a=t.element.editWebService(s.id,e);t._eventMsgWebServicesList.rowEditableSelected=a;var n=yield t._getBindings(e.id);t._eventMsgWSBindingsList.arrayListData=n,t._eventMsgWSBindingsList.refreshList(),t._refreshWebServicesList(t.element)}}))()}_onDeleteEventMsgWebServicesList(e){if(e&&this.element){this.element.deleteWebService(e.id);var t={WS:!0,busClaId:102,busClaName:"BPMNAutoComplete",eventId:11,id:1,name:"ONREADY",order:0};0!==this.element.webServices.length||this.element.webServices.includes(t)||(this.element.webServices.push(t),this._refreshWebServicesList(this.element)),this._eventMsgWSBindingsList.arrayListData=[],this._eventMsgWSBindingsList.refreshList()}}_onDeleteAllEventMsgWebServices(){this.element&&(this.element.webServices=[],this._refreshWebServicesList(this.element))}_onSelectEventMsgWSBindings(e){if(e&&this.wsSelected&&this.element){this._cleanAndHideBindingsComponents(),this._eventMsgBindingType.disabled=!1;var t,s=this.element.existWSBindingParameter(this.wsSelected.id,e.id);if(s){var i=s.busClaParBndType;"V"===i&&"None"!==e.binding&&(this.eventMsgBindingType="value",this._changeVisibility(this.wrapBindingValue,!0),this.setFieldValueEachType(),this.eventMsgBindingValue=s.busClaParBndValue||""),"E"!==i&&"P"!==i||"None"===e.binding||(this.eventMsgBindingType="attribute",this._changeVisibility(this.wrapBindingAttrType,!0),this._changeVisibility(this._eventMsgWSAttributeSearch.wrapper,!0),this.bindingAttrTypeToCheck="E"===i?"entity":"process",this._eventMsgWSAttributeSearch.selectedItem={id:s.attId,name:s.attTooltip||s.attName},this.setUrlAttributeEachType())}else{if("None"===e.binding&&"Production"===A.ENV){var a=e.type;this._eventMsgWSAttributeSearch.url="".concat(this._eventMsgWSAttributeSearch.baseUrl,"&attType=").concat(a)}this._cleanAndHideBindingsComponents(),this._eventMsgBindingType.disabled=!1}if("Production"===A.ENV&&("attribute"===this.eventMsgBindingType||void 0===e.binding)){var n=e.type;this._eventMsgWSAttributeSearch.url="".concat(this._eventMsgWSAttributeSearch.baseUrl,"&attType=").concat(n)}switch(e.type){case"S":t="String";break;case"D":t="Date";break;default:t="Number"}var r="\n      <b>".concat(M.a.t("eventPropsPanel.txtProDesEventPanelToastMessageParameter"),"</b> ").concat(e.param,"<br>\n      <b>").concat(M.a.t("eventPropsPanel.txtProDesEventPanelToastMessageType"),"</b> ").concat(t,"<br>\n      <b>").concat(M.a.t("eventPropsPanel.txtProDesEventPanelToastMessageInOut"),"</b> ").concat(e.inout,"<br>\n    ");this.toastMessage.showMessage(_i(_i({},this.OPTIONS_TOAST),{},{message:r}))}}setUrlAttributeEachType(e=!0){var t=this._eventMsgWSBindingsList.rowSelected;if(t&&"Production"===A.ENV&&e){var s=t.type;this._eventMsgWSAttributeSearch.url="".concat(A.DEFAULT_ATTRS_URL,"&attType=").concat(s,"&name=")}}changeWhenTypeIsValue(e,t){this.element.editBindingParameter(e.id,t.busClaParId,{busClaParBndType:"V",busClaParBndValue:""}),this.element.deletePropertyOfBindingParameter(e.id,t.busClaParId,["attId","attName","attTooltip"])}changeWhenTypeIsAttribute(e,t){this.element.editBindingParameter(e.id,t.busClaParId,{busClaParBndType:"E"}),this.element.deletePropertyOfBindingParameter(e.id,t.busClaParId,["busClaParBndValue"])}_updateBindingsParametersList(e){this._getBindings(e.busClaId).then(e=>{this._eventMsgWSBindingsList.arrayList.data=e,this._eventMsgWSBindingsList.refreshList()})}_onEventMsgWSBindingTypeChanged(){var e,t=this._eventMsgWSBindingsList.rowSelected,s=this.eventMsgBindingType;if("value"===s&&(e="V"),"attribute"===s&&(e="E"),this.wsSelected&&t&&this.element){var i=this.element.existWSBindingParameter(this.wsSelected.id,t.id),a=!!i&&i.busClaParBndType!==e;"V"===e&&(i&&a&&this.changeWhenTypeIsValue(this.wsSelected,i),this.setFieldValueEachType()),i&&"P"===e&&a&&(this.changeWhenTypeIsAttribute(this.wsSelected,i),this.setUrlAttributeEachType()),i&&!e&&(this.element.deleteBindingParameter(this.wsSelected.id,i.busClaParId),this._cleanAndHideBindingsComponents(),this._eventMsgBindingType.disabled=!1),this._changeVisibility(this.wrapBindingValue,"value"===s),this._changeVisibility(this.wrapBindingAttrType,"attribute"===s),this._changeVisibility(this._eventMsgWSAttributeSearch.wrapper,"attribute"===s),this._updateBindingsParametersList(this.wsSelected)}}getNewBindingToAdd(e,t,s){return _i({busClaParId:parseInt(e.id,10),busClaParName:e.param,busClaParType:e.type,busClaParBndType:s},t)}setFieldValueEachType(e=!0){var t=this._eventMsgWSBindingsList.rowSelected;if(t&&e){var s=t.type;switch(s){case"N":this._eventMsgBindingValue.setAttribute("type","number");break;case"D":this._eventMsgBindingValue.setAttribute("type","date");break;default:this._eventMsgBindingValue.setAttribute("type","text")}this._toggleNumberFieldAttributes("N"===s)}}_toggleNumberFieldAttributes(e){var t=this._eventMsgBindingValue.hasAttribute("min"),s=this._eventMsgBindingValue.hasAttribute("step");!e||t||s?(this._eventMsgBindingValue.removeAttribute("min"),this._eventMsgBindingValue.removeAttribute("step"),this._eventMsgBindingValue.removeAttribute("max")):(this._eventMsgBindingValue.setAttribute("min","0"),this._eventMsgBindingValue.setAttribute("max",Number.MAX_SAFE_INTEGER),this._eventMsgBindingValue.setAttribute("step","1"))}_editOrAddBinding(e,t,s){e&&this.element.editBindingParameter(this.wsSelected.id,e.busClaParId,t);var i=this._eventMsgWSBindingsList.rowSelected;if(!e&&i){var a=this.getNewBindingToAdd(i,t,s);this.element.addBindingParameter(this.wsSelected.id,a)}}_onEventMsgWSBindingValueChanged(){var e=this._eventMsgWSBindingsList.rowSelected,t=this.eventMsgBindingValue.trim();if(this.element&&e&&this.wsSelected){var s=this.element.existWSBindingParameter(this.wsSelected.id,e.id);if(""!==t){var i={busClaParBndValue:t};this._editOrAddBinding(s,i,"V"),this._updateBindingsParametersList(this.wsSelected)}var a=s||{};this._fillValidBindingValue(a.busClaParBndValue)}}_fillValidBindingValue(e=""){"number"===this._eventMsgBindingValue.type&&""===this.eventMsgBindingValue&&(this.eventMsgBindingValue=e)}_onEventMsgWSBindingAttributeChanged(e,t){var s=this._eventMsgWSBindingsList.rowSelected;if(this.element&&s&&this.wsSelected){var i,a,n=this.element.existWSBindingParameter(this.wsSelected.id,s.id),r=this.bindingAttrTypeChecked;"attrType"===e&&(i={busClaParBndType:r},a=!n||n.busClaParBndType!==r),"attribute"===e&&t&&(a=!n||parseInt(n.attId,10)!==parseInt(t.id,10),i={attId:parseInt(t.id,10),attTooltip:t.name},t.label&&(i.attName=t.label)),("attribute"===e&&t||"attrType"===e)&&a&&this._editOrAddBinding(n,i,r),this._updateBindingsParametersList(this.wsSelected)}}}function yi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class Ei extends Fs{constructor(e){super(e,"data"),this._init(),this._initEvents()}_init(){this._dataTypeInput=this._panel.querySelector("#data_type_input"),this._nameInput=this._panel.querySelector("#data_name_input"),this._stateInput=this._panel.querySelector("#data_state_input"),this._collectionInput=this._panel.querySelector("#data_collection_input"),this._unlimitInput=this.panel.querySelector("#data_unlimit_input"),this._capacityInput=this.panel.querySelector("#data_capacity_input"),this.element&&this._checkCapacity(this.element)}_initEvents(){this._setTimeoutOnPropertyChanged(void 0,()=>{this._onNameInputChanged()},this._nameInput,"input"),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onStateInputChanged()},this._stateInput,"input"),this._collectionInput.addEventListener("input",()=>{this._onCollectionInputChanged()}),this._unlimitInput.addEventListener("input",()=>{this._onUnlimitInputChanged()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onCapacityInputChanged()},this._capacityInput,"input")}set dataTypeInput(e){this._dataTypeInput.value=e.toUpperCase()}get nameInput(){return this._nameInput.value}get stateInput(){return this._stateInput.value}get collectionInput(){return this._collectionInput.checked}get capacityInput(){return this._capacityInput.value}get unlimitInput(){return this._unlimitInput.checked}set unlimitInput(e){this._unlimitInput.checked=e}set nameInput(e){this._nameInput.value=e}set stateInput(e){this._stateInput.value=e}set collectionInput(e){this._collectionInput.checked=e}set capacityInput(e){this._capacityInput.value=e}show(e){var t=yi(e.elementType.toLowerCase().split("data"),2)[1];this.dataTypeInput=t,this.nameInput=e.dataName,this.stateInput=e.state,this.documentationInput=e.documentation;var s="datastore"===this.element.elementType.toLowerCase();s?(this.unlimitInput=e.unlimit,this.capacityInput=e.capacity):this.collectionInput=e.collection,this._changeVisibility(this._collectionInput.parentNode.parentNode,!s),this._changeVisibility(this._unlimitInput.parentNode.parentNode,s),this._changeVisibility(this._capacityInput.parentNode.parentNode,s),this._checkCapacity(e),this._changeVisibility(this._panel,!0)}_onNameInputChanged(){if(this.element){var e=this.element,t=e.elementType,s=e.name,i=t===A.DATA_STORE||t===A.DATA_INPUT||t===A.DATA_OUTPUT||t===A.DATA_OBJECT,a=i?s:void 0;this.nameInput=Hs(this.nameInput,/["]/g),a!==this.nameInput&&""!==this.nameInput&&i&&(this.element.name=this.nameInput)}}_onStateInputChanged(){if(this.element){var e=this.element.state;this.stateInput=Hs(this.stateInput,/["]/g),e!==this.stateInput&&(this.element.state=this.stateInput)}}_onCollectionInputChanged(){this.element.collection=this.collectionInput}_checkCapacity(e){if("datastore"===e.elementType.toLowerCase()){var t=this._capacityInput.parentNode.parentNode,s=e.unlimit;s&&(this.capacityInput=""),this._changeVisibility(t,!s)}}_onUnlimitInputChanged(){this.element&&(this.element.unlimit!==this.unlimitInput&&(this.element.unlimit=this.unlimitInput),this._checkCapacity(this.element))}_onCapacityInputChanged(){this.element&&(this.element.capacity!==this.capacityInput&&(this.element.capacity=parseInt(this.capacityInput,10)))}}function Si(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function fi(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Si(Object(s),!0).forEach((function(t){Ii(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Si(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ii(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Ci(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Pi(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function Ai(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){Pi(n,i,a,r,o,"next",e)}function o(e){Pi(n,i,a,r,o,"throw",e)}r(void 0)}))}}class ki extends Fs{constructor(e){super(e,"subprocess"),this._init(),this._initComponents(),this._initEventsComponents()}_init(){this.SUBPROCESS_PANEL={SUBPROCESS_NAME_SEARCH:{nameId:"subprocess_name_input",label:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelNameSearchLabel"),add:!0,url:A.SUBP_NAME_URL,hasLabel:!1,canReload:!0},STANDARD_LOOP_CONDITION:{nameId:"subp_standard_loop_cond",label:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelLoopConditionLabel")},REUSABLE:{nameId:"subp_reusable_type",label:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelReusableLabel"),expandId:"expand_reusable_zone"},REUSABLE_ENTITY_SEARCH:{nameId:"subp_reusable_entity",label:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelReusableEntitySearchLabel"),add:!1,url:A.SUBP_REUSABLE_ENT_URL,hasLabel:!0,canReload:!0},REUSABLE_FORMS_SEARCH:{nameId:"subp_reusable_form",label:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelReusableFormsSearchLabel"),add:!1,url:A.SUBP_REUSABLE_ENT_FORMS_URL,hasLabel:!1,canReload:!0},REUSABLE_FORMS_LIST:{nameId:"subp_reusable_forms_list",label:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelReusableFormsListLabel"),add:!0},MULTIINSTANCE_LOOPTYPE_SEARCH:{nameId:"subp_multiinstance_looptype",label:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelMultiInstanceLoopTypeLabel"),add:!0,responseTime:1e3,url:A.SUBP_MULTIINSTANCE_URL,hasLabel:!1,canReload:!0}},this.OPTIONS_TOAST={type:"info",title:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastTitle"),duration:3e3,position:"bottom-left"},this._subpTypeSelect=this._panel.querySelector("#subprocess_type_select"),this._subpLoopTypeSelect=this._panel.querySelector("#subprocess_loop_type_select"),this._subpColorInput=this._panel.querySelector("#subprocess_color_input"),this._subpColorInputName=this._panel.querySelector("#subprocess_color_name_input"),this._subpStandardLoop=this._panel.querySelector("#subp_standard_loop_switch"),this._subpConditionDoc=this._panel.querySelector("#subp_condition_documentation_input"),this._subpReusableFormType=this._panel.querySelector("#subp_reusable_form_type"),this._subpReusableExecution=this._panel.querySelector("#subp_reusable_execution"),this._subpReusableSkipFirstTask=this._panel.querySelector("#subp_reusable_skip_first_task"),this._subpTypeSelect.addEventListener("input",()=>{this._onSubpTypeSelectChanged()}),this._subpLoopTypeSelect.addEventListener("input",()=>{this._onSubpLoopTypeSelectChanged()}),this._subpColorInput.addEventListener("change",()=>{this._onSubpColorChanged()}),this._subpReusableFormType.addEventListener("input",()=>{this._onSubpReusableFormTypeChanged()})}_initComponents(){this.wrapStandardLoopSwitch=this._panel.querySelector("#wrapper_subprocess_standard_loop_switch"),this.wrapSubpConditionDoc=this._subpConditionDoc.parentNode.parentNode,this.wrapReusableExpandZone=this._panel.querySelector("#expand_reusable_zone"),this.wrapReusableFormType=this._subpReusableFormType.parentNode.parentNode,this.wrapSubpLoopType=this._subpLoopTypeSelect.parentNode.parentNode,this.wrapSubpType=this._subpTypeSelect.parentNode.parentNode,this._initSubpNameComponent(),this._initStandardLoopComponents(),this._initReusableTypeComponents(),this._initMultiInstanceComponent()}_initSubpNameComponent(){var e=this.SUBPROCESS_PANEL.SUBPROCESS_NAME_SEARCH;this._subpNameInput=this._includeComponent("dropdown",this.wrapSubpName,this.wrapSubpType,"beforebegin",e),this._subpNameInput.placeholder="Insert a Subprocess",this._subpNameInput.toggleDisabledButton(!0)}_initStandardLoopComponents(){var e=this.SUBPROCESS_PANEL.STANDARD_LOOP_CONDITION;this._subpStandardLoopCond=this._includeComponent("condition",this.wrapStandardLoopCond,this.wrapSubpConditionDoc,"beforebegin",e),this._subpStandardLoopCond.placeholder=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelPlaceholderCondition"),this._subpConditionDoc.placeholder=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelPlaceholderDocumentation"),this._changeVisibility(this._subpStandardLoopCond.wrapper,!1),this._changeVisibility(this.wrapSubpConditionDoc,!1)}_initReusableTypeComponents(){var e=this.SUBPROCESS_PANEL,t=e.REUSABLE,s=e.REUSABLE_ENTITY_SEARCH,i=e.REUSABLE_FORMS_SEARCH,a=e.REUSABLE_FORMS_LIST;a.arrayList=this._createReusableFormsArrayList(),this._subpReusableExp=this._includeComponent("expander",this.wrapReusableExpandZone,this.wrapReusableExpandZone,"beforebegin",t),this._subpReusableEntitySearch=this._includeComponent("dropdown",this.wrapReusableEntSearch,this.wrapReusableFormType,"beforebegin",s),this._subpReusableFormSearch=this._includeComponent("dropdown",this.wrapReusableFormSearch,this.wrapReusableFormType,"afterend",i),this._subpReusableFormsList=this._includeComponent("list",this.wrapReusableFormsList,this._subpReusableFormSearch.wrapper,"afterend",a),this._subpReusableEntitySearch.placeholder=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelPlaceholderEntitySelect"),this._subpReusableFormSearch.placeholder=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelPlaceholderAddForm")}_initMultiInstanceComponent(){var e=this.SUBPROCESS_PANEL.MULTIINSTANCE_LOOPTYPE_SEARCH;this._subpMultiInstanceType=this._panel.querySelector("#subp_multiinstance_type_select"),this.wrapMultiInstanceType=this._panel.querySelector("#wrap_subp_multiinstance_type_select"),this._subpMultiplicationSearch=this._includeComponent("dropdown",this.wrapMultipSearch,this.wrapMultiInstanceType,"afterend",e),this._subpMultiplicationNumber=this._panel.querySelector("#subp_multiinstance_number_type"),this.wrapMultiplicationNumber=this._subpMultiplicationNumber.parentNode.parentNode,this._subpMultiplicationSearch.placeholder="Select an Attribute",this._subpMultiplicationSearch.toggleDisabledButton(!0)}_initEventsComponents(){this._subpStandardLoop.addEventListener("input",()=>{this._onSubpStandardLoopChanged()}),this._subpStandardLoopCond.on("change_condition",e=>{this._onSubpStandardLoopCondChanged(e)}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onSubpStandardLoopDocumentationChanged()},this._subpConditionDoc,"input"),this._subpNameInput.on("select_item",e=>{this._onSubpNameInputChanged(e)}),this._subpNameInput.on("add_item",()=>{this._onAddNewSubprocess()}),this._subpMultiplicationSearch.on("select_item",e=>{this._onSelectMultiplicationSearch(e)}),this._subpMultiplicationSearch.on("add_item",()=>{this._onAddNewMultiplicationAttribute()}),this._subpReusableEntitySearch.on("select_item",e=>{this._onSelectReusableEntitySearch(e)}),this._subpReusableEntitySearch.on("clear_item",()=>{this._onDeleteReusableEntitySearch()}),this._subpReusableFormsList.on("add_item",()=>{this._onAddReusableFormsList()}),this._subpReusableFormSearch.on("select_item",e=>{this._onSelectReusableForm(e)}),this._subpReusableFormsList.on("edit_item",e=>{this._onEditSubpReusableFormsList(e)}),this._subpReusableFormsList.on("selected_item",e=>{this._onSelectSubpReusableFormsList(e)}),this._subpReusableFormsList.on("delete_item",e=>{this._onDeleteSubpReusableFormsList(e)}),this._subpReusableFormsList.on("delete_all_items",()=>{this._onDeleteAllSubpReusableFormsList()}),this._subpReusableFormsList.on("move",(e,t,s,i)=>{this._onOrderFormChanged(e,t,s,i)}),this._subpReusableExecution.addEventListener("input",()=>{this._onSelectSubpReusableExecutionChanged()}),this._subpReusableSkipFirstTask.addEventListener("input",()=>{this._onSubpReusableSkipFirtsTaskChanged()}),this._subpMultiInstanceType.addEventListener("input",()=>{this._onSubMultiInstanceTypeChanged()}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onValidateMultiplicationNumber(),this._onSubpMultiplicationNumberChanged()},this._subpMultiplicationNumber,"input",100)}set subpNameInput(e){this._subpNameInput.valueEl=e}set subpTypeSelect(e){this._subpTypeSelect.value=e||""}set subpLoopTypeSelect(e){this._subpLoopTypeSelect.value=e||""}set subpColorInput(e){this._subpColorInput.value=e}set subpColorInputName(e){this._subpColorInputName.value=e}get subpNameInput(){return this._subpNameInput.valueEl}get subpTypeSelect(){return this._subpTypeSelect.value}get subpLoopTypeSelect(){return this._subpLoopTypeSelect.value}get subpMultiInstanceType(){return this._subpMultiInstanceType.checked}set subpMultiInstanceType(e){this._subpMultiInstanceType.checked=e,this.wrapMultiInstanceType.querySelector(".highlighted").innerText=e?"Value":"Attribute"}get subpMultiplicationNumber(){var e=this._subpMultiplicationNumber.value;return""!==e?parseInt(e,10):e}set subpMultiplicationNumber(e){this._subpMultiplicationNumber.value=e}get subpColorInput(){return this._subpColorInput.value}get subpStandardLoop(){return this._subpStandardLoop.checked}get subpStandardLoopCond(){return this._subpStandardLoopCond.conditionArea}get subpStandardLoopCondDoc(){return this._subpConditionDoc.value}set subpStandardLoopCond(e){this._subpStandardLoopCond.conditionArea=e}set subpStandardLoopCondDoc(e){this._subpConditionDoc.value=e}set subpStandardLoop(e){this._subpStandardLoop.checked=e}set subpReusableEntitySearch(e){this._subpReusableEntitySearch.valueEl=e}get subpReusableFormType(){return this._subpReusableFormType.value}set subpReusableFormSearch(e){this._subpReusableFormSearch.valueEl=e}set subpMultiplicationSearch(e){this._subpMultiplicationSearch.valueEl=e}get subpMultiplicationSearch(){return this._subpMultiplicationSearch.valueEl.trim()}get subpReusableExecution(){return this._subpReusableExecution.value}get subpReusableSkipFirstTask(){return this._subpReusableSkipFirstTask.checked}set subpReusableExecution(e){this._subpReusableExecution.value=e}set subpReusableSkipFirstTask(e){this._subpReusableSkipFirstTask.checked=e}show(e){this.showGenericComponents(e),this.showStandardLoop(e),this.showReusable(e),this.showMultiInstance(e),this._changeVisibility(this._panel,!0)}showGenericComponents(e){this._subpNameInput.selectedItem={id:e.subprocessId,name:e.name},this.subpTypeSelect=e.type,this.subpLoopTypeSelect=e.loopType,this.subpColorInput=e.color,this.subpColorInputName=e.color,this.documentationInput=e.documentation}showStandardLoop(e){var t=this.subpLoopTypeSelect.toUpperCase();this.subpStandardLoop=!1,this._changeVisibility(this.wrapStandardLoopSwitch,"STANDARD"===t);var s=this._elementVisibility(this._subpStandardLoopCond.wrapper),i=this._elementVisibility(this.wrapSubpConditionDoc);s&&"STANDARD"!==t&&this._changeVisibility(this._subpStandardLoopCond.wrapper,!1),i&&"STANDARD"!==t&&this._changeVisibility(this.wrapSubpConditionDoc,!1),this.subpStandardLoopCond=e.standard&&e.standardCondition?e.standardCondition:"",this.subpStandardLoopCondDoc=e.standard&&e.standardDocumentation?e.standardDocumentation:""}showReusable(e){var t=this.subpTypeSelect.toUpperCase();this._changeVisibility(this._subpReusableExp.wrapper,"REUSABLE"===t),this._subpReusableExp.isExpand&&"REUSABLE"!==t&&this._subpReusableExp.expand(),this._subpReusableEntitySearch.selectedItem=bt()(e.reusableEntity)?void 0:{id:e.reusableEntity.id,name:e.reusableEntity.name};var s="entity"===this.subpReusableFormType?"E":"P";this._subpReusableExp.showValue(this._getReusableExpShowValue(e)),this._subpReusableFormsList.arrayList.data=this._getReusableFormByType(s,e),this._subpReusableFormSearch.selectedItem=void 0,this._subpReusableFormsList.editStatus&&(this._subpReusableFormsList.editStatus=!1,this._setReusableEditionMode(!1)),this._subpReusableFormsList.refreshList(),this.subpReusableExecution=e.execution||"synchronized",this.subpReusableSkipFirstTask=e.skipFirst||!1}showMultiInstance(e){var t="MULTIINSTANCE"===this.subpLoopTypeSelect.toUpperCase(),s="value"===e.multiInstanceType;this._changeVisibility(this.wrapMultiInstanceType,t),this._changeVisibility(this._subpMultiplicationSearch.wrapper,t&&!s),this._changeVisibility(this.wrapMultiplicationNumber,t&&s);var i=e.multiInstanceAttribute,a=i.id,n=i.name,r=e.multiInstance&&a&&n;this._subpMultiplicationSearch.selectedItem=r?{id:a,name:n}:void 0,this.subpMultiInstanceType="value"===e.multiInstanceType,this.subpMultiplicationNumber=e.multiInstanceValue||"",!this._subpMultiplicationSearch.load&&t&&(this._subpMultiplicationSearch.load=!0)}_getReusableExpShowValue(e){var t=[];e.reusable&&(e.reusableForms||[]).forEach(e=>t.push(e.name));return t}_getReusableFormByType(e,t){var s=[];t.reusable&&(s=(t.reusableForms||[]).filter(t=>t.formType===e));return s}_createReusableFormsArrayList(){return{header:[M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelHeaderName"),M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelHeaderEdit"),M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelHeaderDeleteAll")],deleteAction:!0,deleteActionAll:!0,editAction:!0,data:[],notShow:["id","order","step","formType"],actions:[]}}_onSubpNameInputChanged(e){var t=!e&&""!==this.subpNameInput;this._subpNameInput.toggleDisabledButton(!t),e&&(this.element.name=e)}_onAddNewSubprocess(){var e=this;return Ai((function*(){if(!e._subpNameInput.selectedItem&&"Production"===A.ENV&&e.element){var t=new RegExp(/^[a-zA-Z][\w]+[a-zA-Z0-9]$/gi),s=e.subpNameInput;if(t.test(s)){var i=encodeURI(s),a="".concat(A.NEW_SUBP_URL,"&name=").concat(i,"&title=").concat(i);try{var n=yield he.a.post(a);if(n&&n.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession(),n){var r=Ci((new as).convertToJson(n.data),1)[0];e.element.name=r,e._subpNameInput.selectedItem=r,e._subpNameInput.reloadData(),e._subpNameInput.toggleDisabledButton(!0);var o=e.OPTIONS_TOAST;o.type="success",o.title=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastSuccessTitle"),o.message=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastSuccessMessage"),e.toastMessage.showMessage(o)}}catch(e){throw Error(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelErrorMessage"))}}else{var l=e.OPTIONS_TOAST;l.type="danger",l.title=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastErrorTitle"),l.message="".concat(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelErrorToastErrorMessageIsValid"),' <b>"').concat(s,'"</b> ').concat(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastMessageIsValid")),e.toastMessage.showMessage(l)}}}))()}_onSubpTypeSelectChanged(){if(this.element){var e=this.subpTypeSelect;if(this.element.type!==e){if(this.element.type=e,"REUSABLE"!==e.toUpperCase())this.element.deletePropertyByName("reusable");else{var t=this.subpReusableExecution,s=this.subpReusableSkipFirstTask;this.element.reusable={execution:t,skipFirst:s}}this.showReusable(this.element)}}}_onSubpLoopTypeSelectChanged(){var e=this.subpLoopTypeSelect;if(e!==this.element.loopType){this.element.loopType=e;var t="multiinstance"===e?"standard":"multiInstance";if(("MULTIINSTANCE"===e.toUpperCase()&&this.element.standard||"STANDARD"===e.toUpperCase()&&this.element.multiInstance)&&this.element.deletePropertyByName(t),"MULTIINSTANCE"===e.toUpperCase()){var s=this.subpMultiInstanceType?"value":"attribute";this.element.multiInstance={type:s}}("NONE"===e.toUpperCase()&&this.element.multiInstance||"NONE"===e.toUpperCase()&&this.element.standard)&&(this.element.deletePropertyByName(this.element.multiInstance?"multiInstance":"standard"),this.subpMultiInstanceType=!1,this.subpMultiplicationNumber=""),this.showMultiInstance(this.element),this.showStandardLoop(this.element)}}_onSubpColorChanged(){this.element.color=this.subpColorInput,this.subpColorInputName=this.subpColorInput}_onSubpStandardLoopChanged(){var e=this.subpStandardLoop;this._changeVisibility(this._subpStandardLoopCond.wrapper,e),this._changeVisibility(this.wrapSubpConditionDoc,e)}_onSubpReusableFormTypeChanged(){var e="entity"===this.subpReusableFormType?"E":"P",t="E"===e?A.SUBP_REUSABLE_ENT_FORMS_URL:A.SUBP_REUSABLE_PROC_FORMS_URL;this._subpReusableFormSearch.url=t,this._subpReusableFormsList.arrayList.data=this._getReusableFormByType(e,this.element),this._subpReusableFormsList.refreshList()}_onSubpStandardLoopCondChanged(e){this.element&&(this.element.standardCondition=e)}_onSubpStandardLoopDocumentationChanged(){var e=this.subpStandardLoopCondDoc;this.element&&(this.element.standardDocumentation=e)}_onSelectMultiplicationSearch(e){if(e&&this.element){var t=e||{};this.element.multiInstanceAttribute.name!==t.name&&(this.element.multiInstanceAttribute=t)}var s=!e&&""!==this.subpMultiplicationSearch;this._subpMultiplicationSearch.toggleDisabledButton(!s)}_onAddNewMultiplicationAttribute(){var e=this;return Ai((function*(){var t=e.subpMultiplicationSearch;if(/^[a-zA-Z][a-zA-Z_0-9]+[a-zA-Z0-9]$/gi.test(t))try{var s="".concat(A.NEW_NUMERIC_ATTR_URL).concat(t),i=yield he.a.post(s);if(i&&i.data.toUpperCase().indexOf("HTML")>-1&&e.showInvalidSession(),i){var a=Ci((new as).convertToJson(i.data),1)[0];e.element.multiInstanceAttribute=fi({},a),e._subpMultiplicationSearch.selectedItem=a,e._subpMultiplicationSearch.reloadData(),e._subpMultiplicationSearch.toggleDisabledButton(!0);var n=fi({},e.OPTIONS_TOAST);n.type="success",n.title=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastSuccessTitle"),n.message=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastSuccessMessageAttr"),e.toastMessage.showMessage(n)}}catch(e){throw Error(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelErrorMessageAttr"))}else{var r=fi({},e.OPTIONS_TOAST);r.type="danger",r.title=M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastErrorTitle"),r.message="".concat(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastErrorMessageSubprocessNameAttr"),' <b>"').concat(t,'"</b> ').concat(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastMessageIsValid")),e.toastMessage.showMessage(r)}}))()}_onSelectReusableEntitySearch(e){if(this.element){var t=e||{};this.element.reusableEntity.name!==t.name&&(this.element.reusableEntity=t)}}_onDeleteReusableEntitySearch(){this.element&&(this.element.reusableEntity=null)}_onSelectReusableForm(e){var t=this.subpReusableFormType.toUpperCase().charAt(0),s=this._subpReusableFormsList.editStatus;if(e&&s&&this.element){var i=this._subpReusableFormsList.rowEditableSelected,a=this.element.reusableForms.findIndex(e=>parseInt(e.id,10)===parseInt(i.id,10)&&e.formType===t),n=this.element.reusableForms.findIndex(s=>parseInt(s.id,10)===parseInt(e.id,10)&&s.formType===t);if(-1!==a&&-1===n){var r=fi({},i);r.id=parseInt(e.id,10),r.name=e.name,this.element.editReusableForm(a,r);var o=this.subpReusableFormType.toUpperCase().charAt(0);this._subpReusableFormsList.arrayList.data=this._getReusableFormByType(o,this.element),this._subpReusableFormsList.rowEditableSelected=r,this._subpReusableFormsList.refreshList();var l=this._getReusableExpShowValue(this.element);this._subpReusableExp.showValue(l)}if(-1!==n){this._subpReusableFormSearch.selectedItem=fi({},i);var h=fi(fi({},this.OPTIONS_TOAST),{},{type:"danger",title:M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastErrorTitle"),message:"".concat(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastErrorMessageForm"),' "').concat(e.name,'" ').concat(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastErrorMessageExist"))});this.toastMessage.showMessage(h)}}}_onAddReusableFormsList(){var e=this._subpReusableFormSearch.selectedItem,t=this.subpReusableFormType.toUpperCase().charAt(0);if(e){var s=this.element.reusableForms||[];if(!s.find(s=>parseInt(s.id,10)===parseInt(e.id,10)&&s.formType===t)){var i={id:parseInt(e.id,10),name:e.name,order:s.length,step:1,formType:t};this.element.addReusableForm(i),this._subpReusableFormsList.arrayList.data=this._getReusableFormByType(t,this.element),this._subpReusableFormsList.refreshList(),this._subpReusableFormsList._scrollToRow(i,()=>this._onSelectSubpReusableFormsList(i)),this._subpReusableFormSearch.selectedItem=void 0;var a=this._getReusableExpShowValue(this.element);this._subpReusableExp.showValue(a)}}}_setReusableEditionMode(e){this._subpReusableEntitySearch.disabled=e,this._subpReusableFormType.disabled=e,this._subpReusableExecution.disabled=e,this._subpReusableSkipFirstTask.disabled=e}_onEditSubpReusableFormsList(e){if(this._setReusableEditionMode(e),e){var t=this._subpReusableFormsList.rowEditableSelected;this._subpReusableFormSearch.selectedItem={id:t.id,name:t.name}}else this._subpReusableFormSearch.selectedItem=void 0}_onSelectSubpReusableFormsList(e){if(e){var t=this.OPTIONS_TOAST;t.message="<b>".concat(M.a.t("subprocessPropsPanel.txtProDesSubprocessPanelToastMessageFormName"),"</b> ").concat(e.name),this.toastMessage.showMessage(t)}}_onDeleteSubpReusableFormsList(e){var t=this.subpReusableFormType.toUpperCase().charAt(0);if(this.element&&e){var s=this.element.reusableForms.findIndex(s=>parseInt(s.id,10)===parseInt(e.id,10)&&s.formType===t);-1!==s&&(this.element.deleteReusableForm(s),this._subpReusableFormsList.arrayList.data=this.element.reusableForms.filter(e=>e.formType===t),this._subpReusableFormsList.refreshList(),this._subpReusableExp.showValue(this._getReusableExpShowValue(this.element)))}}_onDeleteAllSubpReusableFormsList(){this.element&&(this.element.cleanReusableForm("entity"===this._subpReusableFormType.value?"E":"P"),this._subpReusableExp.showValue(this._getReusableExpShowValue(this.element)))}_onSelectSubpReusableExecutionChanged(){this.element&&(this.element.execution=this.subpReusableExecution)}_onSubpReusableSkipFirtsTaskChanged(){this.element&&(this.element.skipFirst=this.subpReusableSkipFirstTask)}_onOrderFormChanged(e,t,s,i){var a=this.subpReusableFormType.toUpperCase().charAt(0);this.element&&this.element.changeReusableFormPosition(e,t,s,i,a)}_onSubMultiInstanceTypeChanged(){var e=this.subpMultiInstanceType,t=this.wrapMultiInstanceType.querySelector(".highlighted");this._changeVisibility(this._subpMultiplicationSearch.wrapper,!e),this._changeVisibility(this.wrapMultiplicationNumber,e),e&&this.element?this._subpMultiplicationSearch.selectedItem=void 0:this.subpMultiplicationNumber="";var s=e?"Value":"Attribute";t.innerText=s,this.element&&(this.element.multiInstanceType=s.toLowerCase())}_onValidateMultiplicationNumber(){var e=this.subpMultiplicationNumber;(e<1||isNaN(e))&&(this.subpMultiplicationNumber=1),this.subpMultiplicationNumber=""===e?"":parseInt(e,10)}_onSubpMultiplicationNumberChanged(){if(this.element){var e=this.subpMultiplicationNumber;this.element.multiInstanceValue!==e&&(this.element.multiInstanceValue=e)}}}class wi extends Fs{constructor(e){super(e,"workflow"),this._initElements(),this._initEventsHandlers()}_initElements(){var e=this._panel.querySelector("#manager_workflow_events");this._eventsManager=new ei("workflow",e,{eventsUrl:A.WORKFLOW_EVENTS_URL,busClassUrl:A.WORKFLOW_ACTIONS_URL,attributesUrl:A.WORKFLOW_ATTRS_URL,bindingsUrl:A.WORKFLOW_BINDINGS_URL})}_initEventsHandlers(){this._eventsManager.on("change",e=>this._setEventsWhenManagerChanged(e))}show(e){var t=e.events;this._eventsManager.reset(),this._eventsManager.eventsList=t,this.documentationInput=e.documentation||"",this._changeVisibility(this._panel,!0)}_setEventsWhenManagerChanged(e){this.element&&(this.element.events=e)}}class Mi extends Fs{constructor(e){super(e,"connector"),this._init(),this._initEvents()}get connectorNameInput(){return this._connectorNameInput.value.trim()}get connectorTypeSelect(){return this._connectorTypeSelect.value}get connectorApiaSelect(){return this._connectorApiaSelect.value.toUpperCase()}get connectorExpCondition(){return this._connectorExpCondition.conditionArea}get connectorDirectionSelect(){return this._connectorDirectionSelect.value}get connectorExecOrder(){return this._connectorExecOrder.value}set connectorNameInput(e){this._connectorNameInput.value=e}set connectorTypeSelect(e){this._connectorTypeSelect.value=e}set connectorApiaSelect(e){this._connectorApiaSelect.value=e}set connectorExpCondition(e){this._connectorExpCondition.conditionArea=e}set connectorDirectionSelect(e){this._connectorDirectionSelect.value=e}set connectorExecOrder(e){this._connectorExecOrder.value=e}_init(){this.CONNECTOR_PANEL={EXPRESSION:{nameId:"connector_exp_condition",label:M.a.t("connectorPropsPanel.txtProDesConnectorPanelExpressionLabel")}};var e=this.CONNECTOR_PANEL.EXPRESSION;this._connectorNameInput=this.panel.querySelector("#connector_name_input"),this._connectorDirectionSelect=this.panel.querySelector("#connector_direction_select"),this._connectorTypeSelect=this.panel.querySelector("#connector_type_select"),this._connectorApiaSelect=this.panel.querySelector("#connector_apia_select"),this._wrapConnectorDoc=this._documentationInput.parentNode.parentNode,this._wrapConnectorType=this._connectorTypeSelect.parentNode.parentNode,this._wrapConnectorDirection=this._connectorDirectionSelect.parentNode.parentNode,this._wrapConnectorApia=this._connectorApiaSelect.parentNode.parentNode,this._connectorExpCondition=this._includeComponent("condition",this._wrapCod,this._wrapConnectorType,"afterend",e),this._connectorExecOrder=this.panel.querySelector("#connector_execution_order"),this._wrapConnectorExecOrder=this._connectorExecOrder.parentNode.parentNode,this._changeVisibility(this._connectorExpCondition.wrapper,!1),this._changeVisibility(this._wrapConnectorExecOrder,!1)}_initEvents(){this._connectorTypeSelect.addEventListener("input",()=>{this._onConnectorTypeSelectChanged()}),this._connectorDirectionSelect.addEventListener("input",()=>{this._onConnectorDirectionSelectChanged()}),this._connectorApiaSelect.addEventListener("input",()=>{this._onConnectorApiaSelectChanged()}),this._connectorExpCondition.on("change_condition",e=>{this._onConnectorExpressionCondChanged(e)}),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onConnectorNameChanged()},this._connectorNameInput,"input",200),this._setTimeoutOnPropertyChanged(void 0,()=>{this._onConnectorExecutionOrderChanged()},this._connectorExecOrder,"input",200)}_transitionComponentsAccordingElement(e,t){var s="";switch(e.elementType){case A.START_EVENT:case A.INTERMEDIATE_EVENT:s=2;break;case A.TASK:case A.SUBPROCESS:s=1,t.elementType===A.INTERMEDIATE_EVENT&&(s=2);break;case A.GATEWAY:s=2,"exclusive"!==e.type&&"inclusive"!==e.type||(s=3)}return s}_haveGatewayMultipleConnectors(e){var t=ze(A.CONNECTOR,this.editor.elements).filter(e=>e.type===A.CONNECTOR_TYPE_TRANSITION),s=0;return t.forEach(t=>{parseInt(t.from,10)===parseInt(e,10)&&s++}),s>1}_showModuleTransition(e,t){switch(this._changeVisibility(this._wrapConnectorType,!0),this._changeVisibility(this._wrapConnectorApia,!0),this._changeVisibility(this._wrapConnectorDoc,!0),this._changeVisibility(this._connectorExpCondition.wrapper,!1),this._changeVisibility(this._wrapConnectorDirection,!1),this._changeVisibility(this._wrapConnectorExecOrder,!1),e){case 1:this._connectorTypeSelect.disabled=!1,this._connectorApiaSelect.disabled=!1,this.connectorTypeSelect="none",this.connectorApiaSelect="N";break;case 2:this._connectorTypeSelect.disabled=!0,this._connectorApiaSelect.disabled=!1,this.connectorTypeSelect="none",this.connectorApiaSelect="N",this._connectorTypeSelect.disabled=!0;break;case 3:this._connectorTypeSelect.disabled=!0,this._connectorApiaSelect.disabled=!1,this.connectorApiaSelect="N",this._changeVisibility(this._connectorExpCondition.wrapper,!0),"exclusive"===t.type&&this._haveGatewayMultipleConnectors(t.id)&&"Offline"!==A.ENV&&this._changeVisibility(this._wrapConnectorExecOrder,!0)}}show(e){var t=He(e.from,this.editor.elements),s=He(e.to,this.editor.elements);if(this.connectorNameInput=e.connectorName||"",this.documentationInput=e.documentation,e.type===A.CONNECTOR_TYPE_TRANSITION){var i=this._transitionComponentsAccordingElement(t,s);this._showModuleTransition(i,t),this.connectorTypeSelect=3!==i?e.kind||"none":"expression",this.connectorExpCondition=e.expression||"",this.connectorApiaSelect=e.connectorClass||"N";var a=void 0!==e.executionOrder?e.executionOrder:"";this.connectorExecOrder=a,1===i&&"expression"===e.kind&&this._changeVisibility(this._connectorExpCondition.wrapper,!0)}else{this.connectorDirectionSelect=e.direction||"";var n=this._isDataInputOutput(e.from,e.to);this._connectorDirectionSelect.disabled=n,this._changeVisibility(this._wrapConnectorType,!1),this._changeVisibility(this._wrapConnectorApia,!1),this._changeVisibility(this._wrapConnectorDirection,!0),this._changeVisibility(this._wrapConnectorDoc,!0),this._changeVisibility(this._connectorExpCondition.wrapper,!1),this._changeVisibility(this._wrapConnectorExecOrder,!1)}this._changeVisibility(this._panel,!0)}_isDataInputOutput(e,t){var s=He(e,this.editor.elements),i=He(t,this.editor.elements);return s.elementType===A.DATA_INPUT||s.elementType===A.DATA_OUTPUT||i.elementType===A.DATA_INPUT||i.elementType===A.DATA_OUTPUT}_onConnectorNameChanged(){if(this.element){var e=this.element,t=e.elementType,s=e.connectorName;(t===A.CONNECTOR?s:void 0)!==this.connectorNameInput&&t===A.CONNECTOR&&(this.element.connectorName=this.connectorNameInput)}}_onConnectorTypeSelectChanged(){var e="expression"===this.connectorTypeSelect;this.element.kind=this.connectorTypeSelect,!e&&this.element.expression&&delete this.element.properties.expression,this._changeVisibility(this._connectorExpCondition.wrapper,e),this._changeVisibility(this._wrapConnectorDoc,e)}_onConnectorExpressionCondChanged(e){this.element.expression=e}_onConnectorApiaSelectChanged(){this.element.connectorClass=this.connectorApiaSelect}_onConnectorDirectionSelectChanged(){this.element.direction=this.connectorDirectionSelect}_onConnectorExecutionOrderChanged(){if(this.element){var e=this.element.executionOrder;if(""!==this.connectorExecOrder){var t=js(this.connectorExecOrder,0);this.connectorExecOrder=t?parseInt(this.connectorExecOrder,10):"0"}else this.connectorExecOrder="";e!==this.connectorExecOrder&&(this.element.executionOrder=parseInt(this.connectorExecOrder,10))}}}class Li extends me.a{constructor(){super(),this._sidebar=document.querySelector(".main__sidepanel"),this._sidebarHandle=document.querySelector("#sidebar_handle"),this._btnToggleVisible=document.querySelector("#sidebar_toggle");var e=window.getComputedStyle(document.documentElement);this._sidebarMinWidth=e.getPropertyValue("--sidebar-width"),this._newSideBarWidth=this._sidebarMinWidth,this._onSidebarHandleMouseUp=this._onSidebarHandleMouseUp.bind(this),this._onSidebarHandleMouseMove=this._onSidebarHandleMouseMove.bind(this),this._sidebarHandle.addEventListener("mousedown",()=>{document.addEventListener("mouseup",this._onSidebarHandleMouseUp),document.addEventListener("mousemove",this._onSidebarHandleMouseMove)}),window.addEventListener("resize",()=>{window.matchMedia("(max-width: 992px)").matches?this._sidebar.setAttribute("style"," width:100%"):this._sidebar.setAttribute("style","width:".concat(this._newSideBarWidth,"px"))}),this._btnToggleVisible.addEventListener("click",()=>{var e=this._sidebar.getAttribute("data-state");this._newSideBarWidth=parseInt(this._newSideBarWidth,10),"off"===e||""===e?(document.documentElement.style.setProperty("--sidebar-current-width","-".concat(this._newSideBarWidth,"px")),this._sidebar.setAttribute("data-state","on")):(document.documentElement.style.setProperty("--sidebar-current-width","0px"),this._sidebar.setAttribute("data-state","off")),this.emit("resize")},!1)}_onSidebarHandleMouseUp(){document.removeEventListener("mousemove",this._onSidebarHandleMouseMove),document.removeEventListener("mouseup",this._onSidebarHandleMouseUp)}_onSidebarHandleMouseMove(e){var t=document.documentElement.offsetWidth;this._newSideBarWidth=t-e.clientX,this._newSideBarWidth<parseInt(this._sidebarMinWidth,10)?this._newSideBarWidth=parseInt(this._sidebarMinWidth,10):this._newSideBarWidth>=t/2&&(this._newSideBarWidth=t/2),this._sidebar.setAttribute("style","width:".concat(this._newSideBarWidth,"px")),this._sidebar.style.width="width:".concat(this._newSideBarWidth,"px"),this._sidebarHandle.setAttribute("style","right:".concat(this._newSideBarWidth,"px")),this._btnToggleVisible.setAttribute("style","right:".concat(this._newSideBarWidth,"px"))}}class xi extends Li{constructor(e){super(),this._taskPanel=new oi(e),this._subprocessPanel=new ki(e),this._gatewayPanel=new hi(e),this._eventPanel=new Ti(e),this._groupPanel=new ci(e),this._textPanel=new pi(e),this._dataPanel=new Ei(e),this._poolLanePanel=new di(e),this._workflowPanel=new wi(e),this._connectorPanel=new Mi(e)}show(e,t,s=!1){switch(e){case A.TASK:this._taskPanel.show(t);break;case A.SUBPROCESS:this._subprocessPanel.show(t);break;case A.GATEWAY:this._gatewayPanel.show(t);break;case A.START_EVENT:case A.INTERMEDIATE_EVENT:case A.END_EVENT:this._eventPanel.show(t);break;case A.GROUP:this._groupPanel.show(t);break;case A.TEXT:this._textPanel.show(t);break;case A.DATA_STORE:case A.DATA_OBJECT:case A.DATA_INPUT:case A.DATA_OUTPUT:this._dataPanel.show(t);break;case A.POOL:case A.LANE:this._poolLanePanel.show(t);break;case A.CONNECTOR:this._connectorPanel.show(t);break;case A.WORKFLOW:this._workflowPanel.isVisible&&!s||this._workflowPanel.show(t)}}hide(e){switch(e){case A.TASK:this._taskPanel.hide();break;case A.SUBPROCESS:this._subprocessPanel.hide();break;case A.GATEWAY:this._gatewayPanel.hide();break;case A.START_EVENT:case A.INTERMEDIATE_EVENT:case A.END_EVENT:this._eventPanel.hide();break;case A.GROUP:this._groupPanel.hide();break;case A.TEXT:this._textPanel.hide();break;case A.DATA_STORE:case A.DATA_INPUT:case A.DATA_OUTPUT:case A.DATA_OBJECT:this._dataPanel.hide();break;case A.POOL:case A.LANE:this._poolLanePanel.hide();break;case A.CONNECTOR:this._connectorPanel.hide();break;case A.WORKFLOW:this._workflowPanel.hide()}}}var Ni=s("dEzR"),Oi=s.n(Ni),Di=s("mNz5"),Ri=s.n(Di),Bi=s("fDyJ"),Vi=s.n(Bi),Fi=s("Wgwc"),Ui=s.n(Fi),Wi=s("+QaA"),zi=s.n(Wi),Hi=s("cYju");function Gi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ji(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class qi{constructor(e){this.elements=e}get types(){return{FORM:"form",ATTRIBUTE:"attribute",DOCUMENTATION:"documentation",EVENT:"event"}}readExtract(e){this.parser=e,this.elements.forEach(e=>{var t=e.properties,s=e.elementType;if(t.documentation&&(s===A.TASK||s===A.WORKFLOW)){var i=t.documentation,a=Object(Hi.b)(i.text||"");this._extractInfo(a,e)}})}writeExtract(e,t){this.builder=e;var s=t.properties,i=s.forms,a=s.events,n=s.documentation;return{documentation:this._buildDocumentation(n),forms:t.elementType===A.WORKFLOW?this._buildWorkflowForms(i):this._buildTaskForms(i),events:this._buildEvents(a)}}_buildDocumentation(e){var t,s=this.types;if(e){var i=e.text,a=this.builder.create(s.DOCUMENTATION,{enconding:"utf-8",headless:!0});a.text(i||""),t=Object(Hi.a)(a.end({pretty:!0}))}return t}_buildTaskForms(e){var t="",s=this.types;if(e){var i=this.builder.create("forms",{enconding:"utf-8",headless:!0});e.forEach(e=>{var t=e.step,a=e.EForms,n=e.PForms;a&&n&&a.concat(n).forEach(e=>{var a=e.id,n=e.order,r={frmId:a,frmType:e.type,frmStepId:t,frmOrder:n};i.ele(s.FORM,r)})}),t=Object(Hi.a)(i.end({pretty:!0}))}return t}_buildWorkflowForms(e){var t="";if(e){var s=this.builder.create("forms",{enconding:"utf-8",headless:!0});e.forEach(e=>{var t=e.name,i=e.title,a={frmId:e.id,frmName:t||i||"",frmTitle:i||t||""},n=s.ele("form",a);this._buildAttributesWorkflowForm(n,e.attributes),this._buildEvents(e.events,n)}),t=Object(Hi.a)(s.end({pretty:!0}))}return t}_buildAttributesWorkflowForm(e,t){if(t){var s=this.types;t.forEach(t=>{var i=t.name,a=t.label,n=t.dataType,r={attName:i||a||"",attLabel:a||i||"",attTooltip:"",fieldtype:t.fieldType,datatype:n,grid:t.grid||"",regExp:t.regex||""};e.ele(s.ATTRIBUTE,r)})}return e}_buildEvents(e,t){var s,i=this.types;return e&&(s=t?t.ele("events"):s=this.builder.create("events",{enconding:"utf-8",headless:!0}),e.forEach(e=>{var t=e.name,a=e.busClaName,n=e.busClaDesc,r={evtName:t,busClaName:a||n||"",busClaDesc:n||a||"",evtExecOrder:e.order};s.ele(i.EVENT,r)})),t||s}_extractInfo(e,t){var s=t.properties.documentation,i=this.types,a=!1,n=!1;this.parser.onopentag=e=>{var s=e.name,r=e.attributes;switch(s){case i.FORM:this._addFormProperties(t,r),a=!0;break;case i.ATTRIBUTE:this._addAttributeProperties(t,r);break;case i.EVENT:this._addEventProperties(t,r,a);break;case i.DOCUMENTATION:n=!0}},this.parser.ontext=e=>{var t=e.trim();this.parser.tag.name===i.DOCUMENTATION&&(s.text=t||"")},this.parser.onclosetag=e=>{e===i.FORM&&(a=!1)},this.parser.onerror=()=>{this.parser.error=null,this.parser.resume()},this.parser.write(e).close(),""!==s.text&&n||delete t.properties.documentation}static extractUnmodifiedInfo(e,t){var s="",i=!1,a=!1,n=Object(Hi.b)(e);return t.onopentag=({name:e})=>{"forms"!==e&&"events"!==e||(a=!0),"documentation"===e&&(i=!0)},t.ontext=e=>{s=i?e.trim():""},t.onclosetag=e=>{"documentation"===e&&(i=!1)},t.onerror=()=>{t.error=null,t.resume()},t.write(n).close(),{textDoc:s,otherTags:a}}_addFormProperties(e,t){var s=e.properties,i=e.elementType;s.forms||(s.forms=[]);var a=s.forms,n=t.frmId;i===A.WORKFLOW?this._addWorkflowFormProperties(a,parseInt(n,10),t):this._addTaskFormProperties(a,parseInt(n,10),t)}_addWorkflowFormProperties(e,t,s){var i={id:t,name:s.frmName,title:s.frmTitle};e.push(i)}_addTaskFormProperties(e,t,s){var i=s.frmType,a=s.frmStepId,n=s.frmOrder,r=e.find(e=>e.step===parseInt(a,10));r||(r={id:e.length,step:parseInt(a,10),name:"Step",EForms:[],PForms:[],entity:"0",process:"0"},e.push(r));var o="E"===i?r.EForms||[]:r.PForms||[];o.push({id:t,order:parseInt(n,10),type:i}),r["E"===i?"entity":"process"]=o.length.toString()}_addAttributeProperties(e,t){var s=e.properties.forms,i=s.pop();i.attributes||(i.attributes=[]);var a=i.attributes,n=t.attName,r=t.attLabel,o=t.fieldtype,l=t.datatype,h=t.regExp,c=t.grid;a.push({id:a.length+1,name:n,label:r,fieldType:o,dataType:l,regex:h,grid:c}),s.push(i)}_addEventProperties(e,t,s){var i=e.properties,a=t.evtName,n=t.busClaName,r=t.busClaDesc,o=t.evtExecOrder,l={name:a,busClaName:n,busClaDesc:r,order:parseInt(o,10)},h=i.forms,c={};s&&(c=h.pop()),s&&!c.events&&(c.events=[]),s||i.events||(i.events=[]);var p=s?c.events:i.events;p.push(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Gi(Object(s),!0).forEach((function(t){ji(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Gi(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({id:p.length+1},l)),s&&h.push(c)}}function Yi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Ki(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Yi(Object(s),!0).forEach((function(t){Zi(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Yi(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Zi(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Xi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class Ji extends me.a{constructor(e="",t){super(),this.xml=e,this.parser=is.a.parser({normalize:!0,strict:!1,trim:!0}),this.editor=t,this.builder=Oi.a,this.tagsTypes={Task:"Task",Event:"Event",Start:"Start",Intermediate:"Intermediate",End:"End",Gateway:"Gateway",Connector:"Connector",Pool:"Pool",Lane:"Lane",Subprocess:"Subprocess",DataObject:"DataObject",DataStore:"DataStore",DataInput:"DataInput",DataOutput:"DataOutput",Group:"Group",TextAnnotation:"TextAnnotation",Artifact:"Artifact",Activity:"Activity",DataInputOutput:"DataInputOutput",Workflow:"Workflow"},this.xpdl="Offline"!==A.ENV?"":"xpdl:",this._id=0}set id(e){this._id=e}_toIntegerId(e){return parseInt(e,10)}_getConnectorByIdContains(e,t){return e.filter(e=>e.elementType===A.CONNECTOR).filter(e=>e.from===t||e.to===t)}_checkBoundaryEvents(e,t,s){var i=e.filter(e=>e.elementType===A.INTERMEDIATE_EVENT&&e.isAttached&&e.properties.target===t.id);i.length>0&&i.forEach(e=>{e.properties.target=s})}_checkTaskSchedule(e,t,s){e.elementType===A.TASK&&ze(A.TASK,t).forEach(t=>{if(t.scheduleTask&&!t.scheduleSubprocessName){var i=t.properties.schedule;parseInt(e.id,10)===parseInt(i.task,10)&&(i.task=s)}})}_attachConnectors(e){e.forEach(t=>{t.elementType!==A.WORKFLOW&&t.elementType!==A.CONNECTOR&&(t.properties.connectors={connectorsFrom:Qe(t,e,"from"),connectorsTo:Qe(t,e,"to")})})}_updateConnectors(e,t){var s=e.properties.connectors,i=s.connectorsFrom,a=s.connectorsTo;this._updateIdEachProperties("from",t,i),this._updateIdEachProperties("to",t,a)}_updateIdEachProperties(e,t,s){s.forEach(s=>{s.properties[e]=t})}_elementsIdRemapping(e){this._attachConnectors(e);var t=A.START_ID_REMAPPING,s=Ri()(),i=e.find(e=>e.elementType===A.WORKFLOW);if(i){var a=i.properties;a.packageId=s++,a.defaultPool.id=s++,"Offline"===A.ENV&&(a.id=s++,a.defaultPool.processId=a.id),a.documentation&&(a.documentation.id=s++)}return e.forEach(i=>{var a=i.elementType,n=i.properties;if(a!==A.WORKFLOW){var r=a!==A.POOL&&a!==A.LANE&&a!==A.DATA_INPUT&&a!==A.DATA_OUTPUT&&a!==A.DATA_OBJECT&&a!==A.DATA_STORE&&a!==A.GROUP&&a!==A.TEXT&&a!==A.CONNECTOR,o=n.documentation;o&&(o.id=s++),a!==A.CONNECTOR&&this._updateConnectors(i,r?t:s),a===A.TASK&&this._checkBoundaryEvents(e,i,t),i.id=r?t:s,r?t++:s++}}),[e,s]}_existAnyParticipant(e){for(var t=0;t<e.length;t++){var s=e[t];if(this._isTask(s)&&s.properties.groups)return!0}return!1}_existAnyArtifact(e){for(var t=0;t<e.length;t++){var s=e[t];if(this._isArtifact(s))return!0}return!1}_existAnySubprocessEmbedded(e){for(var t=0;t<e.length;t++){var s=e[t];if(this._isSubprocess(s)&&"embedded"===s.properties.type)return!0}return!1}_existAnyAssociation(e){for(var t=0;t<e.length;t++){var s=e[t];if(s.elementType===A.CONNECTOR&&s.properties.type===A.CONNECTOR_TYPE_ASSOCIATION)return!0}return!1}buildXmlProcessMap(){var e,t=Xi(this._elementsIdRemapping(Se()(this.editor.elements)),2),s=t[0],i=t[1],a=this._getPackageElement();this._existAnyParticipant(s)&&(e=this._getParticipantsElement(a));var n,r,o=this._getPoolsElement(a);this._existAnyArtifact(s)&&(r=this._getArtifactsElement(a)),this._existAnyAssociation(s)&&(n=this._getAssociationsElement(a));var l=this._getDataStoresElement(a),h=this._getWorkflowProcessesElement(a),c=this._createPoolElement(o,void 0,s);this._createNodeGraphicsInfosElement(c,void 0);var p,d=[],u=this._getWorkflowProcessElement(h);this._getProcessHeaderElement(u),this._existAnySubprocessEmbedded(s)&&(p=this._getActivitySetsElement(u));var _=this._getActivitiesElement(u),m=this._getDataInputOutputs(u,s),g=this._getDataStoresReferencesElement(u,s),v=this._getTransitionsElement(u);this._createtWorkflowProcessElement(u,a,s);var b=[];return this._identifyFirstTask(s),s.forEach(t=>{var a=t.elementType;switch(this._isArtifact(t)&&(a=this.tagsTypes.Artifact),this._isActivity(t)&&(a=this.tagsTypes.Activity),(this._isDataInput(t)||this._isDataOutput(t))&&(a=this.tagsTypes.DataInputOutput),a){case this.tagsTypes.Pool:var h=this._createPoolElement(o,t,s);this._getLanesElement(h,s),this._createDocumentationElement(h,t),this._createNodeGraphicsInfosElement(h,t);break;case this.tagsTypes.Artifact:var c=this._createArtifactAcoordingToType(r,t);this._createDocumentationElement(c,t),this._createNodeGraphicsInfosElement(c,t);break;case this.tagsTypes.DataStore:var u=this._createDataStoreElement(l,t,i++),T=u.datastore,y=u.newId;this._createDocumentationElement(T,t),this._createDataStoreReference(g,t,y);break;case this.tagsTypes.Activity:var E=this._createActivityAcoordingToType(_,p,t,e,d,b);this._createDocumentationElement(E,t),this._createNodeGraphicsInfosElement(E,t);break;case this.tagsTypes.Connector:var S=this._createConnectorAcoordingToType(n,v,t);this._createDocumentationElement(S,t),this._createConnectorGraphicsInfosElement(S,t);break;case this.tagsTypes.DataInputOutput:var f=this._createDataInputOrOutputElement(m,t);this._createDocumentationElement(f,t),this._createNodeGraphicsInfosElement(f,t)}}),b.length>0&&b.forEach(e=>{var t=this._getWorkflowProcessElement(h),s=e.subprocessId,i=e.name;t.att("Id",s),t.att("Name",i),this._getProcessHeaderElement(t)}),a.end({pretty:!0})}_identifyFirstTask(e){var t="",s=[];e.forEach(e=>{"StartEvent"===e._elementType&&(t=e.id)}),e.forEach(e=>{"Task"===e._elementType&&e._properties.connectors.connectorsTo.forEach(i=>{i._fromEl&&i._fromEl.id===t&&(e._properties.inFirsTask=!0,s.push(e.id))})}),e.forEach(e=>{"IntermediateEvent"===e._elementType&&(s.find(t=>t===e.target)&&(e._properties.inFirsTask=!0))})}_existsDataStores(e){return 0!==e.filter(e=>this._isDataStore(e)).length}_getDataStoresReferencesElement(e,t){return this._existsDataStores(t)?e.ele("".concat(this.xpdl,"DataStoreReferences")):e}_getLanesElement(e,t){var s=this._getLaneList(t);if(void 0!==s&&0!==s.length){var i=e.ele("xpdl:Lanes");s.forEach(e=>{var t=i.ele("xpdl:Lane",{Id:e.properties.id});"Offline"!==A.ENV&&t.att("apia:ProEleDesignXML",this._getProEleDesignXML(e)),""!==e.properties.name&&t.att("Name",e.properties.name),this._createDocumentationElement(t,e),this._createNodeGraphicsInfosElement(t,e)})}return e}_getDataInputOutputs(e,t){return this._existsDataStores(t)?e.ele("".concat(this.xpdl,"DataInputOutputs")):e}_getTransitionsElement(e){return e.ele("".concat(this.xpdl,"Transitions"))}_getAssociationsElement(e){return e.ele("xpdl:Associations")}getTransitionsElement(e){return e.ele("Transitions")}_getReferences(){return{xmlns:"http://www.statum.biz/2009/APIA.XPDL2.1",xpdl:"http://www.wfmc.org/2008/XPDL2.1",apia:"http://www.statum.biz/2009/APIA.XPDL2.1",newVersion:"http://www.apia.com/2020/VERSION"}}_getProcessHeaderElement(e){return e.ele("".concat(this.xpdl,"ProcessHeader"))}_getActivitySetsElement(e){return e.ele("".concat(this.xpdl,"ActivitySets"))}_getPackageHeaderElement(e){var t=new Date,s=e.ele("".concat(this.xpdl,"PackageHeader"));s.ele("".concat(this.xpdl,"XPDLVersion"),{},"2.1"),s.ele("".concat(this.xpdl,"Vendor"),{},"STATUM"),s.ele("".concat(this.xpdl,"Created"),{},t.toLocaleString())}_getPackageElement(){var e=this.builder.create("".concat(this.xpdl,"Package"),{enconding:"UTF-8",headless:!0},{noDoubleEncoding:!0});return"Offline"!==A.ENV?e.att("xmlns",this._getReferences().xmlns):this._getPackageHeaderElement(e),e.att("xmlns:xpdl",this._getReferences().xpdl),e.att("xmlns:edition",this._getReferences().newVersion),e}_getParticipantsElement(e){return e.ele("".concat(this.xpdl,"Participants"))}_getPoolsElement(e){return e.ele("xpdl:Pools")}_getArtifactsElement(e){return e.ele("".concat(this.xpdl,"Artifacts"))}_getProEleDesignXML(e){var t=parseInt(this._getCoordinates(e).x,10),s=parseInt(this._getCoordinates(e).y,10);return"DESIGN y=".concat(t," x=").concat(s)}_getDataStoresElement(e){return e.ele("".concat(this.xpdl,"DataStores"))}_getWorkflowProcessesElement(e){return e.ele("".concat(this.xpdl,"WorkflowProcesses"))}_getActivitiesElement(e){return e.ele("".concat(this.xpdl,"Activities"))}_getWorkflowProcessElement(e){return e.ele("".concat(this.xpdl,"WorkflowProcess"))}_getImplementationElement(e){return e.ele("".concat(this.xpdl,"Implementation"))}_getTaskTypeElement(e,t){var s,i=t.properties.taskType,a=i.charAt(0).toUpperCase()+i.slice(1);"none"!==i&&(s=e.ele("".concat(this.xpdl,"Task").concat(a)),("service"===i||"receive"===i||"send"===i||"script"===i)&&"Offline"!==A.ENV&&s.att("Implementation","WebService"),"script"===i&&"Offline"!==A.ENV&&s.ele("".concat(this.xpdl).concat(a)));return s}_getCoordinates(e){var t={};return void 0===e?(t.x=0,t.y=0):(t.x=e.x,t.y=e.y),t}_getSize(e){var t={width:0,height:0};return void 0!==e&&void 0!==e.properties.size&&(t=e.properties.size),t}_getArtifactType(e){return e.elementType===this.tagsTypes.TextAnnotation?"Annotation":e.elementType}_getApiaExtensionsElement(e){return e.ele("ApiaExtensions")}_isDataStore(e){return e.elementType===this.tagsTypes.DataStore}_isArtifact(e){return this._isDataObject(e)||this._isTextAnnotation(e)||this._isGroup(e)}_isActivity(e){return this._isEvent(e)||this._isTask(e)||this._isGateway(e)||this._isSubprocess(e)}_isEvent(e){var t=e.elementType;return t==="".concat(this.tagsTypes.Start,"Event")||t==="".concat(this.tagsTypes.End,"Event")||t==="".concat(this.tagsTypes.Intermediate,"Event")}_isLane(e){return e.elementType===this.tagsTypes.Lane}_isTask(e){return e.elementType===this.tagsTypes.Task}_isGateway(e){return e.elementType===this.tagsTypes.Gateway}_isSubprocess(e){return e.elementType===this.tagsTypes.Subprocess}_isDataObject(e){return e.elementType===this.tagsTypes.DataObject}_isTextAnnotation(e){return"TextAnnotation"===e.elementType}_isGroup(e){return e.elementType===this.tagsTypes.Group}_isDataInput(e){return e.elementType===this.tagsTypes.DataInput}_isDataOutput(e){return e.elementType===this.tagsTypes.DataOutput}_fillInputOutputsList(e){return e.filter(e=>this._isDataInput(e)||this._isDataOutput(e))}_filterWorkflowProcess(e){return e.find(e=>e.elementType===this.tagsTypes.Workflow)}_createDataStoreReference(e,t,s){var i=t.properties,a=e.ele("DataStoreReference",{Id:i.id,DataStoreRef:s,State:i.state});return this._createNodeGraphicsInfosElement(a,t),a}_createDataInputOrOutputElement(e,t){var s=t.properties,i=this._isDataInput(t)?"".concat(this.xpdl,"DataInput"):"".concat(this.xpdl,"DataOutput"),a=e.ele(i,{Id:s.id,Name:s.name,IsCollection:s.collection});return"Offline"!==A.ENV&&a.att("apia:ProEleDesignXML",this._getProEleDesignXML(t)),""!==s.state&&a.att("State",s.state),a}_createCoordinateElement(e,t){return e.ele("xpdl:Coordinates",{YCoordinate:t.y,XCoordinate:t.x})}_createConnectorGraphicsInfosElement(e,t){var s=(t.properties||[]).points;if(s){var i=e.ele("xpdl:ConnectorGraphicsInfos").ele("xpdl:ConnectorGraphicsInfo");s.forEach(e=>{this._createCoordinateElement(i,e)})}return e}_createExpressionConditionFragment(e,t){""!==t.expression&&e.ele("".concat(this.xpdl,"Condition"),{type:"CONDITION"}).ele("".concat(this.xpdl,"Expression")).text(t.expression);return e}_createConnectorAcoordingToType(e,t,s){var i=s.properties,a=i.type,n=null,r="Offline"===A.ENV?"Type":"apia:Type";if("transition"===a)(n=t.ele("".concat(this.xpdl,"Transition"),{Id:i.id,From:i.from,To:i.to})).att(r,i.class),"expression"===i.kind&&i.expression&&this._createExpressionConditionFragment(n,i);else{var o=i.direction.charAt(0).toUpperCase()+i.direction.slice(1);n=e.ele("xpdl:Association",{Id:i.id,Target:i.to,Source:i.from,AssociationDirection:"Directional"===o?"From":o})}return""!==i.name&&n.att("Name",i.name),i.executionOrder&&n.att("apia:ExecutionOrder",i.executionOrder),n}_createRoleRefElement(e,t){return void 0!==t.properties.role&&void 0!==t.properties.role.id?e.ele("".concat(this.xpdl,"RoleRef"),{"apia:RoleId":t.properties.role.id,"apia:RoleName":t.properties.role.name}):e}_createPoolElement(e,t,s=[]){var i=void 0!==t?t.properties:{},a=Xi(ze(A.WORKFLOW,s),1)[0],n=a.properties.defaultPool.id,r=e.ele("xpdl:Pool",{Id:t?i.id:n,BoundaryVisible:!(void 0===t),Orientation:"HORIZONTAL"});return r.att("Process",a.properties.id),"Offline"!==A.ENV&&(r.att("apia:ProEleDesignXML",this._getProEleDesignXML(t)),r.att("xmlns:apia",this._getReferences().apia)),void 0===t?r.att("MainPool",!0):r.att("Name",i.name),r}_createtWorkflowProcessElement(e,t,s){return s.forEach(s=>{if("Workflow"===s.elementType){if(e.att("Id",s.properties.id),"Offline"!==A.ENV){e.att("apia:ProAction",s.properties.proAction),e.att("xmlns:apia",this._getReferences().apia);var i=s.properties,a=i.proId,n=i.versionId;a&&e.att("apia:ProId",a),n&&e.att("apia:ProVerId",n)}"Offline"===A.ENV&&s.properties.name&&e.att("Name",s.properties.name),"Offline"!==A.ENV&&this._createApiaProcEventsElement(e,s),this._createDocumentationElement(e,s),t.att("Id",s.properties.packageId)}}),e}_createArtifactElement(e,t){var s=e.ele("".concat(this.xpdl,"Artifact"),{Id:t.properties.id,ArtifactType:this._getArtifactType(t)});return"Offline"!==A.ENV&&(s.att("apia:ProEleDesignXML",this._getProEleDesignXML(t)),s.att("xmlns:apia",this._getReferences().apia)),s}_createArtifactAcoordingToType(e,t){var s=this._createArtifactElement(e,t);switch(t.elementType){case this.tagsTypes.DataObject:this._createDataObjectElement(s,t),s.att("Name",t.properties.name);break;case this.tagsTypes.Group:s.att("Group",t.properties.name),s.att("Name",t.properties.name);break;case this.tagsTypes.TextAnnotation:s.att("TextAnnotation",t.properties.text)}return s}_createDataObjectElement(e,t){var s=e.ele("".concat(this.xpdl,"DataObject"),{Id:t.properties.id,Name:t.properties.name,IsCollection:t.properties.collection});return t.properties.state&&s.att("State",t.properties.state),s}_createDocumentationElement(e,t){var s=t.properties.documentation||{},i=t.elementType,a="Offline"===A.ENV&&(i===A.WORKFLOW||i===A.TASK),n=t.properties;if(""!==s.text&&s.text||a&&(void 0!==n.forms||void 0!==n.events)){var r=e.ele("".concat(this.xpdl,"Object"),{Id:s.id||this.editor.idIndex++}).ele("".concat(this.xpdl,"Documentation"));if("Offline"!==A.ENV||i!==A.WORKFLOW&&i!==A.TASK)s.text&&""!==s.text&&r.text(s.text);else{var o=new qi([]).writeExtract(this.builder,t),l=o.documentation,h=o.forms,c=o.events;r.text("".concat(l||"").concat(h||"").concat(c||""))}return r}return e}_createNodeGraphicsInfosElement(e,t){var s=this._getCoordinates(t),i=this._getSize(t),a=e.ele("xpdl:NodeGraphicsInfos"),n=a.ele("xpdl:NodeGraphicsInfo",{Height:i.height||(t?t.height-10:0),Width:i.width||(t?t.width-10:0)});if(t){var r=t.elementType,o=t.properties;(r===A.TASK||r===A.SUBPROCESS)&&t.properties.color&&(t.properties.color!==A.DEFAULT_SUBP_COLOR&&r===A.SUBPROCESS||t.properties.color!==A.DEFAULT_TASK_COLOR&&r===A.TASK)&&n.att("FillColor",o.color)}return this._createCoordinateElement(n,s),a}_createDataStoreElement(e,t,s){var i=t.properties,a=i.name,n=i.capacity,r=i.unlimit,o=e.ele("".concat(this.xpdl,"DataStore"),{Id:s,Name:a,IsUnlimited:r});return n&&o.att("Capacity",n),{datastore:o,newId:s}}_createApiaProcEventsBusClaParBindingsElement(e,t){var s=e.ele("BusClaParBindings");return t.forEach(e=>{var t=e.busClaParBndValue||"",i=e.attId||-1;if(""!==t||-1!==i){var a=s.ele("BusClaParBinding",{BusClaParId:e.busClaParId,BusClaParName:e.busClaParName,BusClaParType:e.busClaParType,BusClaParBndValue:e.busClaParBndValue});if("V"===e.busClaParBndType){var n=e.busClaParBndValue||"";if("D"===e.busClaParType&&""!==n){var r=n.split("-"),o=new Date(r[0],r[1]-1,r[2]);n=Vi.a.asString(A.DATE_FORMAT,o)}a.att("BusClaParBndType","V"),a.att("BusClaParBndValue",n)}else a.att("AttId",e.attId),a.att("AttTooltip",e.attTooltip),a.att("AttName",e.attName),a.att("BusClaParBndType",e.busClaParBndType)}}),s}_createApiaProcEventsElement(e,t){var s=t.events;if(void 0!==s&&0!==s.length){var i=e.ele("ApiaProEvents");s.forEach(e=>{var t=i.ele("ApiaProEvent",{EvtId:e.eventId,BusClaId:e.busClaId,EvtName:e.name,BusClaName:e.busClaName,ProEvtBusClaExecOrder:e.order});e.condition&&""!==e.condition&&t.att("SkipCond",e.condition);var s=e.bindings||[];return e.bindings.length>0&&this._createApiaProcEventsBusClaParBindingsElement(t,s),i})}return!1}_refactorNumberDate(e){return e<10?"0".concat(e):e}_createEventAcoordingToType(e,t){var s=e.ele("".concat(this.xpdl,"Event")),i=t.properties,a=i.type,n=i.isAttached,r=i.target,o=s.ele("".concat(this.xpdl).concat(t.elementType));if("EndEvent"===t.elementType?o.att("Result",a.charAt(0).toUpperCase()+a.slice(1)):o.att("Trigger",a.charAt(0).toUpperCase()+a.slice(1)),void 0!==t.properties.implementation&&o.att("Implementation",t.properties.implementation),n&&r&&("Offline"!==A.ENV&&o.att("apia:IsAttached",n),o.att("Target",r)),!t.properties.message&&"EndEvent"===t.elementType&&t.properties.events&&t.properties.events.length>1&&"message"===a&&(t.properties.message={catchThrow:"throw"}),"Offline"!==A.ENV&&(t.properties[a]||"multiple"===a)){if("timer"===a||"multiple"===a){var l={"xmlns:apia":this._getReferences().apia,"apia:TimerAttType":"P"};if(t.properties.timer){if(t.properties.timer.attribute){var h=t.properties.timer.attribute;l["apia:TimerAttId"]=h.id,l["apia:TimerAttName"]=h.name,l["apia:TimerAttType"]=h.type.toUpperCase().charAt(0)}var c=t.properties.timer.date||{};if(c.start&&(t.elementType===A.START_EVENT||t.elementType===A.INTERMEDIATE_EVENT)){var p=t.properties.timer.date.start;l.TimeDate=Vi.a.asString("yyyy/MM/dd hh:mm:ss",p)}if(t.properties.timer.frequency){var d=t.properties.timer.frequency,u=d.unit,_=d.value;l["apia:TimeUnit"]=u,l.TimeCycle=_}if(t.elementType===A.START_EVENT&&c.end){var m=t.properties.timer.date.end;l["apia:EndDate"]=Vi.a.asString("yyyy/MM/dd hh:mm:ss",m)}(l["apia:EndDate"]||l.TimeDate)&&(l["apia:TimeUnit"]="Milliseconds"),o.ele("".concat(this.xpdl,"TriggerTimer"),l)}}if("message"===a||"multiple"===a){var g=o.ele("".concat(this.xpdl,"TriggerResultMessage"));t.properties.message.catchThrow&&g.att("CatchThrow",t.properties.message.catchThrow.toUpperCase()),"Offline"!==A.ENV&&(g.ele("ApiaExtensions"),this._createWebServiceMappingElement(g,t),this._createApiaEventsElement(s,t))}}return this._createTransitionsRefElement(e,t),s}_getAllTransitionConnectors(){for(var e=this.editor.elements,t=[],s=0;s<e.length;s++){var i=e[s];i.elementType===A.CONNECTOR&&i.type===A.CONNECTOR_TYPE_TRANSITION&&t.push(i)}return t}_isIdealElementToHaveTransitionRef(e){var t=e.elementType;return t===A.TASK||t===A.START_EVENT||t===A.END_EVENT||t===A.INTERMEDIATE_EVENT||t===A.SUBPROCESS||t===A.GATEWAY}_getTransitionArrayFromElements(e){var t=[],s=this._getAllTransitionConnectors();return this._isIdealElementToHaveTransitionRef(e)&&s.forEach(s=>{s.from===e.id&&t.push(s.id)}),t.length<2?[]:t}_createTransitionsRefElement(e,t){var s=this._getTransitionArrayFromElements(t);if(s.length>1){if(void 0!==s){var i=e.ele("".concat(this.xpdl,"TransitionRestrictions")).ele("".concat(this.xpdl,"TransitionRestriction")).ele("".concat(this.xpdl,"Split"),{Type:"Parallel"}).ele("".concat(this.xpdl,"TransitionRefs"));return s.forEach(e=>{i.ele("".concat(this.xpdl,"TransitionRef"),{Id:e})}),i}}return e}_createWebServiceMappingElement(e,t){var s=t.properties.message;if(!(void 0===s.webService||void 0===s.attrEnt&&void 0===s.attrProc||s.attrEnt===[]&&s.attrProc===[])){var i="IntermediateEvent"!==t._elementType||t._properties.inFirsTask?"WEBSERVICE_PRO":"WEBSERVICE_TSK",a="IntermediateEvent"!==t._elementType||t._properties.inFirsTask?"WS_ATTRIBUTE_PRO":"WS_ATTRIBUTE_TSK",n=e.ele("WebServiceMapping").ele(i,{ws_method_name:s.webService});return s.attrProc=s.attrProc||[],s.attrEnt=s.attrEnt||[],s.attrEnt.concat(s.attrProc).forEach(e=>{n.ele(a,{name:e.name,attribute_uk:e.uk?"T":"F",multivalued:e.multivalued?"T":"F",attribute_id:e.id,attribute_type:e.type})}),n}return e}_createActivityElement(e,t){var s=t.properties.activity,i=s.name,a=s.id,n=s.proId,r=s.versionId,o=s.proEleId,l=""!==i&&void 0!==i?i:t.properties.name,h=e.ele("".concat(this.xpdl,"Activity"),{Id:a}),c="Offline"!==A.ENV;return""!==l&&h.att("Name",l),c&&h.att("apia:ProEleDesignXML",this._getProEleDesignXML(t)),o&&c&&t.elementType===A.TASK&&h.att("apia:ProEleId",o),n&&c&&h.att("apia:ProId",n),r&&c&&h.att("apia:ProVerId",r),h}_createGatewayAcoordingToType(e,t){var s=t.properties.type,i=e.ele("".concat(this.xpdl,"Route"),{GatewayType:s.charAt(0).toUpperCase()+s.slice(1),MarkerVisible:t.properties.visible||!0}),a=t.properties.executionType;return a&&"Offline"!==A.ENV&&i.att("apia:ExecutionType",a.replace(/^./,a[0].toUpperCase())),"exclusive"===s&&i.att("ExlusiveType","Data"),this._createTransitionsRefElement(e,t),i}_createSubprocessAcoordingToType(e,t,s,i){var a="",n={};if("embedded"===s.properties.type)a="".concat(this.xpdl,"BlockActivity"),n={ActivitySetId:s.properties.activitySetId},t.ele("".concat(this.xpdl,"ActivitySet"),{Id:n.ActivitySetId,Name:s.properties.name}),e.ele(a,n);else{a="".concat(this.xpdl,"SubFlow");var r=s.properties,o=r.reusable,l=r.subprocessId,h=r.name;if(i.push({subprocessId:l,name:h}),n={Id:l,Name:h},o&&"Offline"!==A.ENV){var c="synchronized"===o.execution?"SYNCHR":"ASYNCHR";n=Ki(Ki({},n),{},{"apia:ProEleAttBusEntId":o.entityId,"apia:ProEleAttBusEntName":o.entityAttrName,"apia:ApiaExecution":o.skipFirst?"".concat(c,"_SKIP"):c}),o.skipFirst&&(n["apia:SkipFirstTask"]=o.skipFirst)}var p=this._getImplementationElement(e).ele(a,n);this._createFormRefsElement(p,s)}return this._createTransitionsRefElement(e,s),this._createLoopElement(e,s),e}_createForm(e,t,s,i){return t.forEach(t=>{var a=e.ele("FormRef",{ProEleFrmStepId:i});a.att("ProEleFrmOrder",t.order),a.att("FrmType",t.formType),a.att("FrmName",t.name),a.att("FrmId",t.id),s.elementType===this.tagsTypes.Task&&(a.att("ProEleFrmReadOnly",t.readOnly),a.att("ProEleFrmMultiply",t.multiply));var n=t.condition||"";""!==(t.conditionDoc||"")&&a.att("ConditionDoc",t.conditionDoc),""!==n&&a.att("ProEleFrmEvalCond",t.condition)}),e}_createFormRefsElement(e,t){var s=t.properties,i=(s||[]).forms;if(this._isSubprocess(t)&&s.reusable&&(i=s.reusable.forms),void 0!==i){var a=e.ele("".concat(this.xpdl,"FormsRef")),n=1;i.forEach(e=>{if(this._isSubprocess(t)){var s=a.ele("".concat(this.xpdl,"FormRef"),{ProEleFrmStepId:n++});s.att("ProEleFrmOrder",e.order),s.att("FrmType",e.formType),s.att("FrmName",e.name),s.att("FrmId",e.id)}else{var i=e.EForms||[],r=e.PForms||[],o=i.concat(r);this._createForm(a,o,t,n),n++}})}return e}_getDefaultApiaEvent(){return{eventId:11,busClaId:102,WS:!1,order:0,name:"ONREADY",busClaName:"BPMNAutoComplete"}}_createApiaEventsElement(e,t){var s=t.properties,i=s.events||[],a=s||{},n=a.outputMessageRef;if("script"===a.taskType&&0===i.length&&i.push(this._getDefaultApiaEvent()),n&&(i=i.concat(n)),void 0!==i){var r=e.ele("ApiaEvents");i.forEach(e=>{var t={EvtId:e.eventId,BusClaId:e.busClaId,BusClaName:e.busClaName,EvtName:e.name,ProEleEvtBusClaExecOrder:e.order};""!==e.condition&&(t.SkipCond=e.condition),e.WS&&(t.WS=e.WS);var s=r.ele("ApiaEvent",t),i=(e||[]).bindings;if(void 0!==i){var a=s.ele("BusClaParBindings");i.forEach(e=>{var t=e.busClaParBndValue||"",s=e.attId||-1;if(""!==t||-1!==s){var i={BusClaParName:e.busClaParName,BusClaParId:e.busClaParId,BusClaParType:e.busClaParType,AttTooltip:e.attTooltip,BusClaParBndValue:e.busClaParBndValue,BusClaParBndType:e.busClaParBndType,AttName:e.attName,AttId:e.attId};if("D"===i.BusClaParType&&""!==t){var n=t.split("-"),r=new Date(n[0],n[1]-1,n[2]);i.BusClaParBndValue=Vi.a.asString(A.DATE_FORMAT,r)}var o="E"===i.busClaParBndType;("P"===i.busClaParBndType||o)&&-1===i.AttId&&(i=Ki(Ki({},this._deleteAttrProperties(i)),{},{BusClaParBndType:"V",BusClaParBndValue:""})),a.ele("BusClaParBinding",i)}})}})}return e}_deleteAttrProperties(e){return delete e.AttTooltip,delete e.AttName,delete e.AttId,e}_createLoopElement(e,t){var s=t.properties,i=s.loopType;if("multiinstance"===i||"standard"===i){var a="Loop",n=e.ele("".concat(this.xpdl).concat(a)),r="";if("standard"===s.loopType){r="Standard",s.standard||(s.standard={});var o=n.ele("".concat(this.xpdl).concat(a).concat(r),{TestTime:s.standard.testTime||"After"});""!==s.standard.condition&&o.att("LoopCondition",s.standard.condition),""!==s.standard.conditionDoc&&o.att("apia:ConditionDoc",s.standard.conditionDoc)}else if("multiinstance"===s.loopType){r="MultiInstance";var l=n.ele("".concat(this.xpdl).concat(a).concat(r));l.att("MI_FlowCondition","All"),l.att("MI_Ordering","Parallel");var h=s.multiInstance||{};""!==h.attribute&&"Offline"!==A.ENV&&(l.att("apia:MultiplierAttName",h.attribute),l.att("apia:MultiplierAttId",h.attributeId)),(s.multiplyCount||h.value)&&l.att("MI_Condition",s.multiplyCount||h.value)}n.att("LoopType",r)}return e}_participantExist(e,t){return t.find(t=>t.id===e.id)}_getDefaultPerformer(){return{id:2,name:"busClass"}}createPerformersElement(e,t,s,i){var a=t.properties,n=a.taskType,r="service"===n||"receive"===n||"send"===n||"script"===n;if(void 0!==a.groups||r&&"Offline"!==A.ENV){var o=e.ele("".concat(this.xpdl,"Performers")),l=a.groups||[];r&&0===l.length&&"Offline"!==A.ENV&&l.push(this._getDefaultPerformer()),l.forEach(e=>{var t;if("Offline"!==A.ENV&&(t={"apia:PerfId":e.id,"apia:PerfName":e.name}),e.conditionDoc&&(t["apia:ConditionDoc"]=e.conditionDoc),e.condition&&(t["apia:ProElePerfEvalCond"]=e.condition),"Offline"!==A.ENV?o.ele("".concat(this.xpdl,"Performer"),t):o.ele("".concat(this.xpdl,"Performer"),e.id),"busClass"!==e.name&&!this._participantExist(e,i)){i.push(e);var a="".concat(this.xpdl,"ParticipantType");s.ele("".concat(this.xpdl,"Participant"),{Id:e.id,Name:e.name}).ele(a,{Type:"ROLE"})}})}return e}_createApiaTaskStates(e,t){var s=(t.properties||[]).states;if(void 0!==s){var i=e.ele("ApiaTskStates");s.forEach(e=>{var t=i.ele("ApiaTskState",{EvtName:e.event,EntStaId:e.idName,EvtId:e.idEvent,StaName:e.name});""!==e.condition&&t.att("ProEleBusEntStaEvalCond",e.condition),""!==e.conditionDoc&&t.att("ConditionDoc",e.conditionDoc)})}return e}_createTaskAcoordingToType(e,t,s,i){var a=t.properties,n=this._getImplementationElement(e),r="Offline"===A.ENV,o=r?n.ele("".concat(this.xpdl,"Task")):n.ele("".concat(this.xpdl,"Task"),{"apia:TskId":a.taskId,"apia:TskTitle":a.title,"apia:TskName":a.name,"apia:highlight_comments":a.comments});if(""===a.condition||r?""!==a.condition||r||o.att("apia:SkipTsk",!1):(o.att("apia:SkipTskCond",a.condition),o.att("apia:SkipTsk",!0)),a.schedule&&!r){var l=a.schedule;""!==l.task&&""!==l.id&&""!==l.type&&(o.att("apia:ActiveTskId",l.task),o.att("apia:TskSchId",l.id),o.att("apia:AsignType",l.type),""!==l.subprocess&&o.att("apia:ActivePrcId",l.subprocess),""!==l.subprocessName&&o.att("apia:ActivePrcName",l.subprocessName))}var h=this._getTaskTypeElement(o,t);r||("none"!==t.properties.taskType&&(this._getApiaExtensionsElement(h),this._createWebServiceMappingTaskElement(h,t)),this._createRoleRefElement(o,t),this._createFormRefsElement(o,t),this._createApiaTaskStates(o,t),this._createTransitionsRefElement(e,t),this._createApiaEventsElement(e,t));return this.createPerformersElement(e,t,s,i),this._createLoopElement(e,t),e}_createWebServiceMappingTaskElement(e,t){var s=t.properties.inputMessageRef;if(s){var i=t._properties.inFirsTask?"WEBSERVICE_PRO":"WEBSERVICE_TSK",a=e.ele("WebServiceMapping").ele(i,{ws_method_name:s.wsMethodName});this._createWebServiceAttributeTaskElement(a,s)}return e}_createWebServiceAttributeTaskElement(e,t){var s=t.attrEnt,i=t.attrProc;if(s||i){var a=[];s&&(a=a.concat(s)),i&&(a=a.concat(i));for(var n="WEBSERVICE_PRO"===e.name?"WS_ATTRIBUTE_PRO":"WS_ATTRIBUTE_TSK",r=0;r<a.length;r++)e.ele(n,{attribute_id:a[r].id,name:a[r].name,multivalued:a[r].multivalued?"T":"F",attribute_type:a[r].type,attribute_uk:a[r].uk?"T":"F"})}return e}_createActivityAcoordingToType(e,t,s,i,a,n){var r=this._createActivityElement(e,s);return this._isEvent(s)&&this._createEventAcoordingToType(r,s),this._isGateway(s)&&this._createGatewayAcoordingToType(r,s),this._isSubprocess(s)&&this._createSubprocessAcoordingToType(r,t,s,n),this._isTask(s)&&this._createTaskAcoordingToType(r,s,i,a),r}_filterTagName(e){var t=e.split(":");t.length>1?t=Xi(t,2)[1]:t=Xi(t,1)[0];return t.toLowerCase()}_addActivityProperties(e){var t={id:this._toIntegerId(e.Id),name:unescape(e.Name||"")};return e["apia:ProEleId"]&&(t.proEleId=this._toIntegerId(e["apia:ProEleId"])),e["apia:ProId"]&&(t.proId=this._toIntegerId(e["apia:ProId"])),e["apia:ProVerId"]&&(t.versionId=this._toIntegerId(e["apia:ProVerId"])),t}_addTaskProperties(e,t){return t.taskId=this._toIntegerId(e["apia:TskId"])||t.activity.id||"",t.id=t.activity.id,t.taskType="none",t.name=unescape(e["apia:TskName"]||"")||t.activity.name||"",t.title=unescape(e["apia:TskTitle"]||"")||t.activity.name||"",t.comments=JSON.parse(e["apia:highlight_comments"]||!1),t.condition=unescape(e["apia:SkipTskCond"]||""),t.loopType="none",t}_addScheduleTaskProperties(e,t){if(void 0!==e["apia:TskSchId"]){var s={id:this._toIntegerId(e["apia:TskSchId"])||"",type:e["apia:AsignType"]||"",subprocess:this._toIntegerId(e["apia:ActivePrcId"])||"",subprocessName:e["apia:ActivePrcName"]||"",task:this._toIntegerId(e["apia:ActiveTskId"])||""};t.schedule=s}return t}_addRoleTaskProperties(e,t){var s={id:this._toIntegerId(e["apia:RoleId"]),name:unescape(e["apia:RoleName"]||"")};return t.role=s,t}_addGroupTaskproperties(e,t){var s=!1;if(e["apia:PerfId"]&&e["apia:PerfName"]){var i={id:this._toIntegerId(e["apia:PerfId"]),name:unescape(e["apia:PerfName"]||"")};e["apia:ConditionDoc"]&&(i.conditionDoc=unescape(e["apia:ConditionDoc"]||"")),e["apia:ProElePerfEvalCond"]&&(i.condition=unescape(e["apia:ProElePerfEvalCond"]||"")),t.groups=this._addArrayProperties(i,t.groups)}else s=!0;return{properties:t,textPerf:s}}_getStepIndex(e,t){var s=0;return t.length>0&&(s=t.findIndex(t=>parseInt(t.id,10)===parseInt(e,10))),s}_addFormsProperties(e,t,s){var i=this._getStepIndex(e.ProEleFrmStepId,s.forms||[]),a={id:this._toIntegerId(e.FrmId),name:unescape(e.FrmName||""),order:parseInt(e.ProEleFrmOrder,10)};if(void 0!==e.ConditionDoc&&(a.conditionDoc=unescape(e.ConditionDoc||"")),t!==this.tagsTypes.Subprocess){a.formType=e.FrmType,a.readOnly=JSON.parse(e.ProEleFrmReadOnly||"false"),a.multiply=JSON.parse(e.ProEleFrmMultiply||"false"),a.condition=unescape(e.ProEleFrmEvalCond||"");var n={id:this._toIntegerId(e.ProEleFrmStepId)};-1===i?(i=s.forms.length,s.forms=this._addArrayProperties(n,s.forms)):0!==i||s.forms||(s.forms=this._addArrayProperties(n,s.forms)),s.forms[i]["".concat(e.FrmType,"Forms")]=this._addArrayProperties(a,s.forms[i]["".concat(e.FrmType,"Forms")])}else void 0!==s.reusable&&(a.step=parseInt(e.ProEleFrmStepId,10),a.formType=e.FrmType,s.reusable.forms=this._addArrayProperties(a,s.reusable.forms));return s}_addEventsProperties(e,t,s,i){var a=t.events||[],n={id:JSON.parse(e.WS||"false")&&s===this.tagsTypes.Task?t.outputMessageRef?t.outputMessageRef.length+1:1:a.length+1,eventId:this._toIntegerId(e.EvtId),condition:e.SkipCond||"",busClaId:this._toIntegerId(e.BusClaId),busClaName:e.BusClaName,name:e.EvtName,order:this._toIntegerId(e.ProEleEvtBusClaExecOrder),WS:JSON.parse(e.WS||"false"),bindings:[]};n.haveCond=n.condition&&""!==n.condition?"Yes":"No";var r=t.taskType||"",o="user"===r||"recive"===r||"send"===r||"service"===r;return n.WS&&s===this.tagsTypes.Task&&o?(t.outputMessageRef=this._addArrayProperties(n,t.outputMessageRef),i="outputMessageRef"):(t.events=this._addArrayProperties(n,t.events),i="events"),{properties:t,webServiceCtrl:i}}_addBusinessClassProperties(e,t,s){var i=t[s];if(void 0!==i){var a=i.pop(),n={busClaParName:e.BusClaParName,busClaParId:this._toIntegerId(e.BusClaParId),busClaParType:e.BusClaParType,busClaParBndType:e.BusClaParBndType};if("V"===n.busClaParBndType){var r=e.BusClaParBndValue;"D"===n.busClaParType?(""===e.BusClaParBndValue&&(r=Date.now()),Ui.a.extend(zi.a),n.busClaParBndValue=Ui()(r,A.DATE_FORMAT.toUpperCase()).format("YYYY-MM-DD")):n.busClaParBndValue=e.BusClaParBndValue}"E"!==n.busClaParBndType&&"P"!==n.busClaParBndType||(n.attId=this._toIntegerId(e.AttId),n.attTooltip=e.AttTooltip,n.attName=e.AttName),a.bindings=this._addArrayProperties(n,a.bindings),t[s]=this._addArrayProperties(a,t[s])}return t}_addLoopTypeProperties(e,t){return t.loopType=void 0!==e.LoopType?e.LoopType.toLowerCase():"none",t}_addMultiInstanceLoopProperties(e,t){var s=!1,i=!1;return e["apia:MultiplierAttName"]&&e["apia:MultiplierAttId"]&&(t.multiInstance={type:"attribute",attribute:e["apia:MultiplierAttName"],attributeId:this._toIntegerId(e["apia:MultiplierAttId"]),condition:e.MI_FlowCondition,ordering:e.MI_Ordering},s=!0),e.MI_Condition&&"Offline"===A.ENV&&(t.multiplyCount=parseInt(e.MI_Condition,10),i=!0),"Offline"!==A.ENV&&e.MI_Condition&&(t.multiInstance={type:"value",value:parseInt(e.MI_Condition,10)},i=!0),i||s||(t.multiInstance={type:"value",value:parseInt(e.MI_Condition,10)}),t}_addStandardLoopProperties(e,t){return t.standard={condition:e.LoopCondition||"",conditionDoc:e["apia:ConditionDoc"]||"",testTime:e.TestTime},t}_addStateTaskProperties(e,t){var s={id:(t.states||[]).length+1,condition:e.ProEleBusEntStaEvalCond,idEvent:this._toIntegerId(e.EvtId),event:e.EvtName,idName:this._toIntegerId(e.EntStaId),name:e.StaName,conditionDoc:e.ConditionDoc};return t.states=this._addArrayProperties(s,t.states),t}_addEventTypeProperties(e,t){var s=e.Trigger||e.Result||"none";return s=s.toLowerCase(),t.type=s,e.Target&&(t.target=this._toIntegerId(e.Target),t.isAttached=!0),e["apia:IsAttached"]&&(t.isAttached=JSON.parse(e["apia:IsAttached"])),t}_addEventImplementationProperties(e,t){return void 0!==e.Implementation&&(t.implementation=e.Implementation),t}_addTriggerResultMessageProperties(e,t){return void 0!==e.CatchThrow&&(t.message={},t.message.catchThrow=e.CatchThrow.toLowerCase()),t}_addTriggerTimerProperties(e,t){var s={};return e.TimeDate&&(s.date||(s.date={}),s.date.start=new Date(e.TimeDate)),e["apia:EndDate"]&&(s.date||(s.date={}),s.date.end=new Date(e["apia:EndDate"])),e["apia:TimeUnit"]&&e.TimeCycle&&(s.frequency={unit:"Milliseconds"===e["apia:TimeUnit"]?"Minutes":e["apia:TimeUnit"],value:e.TimeCycle||0}),e["apia:TimerAttId"]&&e["apia:TimerAttName"]&&(s.attribute={id:this._toIntegerId(e["apia:TimerAttId"]),name:e["apia:TimerAttName"],type:"P"===e["apia:TimerAttType"]?"process":"entity"}),Ki(Ki({},t),{},{timer:s})}_addWebServiceAttributeProcessOrTaskProperties(e,t,s){var i={id:this._toIntegerId(e.attribute_id),name:e.name,multivalued:"T"===e.multivalued,type:e.attribute_type,uk:"T"===e.attribute_uk};return"E"===i.type?t[s].attrEnt=this._addArrayProperties(i,t[s].attrEnt):t[s].attrProc=this._addArrayProperties(i,t[s].attrProc),t}_addRouteGatewayProperties(e,t){return t.id=t.activity.id,t.type=void 0!==e.GatewayType?e.GatewayType.toLowerCase():"none",t.name=t.activity.name||"",e.MarkerVisible&&(t.visible=JSON.parse(e.MarkerVisible)),void 0!==e["apia:ExecutionType"]&&(t.executionType=e["apia:ExecutionType"].toLowerCase()),void 0!==e.ExclusiveType&&(t.exclusiveType=e.ExclusiveType),t}_addTransitionReferenceProperties(e,t){return t.transitions=this._addArrayProperties(this._toIntegerId(e.Id),t.transitions),t}_addTransitionOrAssociationProperties(e,t){var s={id:this._toIntegerId(e.Id),type:t,name:unescape(e.Name||""),from:this._toIntegerId(e.From)||this._toIntegerId(e.Source),to:this._toIntegerId(e.To)||this._toIntegerId(e.Target)};if(e["apia:ExecutionOrder"]&&(s.executionOrder=this._toIntegerId(e["apia:ExecutionOrder"])),"transition"===t&&(s.class=e["apia:Type"]||e.Type),"association"===t){var i="from"===e.AssociationDirection.toLowerCase()?"directional":e.AssociationDirection.toLowerCase();s.direction=i||"none"}return s}_addBlockActivitySubprocessProperties(e,t){return t.id=t.activity.id,t.activitySetId=this._toIntegerId(e.ActivitySetId),t.name=t.activity.name,t.type="embedded",t.loopType="none",t}_addSubflowSubprocessProperties(e,t){return t.id=t.activity.id,t.subprocessId=this._toIntegerId(e.Id),t.name=unescape(e.Name||""),t.type="reusable",t.loopType="none",e["apia:ApiaExecution"]&&(t.reusable||(t.reusable={}),t.reusable.execution="SYNCHR_SKIP"===e["apia:ApiaExecution"]||"SYNCHR"===e["apia:ApiaExecution"]?"synchronized":"not_synchronized"),e["apia:SkipFirstTask"]&&(t.reusable.skipFirst=JSON.parse(e["apia:SkipFirstTask"])),e["apia:ProEleAttBusEntId"]&&(t.reusable.entityId=this._toIntegerId(e["apia:ProEleAttBusEntId"]),t.reusable.entityAttrName=e["apia:ProEleAttBusEntName"]),t}_addArtifactProperties(e,t){return(t={id:this._toIntegerId(e.Id),type:e.ArtifactType}).type=t.type.toLowerCase(),"group"===t.type&&(t.name=unescape(e.Name||"")),"annotation"===t.type&&(t.text=unescape(e.TextAnnotation||"")),t}_defineArtifactToBuildAcoordingToType(e){var t;return"group"===e.type&&(t=this.tagsTypes.Group),"annotation"===e.type&&(t=this.tagsTypes.TextAnnotation),t}_addPoolProperties(e){return JSON.parse(e.BoundaryVisible)?{id:this._toIntegerId(e.Id),name:e.Name||"",processId:this._toIntegerId(e.Process),visible:JSON.parse(e.BoundaryVisible)}:{}}_addDefaultPoolProperties(e){return JSON.parse(e.BoundaryVisible)?{}:{id:this._toIntegerId(e.Id),processId:this._toIntegerId(e.Process)}}_addLanesProperties(e,t){var s={id:this._toIntegerId(e.Id),name:unescape(e.Name||"")};return t.push(s),t}_addDataStoreProperties(e,t){var s={referenceId:this._toIntegerId(e.Id),name:unescape(e.Name||"")};return e.IsUnlimited&&(s.unlimit=JSON.parse(e.IsUnlimited)),e.Capacity&&(s.capacity=e.Capacity),t.push(s),t}_addDataObjectInputOutputProperties(e,t){return t.id=this._toIntegerId(e.Id),t.name=unescape(e.Name||""),t.state=unescape(e.State||""),t.collection=!!e.IsCollection&&JSON.parse(e.IsCollection),t}_addDataStoreReferenceProperties(e,t){var s=t.find(t=>parseInt(t.referenceId,10)===parseInt(e.DataStoreRef,10));return s&&(s.id=this._toIntegerId(e.Id),delete s.referenceId),e.State&&(s.state=unescape(e.State||"")),s}_addDataStoreDocumentationProperties(e,t,s){if(t===this.tagsTypes.DataStore){var i=s.pop();i.documentation={id:this._toIntegerId(e.Id)},s.push(i)}return s}_addObjectDocumentationProperties(e,t,s){return t!==this.tagsTypes.DataStore&&(s.documentation={id:this._toIntegerId(e.Id)}),s}_addCoordinateProperties(e,t,s,i,a){if(""!==t&&!a){var n={x:parseInt(e.XCoordinate,10)*i,y:parseInt(e.YCoordinate,10)*i};s.push(n)}return s}_addApiaProEventsProperties(e,t){var s={id:t.events?t.events.length+1:1,eventId:this._toIntegerId(e.EvtId),condition:e.SkipCond||"",busClaId:this._toIntegerId(e.BusClaId),busClaName:e.BusClaName,name:e.EvtName,order:e.ProEvtBusClaExecOrder,bindings:[]};return s.haveCond=s.condition&&""!==s.condition?"Yes":"No",t.events=this._addArrayProperties(s,t.events),{properties:t,webServiceCtrl:"events"}}_isContaintSizeProperties(e){return e===this.tagsTypes.Group||e===this.tagsTypes.TextAnnotation||e===this.tagsTypes.Pool}_addLanesSizeProperties(e,t,s,i){return t===this.tagsTypes.Pool&&0!==s.length&&void 0===s[s.length-1].size&&(s[s.length-1].size={width:parseInt(e.Width,10)*i,height:parseInt(e.Height,10)*i}),s}_addLanesCoordinatesProperties(e,t,s,i){return t===this.tagsTypes.Pool&&s.length>0&&void 0===s[s.length-1].x&&void 0===s[s.length-1].y&&(s[s.length-1].x=parseInt(e.XCoordinate,10)*i,s[s.length-1].y=parseInt(e.YCoordinate,10)*i),s}_addNodeGraphicsInfoProperties(e,t,s,i){if(this._isContaintSizeProperties(t)){var a={width:parseInt(e.Width,10)*i,height:parseInt(e.Height,10)*i};s.size=a}return s}_buildLanesElement(e,t){e.forEach((s,i)=>{if(i>0){var a=e[i-1],n=this._checkCoordinateLane({x:s.x,y:s.y},a);s.x=n.x,s.y=n.y}var r=t.size.width;r-30!==s.size.width&&(s.size.width=r-30),this.editor.createElement("Lane",s.x,s.y,s,!1)})}_addWorkflowProperties(e,t){return t.id=this._toIntegerId(e.Id),t.proAction=e["apia:ProAction"]||"C","Offline"===A.ENV&&(t.name=e.Name||"Default_Process"),e["apia:ProId"]&&(t.proId=this._toIntegerId(e["apia:ProId"])),e["apia:ProVerId"]&&(t.versionId=this._toIntegerId(e["apia:ProVerId"])),t}_addConnectorsPointsProperties(e,t){return t.points=[],t.points=e,t}_addPackageProperties(e){this.editor.elements.find(e=>"Workflow"===e.elementType).properties.packageId=this._toIntegerId(e.Id)}_addLaneDocumentationProperties(e,t){return t.length>0&&(t[t.length-1].documentation.text=e),t}_addLaneObjectProperties(e,t,s){return t&&s.length>0&&(s[s.length-1].documentation={id:this._toIntegerId(e.Id)}),s}_addColorProperties(e,t,s){return t!==this.tagsTypes.Task&&t!==this.tagsTypes.Subprocess||!e.FillColor||(s.color=e.FillColor||""),s}_addParticipantProperties(e,t){var s=Number.parseInt(e.Id,10),i={id:Number.isNaN(s)?e.Id:s,name:unescape(e.Name||"")};return t.push(i),t}_addParticipantTypeProperties(e,t,s){var i=t.pop(),a=e.Type.split(":");return i.type=1===a.length?a[0]:a[1],t.push(i),e["xmlns:edition"]&&(s=1),{participants:t,ratio:s}}_addPerformerTextProperties(e,t,s){var i=t.find(t=>{var s=Number.parseInt(t.id,10);return Number.isNaN(s)?t.id.toUpperCase()===e.toUpperCase():s===Number.parseInt(e,10)});if(i){var a=i.id,n=i.name;s.groups=this._addArrayProperties({id:a,name:n},s.groups)}return s}_canHaveGroup(e){return"manual"===e||"user"===e||"none"===e}buildProcessMap(){var e=[],t="",s="",i={},a=[],n=[],r=[],o=!1,l={},h={},c=[],p=!1,d=2,u=[],_=[];(this.parser.onopentag=l=>{t=this._filterTagName(l.name);var u=l.attributes;switch(t){case"package":u["xmlns:edition"]&&(d=1);break;case"activity":i.activity=this._addActivityProperties(u);break;case"task":s=this.tagsTypes.Task,i=this._addTaskProperties(u,i),i=this._addScheduleTaskProperties(u,i);break;case"taskuser":i.taskType="user";break;case"taskservice":i.taskType="service";break;case"tasksend":i.taskType="send";break;case"taskreceive":i.taskType="receive";break;case"taskmanual":i.taskType="manual";break;case"taskscript":i.taskType="script";break;case"taskbusinessrule":i.taskType="businessRule";break;case"roleref":i=this._addRoleTaskProperties(u,i);break;case"performer":if("Offline"!==A.ENV&&this._canHaveGroup(i.taskType)){var _=this._addGroupTaskproperties(u,i,p),m=_.properties,g=_.textPerf;i=m,p=g}else p=!0;break;case"formref":i=this._addFormsProperties(u,s,i);break;case"apiaevent":var v=this._addEventsProperties(u,i,s,n),b=v.properties,T=v.webServiceCtrl;i=b,n=T;break;case"busclaparbinding":i=this._addBusinessClassProperties(u,i,n);break;case"loop":i=this._addLoopTypeProperties(u,i);break;case"loopmultiinstance":i=this._addMultiInstanceLoopProperties(u,i);break;case"loopstandard":i=this._addStandardLoopProperties(u,i);break;case"apiatskstate":i=this._addStateTaskProperties(u,i);break;case"event":s=this.tagsTypes.Event,i.id=i.activity.id;break;case"startevent":s="".concat(this.tagsTypes.Start).concat(s),i=this._addEventTypeProperties(u,i),i=this._addEventImplementationProperties(u,i);break;case"intermediateevent":s="".concat(this.tagsTypes.Intermediate).concat(s),i=this._addEventTypeProperties(u,i),i=this._addEventImplementationProperties(u,i);break;case"endevent":s="".concat(this.tagsTypes.End).concat(s),i=this._addEventTypeProperties(u,i),i=this._addEventImplementationProperties(u,i);break;case"triggerresultmessage":i=this._addTriggerResultMessageProperties(u,i);break;case"triggertimer":i.timer={},i=this._addTriggerTimerProperties(u,i);break;case"webservice_pro":i.message?(i.message.webService=u.ws_method_name||"",i.clasification="message"):(i.inputMessageRef={wsMethodName:u.ws_method_name||""},i.clasification="inputMessageRef");break;case"ws_attribute_pro":i=this._addWebServiceAttributeProcessOrTaskProperties(u,i,i.clasification);break;case"webservice_tsk":var y=s==="".concat(this.tagsTypes.Intermediate,"Event")?"message":"inputMessageRef";"message"===y?i.message.webService=u.ws_method_name||"":i[y]={wsMethodName:u.ws_method_name||""};break;case"ws_attribute_tsk":var E=s==="".concat(this.tagsTypes.Intermediate,"Event")?"message":"inputMessageRef";i=this._addWebServiceAttributeProcessOrTaskProperties(u,i,E);break;case"route":s=this.tagsTypes.Gateway,i=this._addRouteGatewayProperties(u,i);break;case"transition":s=this.tagsTypes.Connector,i=this._addTransitionOrAssociationProperties(u,t);break;case"condition":s===this.tagsTypes.Connector&&(i.kind="expression");break;case"association":s=this.tagsTypes.Connector,i=this._addTransitionOrAssociationProperties(u,t);break;case"blockactivity":s=this.tagsTypes.Subprocess,i=this._addBlockActivitySubprocessProperties(u,i);break;case"subflow":s=this.tagsTypes.Subprocess,i=this._addSubflowSubprocessProperties(u,i);break;case"artifact":i=this._addArtifactProperties(u,i),s=this._defineArtifactToBuildAcoordingToType(i);break;case"pool":i=this._addPoolProperties(u),s=void 0!==i.visible?this.tagsTypes.Pool:"",h=this._addDefaultPoolProperties(u);break;case"pools":u["xmlns:edition"]&&(d=1);break;case"lane":r=this._addLanesProperties(u,r),o=!0;break;case"datastore":s=this.tagsTypes.DataStore,a=this._addDataStoreProperties(u,a);break;case"datastorereference":s=this.tagsTypes.DataStore,i=this._addDataStoreReferenceProperties(u,a);break;case"dataobject":s=this.tagsTypes.DataObject,i=this._addDataObjectInputOutputProperties(u,i);break;case"datainput":s=this.tagsTypes.DataInput,i=this._addDataObjectInputOutputProperties(u,i);break;case"dataoutput":s=this.tagsTypes.DataOutput,i=this._addDataObjectInputOutputProperties(u,i);break;case"object":i=this._addObjectDocumentationProperties(u,s,i),a=this._addDataStoreDocumentationProperties(u,s,a),r=this._addLaneObjectProperties(u,o,r);break;case"participant":c=this._addParticipantProperties(u,c);break;case"participanttype":var S=this._addParticipantTypeProperties(u,c,d);c=S.participants,d=S.ratio;break;case"nodegraphicsinfo":i=this._addNodeGraphicsInfoProperties(u,s,i,d),r=this._addLanesSizeProperties(u,s,r,d),i=this._addColorProperties(u,s,i);break;case"coordinates":e=this._addCoordinateProperties(u,s,e,d,o),r=this._addLanesCoordinatesProperties(u,s,r,d,e);break;case"apiaproevent":var f=this._addApiaProEventsProperties(u,i),I=f.properties,C=f.webServiceCtrl;i=I,n=C}},this.parser.oncdata=e=>{var t=e.trim();s===this.tagsTypes.Connector&&"expression"===i.kind&&(i.expression=t)},this.parser.ontext=e=>{var n=this.parser.tag,h=e.trim();if("documentation"===(t=this._filterTagName(n?n.name:""))&&""!==h){if(void 0!==i.documentation&&(i.documentation.text=h,""===s&&(l=i.documentation,"Offline"!==A.ENV&&(l=this._extractRealDocumentationInfo(l))),s===A.TASK&&"Offline"!==A.ENV&&(i.documentation=this._extractRealDocumentationInfo(i.documentation||{}))),s===this.tagsTypes.DataStore){var d=a.pop();d.documentation.text=h,a.push(d),s=""}o&&this._addLaneDocumentationProperties(h,r)}p&&(i=this._addPerformerTextProperties(h,c,i),p=!1),"expression"===t&&s===this.tagsTypes.Connector&&"expression"===i.kind&&(i.expression=h)},this.parser.onclosetag=a=>{var n=this.parser.tag.attributes;if(t=this._filterTagName(a),this._isElementToBuild(t)&&""!==s){if("transition"!==t&&"association"!==t||(i=this._addConnectorsPointsProperties(e,i),"association"===t?u.push(i):_.push(i)),s!==this.tagsTypes.Connector){var c=e.pop(),p=parseInt(c.x,10),d=parseInt(c.y,10);s===this.tagsTypes.Pool&&this._buildLanesElement(r,i),this.editor.createElement(s,p,d,i,!1)}i={},s="",e=[]}("lane"===t&&(o=!1),"workflowprocess"===t)&&((i=this._addWorkflowProperties(n,i)).defaultPool=h,l!=={}&&(i.documentation=l),Xi(ze(A.WORKFLOW,this.editor.elements),1)[0]||(this.editor.createElement("Workflow",0,0,i,!1),this._createAllConnectors([...u,..._]),u=[],_=[]),i={},l={});"package"===t&&this._addPackageProperties(n),this.parser.onerror=e=>{this.parser.error=null,this.parser.resume(),this.emit("xpdl-error",e)}},this.parser.write(this.xml).close(),"Offline"===A.ENV)&&new qi(this.editor.elements).readExtract(this.parser);this.emit("xpdl-parsed")}_extractRealDocumentationInfo(e){var t=is.a.parser(!0,{normalize:!0,trim:!0}),s=qi.extractUnmodifiedInfo(e.text||"",t),i=s.textDoc;return s.otherTags&&(e.text=""),""!==i&&(e.text=i),e}_createAllConnectors(e){e.forEach(e=>{this.editor.createElement(A.CONNECTOR,0,0,e,!1,!1)})}_isElementToBuild(e){return"activity"===e||"pool"===e||"association"===e||"artifact"===e||"datainput"===e||"dataoutput"===e||"datastorereference"===e||"transition"===e}_addArrayProperties(e,t){return void 0===t&&(t=[]),t.push(e),t}_getLaneList(e){return e.filter(e=>this._isLane(e))}_checkCoordinateLane(e,t){if(void 0!==t){var s=parseInt(t.size.height,10)+parseInt(t.y,10)||void 0;if(e.y!==s)return{x:e.x,y:s}}return e}}function Qi(e,t,s,i,a,n,r){try{var o=e[n](r),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(i,a)}function $i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class ea extends me.a{constructor(){super(),this._paper=de("#app"),this._paper.mousedown(this._onPaperClick,this),this._keyManager=new _t(this),this._gridManager=new lt(this,A.GRID_SIZE),this._historyManager=new it(this);var e=document.querySelector("#redo_btn"),t=document.querySelector("#undo_btn");this._historyManager.on("undo",e=>{e?t.setAttribute("data-state","enabled"):t.setAttribute("data-state","disabled")}),this._historyManager.on("redo",t=>{t?e.setAttribute("data-state","enabled"):e.setAttribute("data-state","disabled")}),this._panZoomManager=new be(this,!0),this._panZoomManager.on("zoomed",()=>{this._repositionCtxMenu()}),this._panZoomManager.on("panned",()=>{this._repositionCtxMenu()}),this._poolManager=new at(this),this._laneManager=new nt(this),this._alignManager=new rt(this,this._historyManager),this._clipboardManager=new ot(this,this._historyManager),this._lassoManager=new pt(this),this._connectorManager=new mt(this,this._historyManager),this._boundaryEventsManager=new gt(this),this._boundaryEventsManager.on("boundary_attached",e=>{this.elementSelected&&this.elementSelected.elementType===A.INTERMEDIATE_EVENT&&this._panels.show(A.INTERMEDIATE_EVENT,e)}),this._elementFactory=new qt(this),this._docManager=new ts(this),this._panels=new xi(this),this._panels.on("resize",()=>{}),this._parser=null,this._elements=[],this._connections=[],this._graph=ve()(),this._idIndex=1,this._elementSelected=null,this._firstSelectedElementFromMultiple=null,this._currentlySelectedNumber=0,this._isSnapToGridOn=!0,this._selectedElementFirstMove=!1,this._elementsSelectedToMove=[],this._mode=A.HAND_MODE,this._workflow=null,this._startMarker=null,this._endMarker=null,this._expressionMarker=null,this._wizardMarker=null,this._fileName=null,this._THROTTLE_CONNECTORS_MS=150,this._viewport=this._paper.group(),this._viewport.attr({class:"viewPort"}),this._ctxMenuLayer=this._paper.group(),this._ctxMenuLayer.attr({class:"ctxmenu",id:"ctxMenuLayer"}),this.throttledUpdateConnectors=pe()(this.updateElementConnectors,this._THROTTLE_CONNECTORS_MS)}set idIndex(e){this._idIndex=e}get idIndex(){return this._idIndex}set fileName(e){this._fileName=e}get fileName(){return this._fileName}setTitle(e,t){"Offline"===A.ENV&&(document.title="Apia Facilis ".concat(e," - ").concat(t))}buildEmptyProcess(e="",t="",s="C"){if(this.setTitle(e,t),this.idIndex=1e3,this._clearEditorElements(),this._historyManager.init(),this._panZoomManager.init(),this._gridManager.init(),this.createDefMarkers(),this._parser=null,!this.workflow){var i=this.idIndex++,a={id:i,proAction:s,defaultPool:{id:this.idIndex++,processId:i},packageId:this.idIndex++};this._workflow=this.createElement(A.WORKFLOW,0,0,a,!1,!1)}this._panels.show(A.WORKFLOW,this.workflow)}buildProcess(e,t="",s=""){this.setTitle(t,s),this._clearEditorElements(),this._historyManager.init(),this._panZoomManager.init(),this._gridManager.init(),this.createDefMarkers(),this._parser=new Ji(e,this),this._parser.on("xpdl-error",e=>{}),this._parser.on("xpdl-parsed",()=>{if(this.elements.length>1){var e=$i(ze(A.WORKFLOW,this.elements),1)[0],t=[];t.push(e),this.elements.forEach(e=>{e.elementType!==A.WORKFLOW&&t.push(e)}),this.elements=t}this._panels.show(A.WORKFLOW,this.workflow,"Offline"===A.ENV)}),this._parser.buildProcessMap()}buildXMLProcess(){return this._parser=new Ji("",this),this._parser.buildXmlProcessMap()}set mode(e){e===A.HAND_MODE?(this._lassoManager.enableLasso(!1),this._connectorManager.enableConnection(!1),this._panZoomManager.enablePanning(!0)):e===A.LASSO_MODE?(this._panZoomManager.enablePanning(!1),this._connectorManager.enableConnection(!1),this._lassoManager.enableLasso(!0)):e===A.CONNECTOR_MODE&&(this._lassoManager.enableLasso(!1),this._panZoomManager.enablePanning(!1),this._connectorManager.enableConnection(!0)),this._mode=e}get mode(){return this._mode}get workflow(){return this._workflow}set workflow(e){this._workflow=e}get elements(){return this._elements}set elements(e){this._elements=e}get elementSelected(){return this._elementSelected}createElement(e,t,s,i,a,n){i&&parseInt(i.id,10)>this.idIndex?this.idIndex=parseInt(i.id,10):i||this.idIndex++,void 0===a&&(a=!0);var r=this._elementFactory.createElement(e,this.idIndex,t,s,this._viewport,i,!0);if(r){if(r.elementType===A.CONNECTOR){var o=He(r.properties.from,this.elements),l=He(r.properties.to,this.elements);if(o&&l){var h=5;o.elementType===A.START_EVENT?h=10:l.elementType===A.END_EVENT&&(h=1),this._graph.addNode(r.properties.from),this._graph.addNode(r.properties.to),this._graph.addEdge(r.properties.from,r.properties.to,h)}}return r.on("element_mouse_down",e=>{this._currentlySelectedNumber=Re(this._elements),e.shiftKey||0!==this._currentlySelectedNumber||(r.selected=!0,this._currentlySelectedNumber=1),!e.shiftKey&&!r.selected&&this._currentlySelectedNumber>=1&&(this.unSelectAllElements(),r.selected=!0,this._currentlySelectedNumber=1),e.shiftKey&&this._currentlySelectedNumber>=0&&this.mode!==A.CONNECTOR_MODE&&(r.selected?(r.selected=!1,this._currentlySelectedNumber--):(r.selected=!0,this._currentlySelectedNumber++))}),r.on("element_move_start",()=>{this._currentlySelectedNumber>1&&r.selected?this._moveStartMultipleSelection(r):1===this._currentlySelectedNumber&&r.selected&&(this._poolManager.moveStart(r),this._boundaryEventsManager.moveStart(r)),this._connectorManager.connect(r),this._selectedElementFirstMove=!0}),r.on("element_moving",()=>{!0===this._selectedElementFirstMove&&(r._contextMenu.hide(),this._historyManager.save()),this._selectedElementFirstMove=!1,1===this._currentlySelectedNumber&&(this._poolManager.moving(r),this._boundaryEventsManager.moving(r)),this._currentlySelectedNumber>1&&r.selected&&this._moveMultipleSelection(r),this.throttledUpdateConnectors(r)}),r.on("element_move_end",()=>{this._currentlySelectedNumber>1&&r.selected?(this._moveEndMultipleSelection(r),r._contextMenu.hide()):1===this._currentlySelectedNumber&&(this._poolManager.moveEnd(r),this._boundaryEventsManager.moveEnd(r),this._mode===A.CONNECTOR_MODE?r._contextMenu.hide():r._contextMenu.show())}),r.on("element_no_move_end",()=>{1===this._currentlySelectedNumber&&r.selected&&(this._poolManager.noMoveEnd(r),this._boundaryEventsManager.noMoveEnd(r),this._mode===A.CONNECTOR_MODE?r._contextMenu.hide():r._contextMenu.show())}),r.on("element_snap_to_grid",()=>{this.updateElementConnectors(r)}),r.on("element_deleted",()=>{r.elementType===A.LANE&&this._laneManager.onLaneDeleted(r),r.elementType===A.POOL&&this._poolManager.onElementDelete(r),this._elementSelected=null,this._panels.hide(r.elementType),this._panels.show(A.WORKFLOW,this.workflow),this._connectorManager.reset()}),r.on("element_on_remove_button_clicked",()=>{this._deleteElement(r)}),r.on("element_onpropertychange",()=>{this._historyManager.save()}),r.on("connector_point_move_start",()=>{this._historyManager.save(),r._contextMenu.hide()}),r.on("connector_point_move_end",()=>{1===Re(this._elements)&&r._contextMenu.show()}),r.on("connector_point_no_move_end",()=>{1===Re(this._elements)&&r._contextMenu.show()}),r.on("connector_point_new",()=>{this._historyManager.save()}),r.on("connector_point_deleted",()=>{this._historyManager.save()}),r.on("element_selected",()=>{if(1===Re(this._elements))this._elementSelected=r,this._firstSelectedElementFromMultiple=r,this._panels.show(r.elementType,r),this._panels.hide(A.WORKFLOW),this._mode!==A.CONNECTOR_MODE&&r._contextMenu.show();else if(Re(this._elements)>1){this._firstSelectedElementFromMultiple&&this._panels.hide(this._firstSelectedElementFromMultiple.elementType),this._panels.hide(A.WORKFLOW);for(var e=De(this._elements),t=0,s=e.length;t<s;++t)e[t].elementType!==A.WORKFLOW&&e[t]._contextMenu.hide()}else 0===Re(this._elements)&&(this._panels.hide(this._firstSelectedElementFromMultiple.elementType),this._panels.show(A.WORKFLOW,this.workflow))}),r.on("element_unselected",()=>{r._contextMenu.hide(),this._elementSelected=null,this._panels.hide(r.elementType)}),r.on("lane_resize_start",()=>{this._historyManager.save(),this._laneManager.resizeStart(r)}),r.on("lane_resizing",e=>{this._laneManager.resize(r,e)}),r.on("lane_resize_end",()=>{this._laneManager.resizeEnd(r),this._mode!==A.CONNECTOR_MODE&&r._contextMenu.show()}),r.on("element_resize_start",()=>{this._historyManager.save(),r.elementType===A.POOL&&this._poolManager.onResizeStart(),r.elementType!==A.TEXT&&r.elementType!==A.GROUP||r.onResizingStart()}),r.on("element_resizing",(e,t)=>{r.elementType===A.POOL&&this._poolManager.onResize(r,e,t),r.elementType!==A.TEXT&&r.elementType!==A.GROUP||(r.onResizing(e,t),this.updateElementConnectors(r))}),r.on("element_resize_end",()=>{r.elementType===A.POOL&&(this._mode!==A.CONNECTOR_MODE&&r._contextMenu.show(),this._poolManager.onResizeEnd(),this.updateElementConnectors(r)),r.elementType!==A.TEXT&&r.elementType!==A.GROUP||(this._mode!==A.CONNECTOR_MODE&&r._contextMenu.show(),r.onResizeEnd())}),r.on("element_on_connect_button",()=>{r._contextMenu.hide(),this._connectorManager.connectOneTime(r)}),r.on("element_on_open_subprocess",()=>{this._openSubprocess(r),"Offline"!==A.ENV&&this._openProcessInNewTab(r)}),r.on("process_name_changed",()=>{this.fileName=this.workflow.name}),r.on("element_on_append",e=>{var t,s=0,i=0,a=0,n=r.selectionBox.node.getBoundingClientRect(),o=this._viewport.getInverseScreenPoint(n.right,n.bottom),l=this._viewport.getInverseScreenPoint(n.left,n.top),h=$e(r,this.elements);if(h){var c=this._viewport.getInverseScreenPoint(h.left,h.bottom);s=c.x,i=c.y,a=60}else s=o.x+70,a=Math.round(l.y+r.height/2);switch(e){case A.TASK:case A.SUBPROCESS:t=this.createElement(e,s,a-A.TASK_SIZE.height/2+i);break;case A.GATEWAY:case A.START_EVENT:case A.INTERMEDIATE_EVENT:case A.END_EVENT:t=this.createElement(e,s,a-A.GATEWAY_SIZE.height/2+i);break;case A.TEXT:t=this.createElement(A.TEXT,s,l.y-2*A.TEXT_SIZE.height);break;case A.LANE:this._historyManager.save(),t=this._laneManager.createLane(r),r.removeResizeHandles(),r.drawResizeHandles()}if(e!==A.LANE&&e!==A.CONNECTOR){var p,d;t.elementType===A.TEXT?(p=A.CONNECTOR_TYPE_ASSOCIATION,d=[{x:0,y:0},{x:0,y:0}]):(p=A.CONNECTOR_TYPE_TRANSITION,d=h?[{x:0,y:0},{x:r.x+r.width/2-A.ELEMENT_SELECT_SIZE/2,y:t.y+t.height/2-A.ELEMENT_SELECT_SIZE/2},{x:0,y:0}]:[{x:0,y:0},{x:0,y:0}]);var u={id:++this.idIndex,from:r.id,to:t.id,type:p,points:d};p===A.CONNECTOR_TYPE_ASSOCIATION&&(u.direction="none"),p===A.CONNECTOR_TYPE_TRANSITION&&(u.class="N"),this.createElement(A.CONNECTOR,null,null,u,!1,!1),this.unSelectAllElements(),t.selected=!0}}),r.elementType!==A.WORKFLOW&&r.snap(this._isSnapToGridOn,A.GRID_SIZE),a&&this._historyManager.save(),this._boundaryEventsManager.moveEnd(r),r.elementType===A.CONNECTOR&&this._connections.push(r),this._elements.push(r),1===Re(this._elements)?r.selected&&this._elementSelected?(this._panels.hide(this._elementSelected.elementType),this._elementSelected=r,this._panels.show(r.elementType,r)):r.selected&&(this._elementSelected=r,this._panels.hide(A.WORKFLOW),this._panels.show(r.elementType,r)):this._elementSelected?(this._panels.hide(this._elementSelected.elementType),this._elementSelected=null,this._panels.show(A.WORKFLOW,this.workflow)):Re(this._elements)>1&&this._panels.hide(r.elementType),n&&(this.unSelectAllElements(),r.selected=!0,this._elementSelected=r),r}}createDefMarkers(){var e=this._paper.polyline("0,8, 4,0, 8,8").attr({class:"arrow_marker"}).transform("r-90");this._startMarker=e.marker(0,0,10,10,1,4);var t=this._paper.polyline("0,8, 4,0, 8,8").attr({class:"arrow_marker"}).transform("r90");this._endMarker=t.marker(0,0,10,10,7,4);var s=this._paper.polygon(5,0,0,5,5,10,10,5).attr({class:"expression_marker"});this._expressionMarker=s.marker(0,0,10,10,0,5);var i=this._paper.polyline("0,8, 4,0, 8,8, 4,8, 12,24, -4,24, 4,8, 0,8").attr({class:"arrow_marker"}).transform("r90");this._wizardMarker=i.marker(0,0,40,40,15,12)}_onPaperClick(e){"app"===e.target.id&&(this.unSelectAllElements(),this._panels.show(A.WORKFLOW,this.workflow))}_repositionCtxMenu(){var e=De(this.elements);1===e.length&&e[0]._contextMenu.show()}unSelectAllElements(){for(var e=0,t=this._elements.length;e<t;e++)this._elements[e].selected=!1;this._elementSelected=null}selectAllElements(){for(var e=0,t=this._elements.length;e<t;e++)this._elements[e].elementType!==A.WORKFLOW&&(this._elements[e].selected=!0)}_moveStartMultipleSelection(e){e.elementType===A.POOL?this._poolManager.moveStart(e):this._elementsSelectedToMove=De(this.elements)}_moveMultipleSelection(e){var t,s;if(e.elementType===A.POOL)this._poolManager.moving(e);else for(var i=0,a=this._elementsSelectedToMove.length;i<a;i++)if(s=(t=this._elementsSelectedToMove[i]).elementType,t.selected&&s!==A.LANE&&s!==A.POOL&&s!==A.CONNECTOR&&t.id!==e.id?(t._contextMenu.hide(),this._updateElementPosition(t,e)):this._elementsSelectedToMove.some(e=>e.elementType===A.POOL)&&s===A.LANE&&s===A.POOL&&t.id!==e.id?t._contextMenu.hide():t.selected&&s===A.CONNECTOR&&this._updatePointSegments(t,e),t.selected&&s===A.TASK&&t.id!==e.id)for(var n=0,r=t.boundaryEvents.length;n<r;n++){var o=He(t.boundaryEvents[n],this._elements);o.selected||this._updateElementPosition(o,e)}}_moveEndMultipleSelection(e){var t,s;if(e.elementType===A.POOL)this._poolManager.moveEnd(e);else for(var i=0,a=this._elementsSelectedToMove.length;i<a;i++)if(s=(t=this._elementsSelectedToMove[i]).elementType,t.selected&&s!==A.LANE&&s!==A.POOL&&s!==A.CONNECTOR?this._updateElementEndPosition(t,e):this._elementsSelectedToMove.some(e=>e.elementType===A.POOL)&&s===A.LANE&&s===A.POOL?this.toggleElementConnectorsVisibility(!0):t.selected&&s===A.CONNECTOR&&t.resetMovingPointSegment(),t.selected&&s===A.TASK)for(var n=0,r=t.boundaryEvents.length;n<r;n++){var o=He(t.boundaryEvents[n],this._elements);o.selected||this._updateElementEndPosition(o,e)}this._elementsSelectedToMove=[]}_updatePointSegments(e,t){e.updateSegmentsPosition(t)}_updateElementPosition(e,t){e.moveElement(Math.round(t.mx+e.x),Math.round(t.my+e.y)),this.updateElementConnectors(e)}_updateElementEndPosition(e,t){e.moveElementEnd(Math.round(t.mx+e.x),Math.round(t.my+e.y))}updateElementConnectors(e,t={x:0,y:0},s=!1,i=!1){for(var a=e.properties.id,n=0,r=this._connections.length;n<r;++n){var o=this._connections[n].properties;parseInt(o.from,10)!==parseInt(a,10)&&parseInt(o.to,10)!==parseInt(a,10)||(s?this._connections[n].updateConnectionStart():this._connections[n].updateConnection(t,i))}}toggleElementConnectorsVisibility(e){for(var t=0,s=this._connections.length;t<s;++t)e?this._connections[t].graphic.removeClass("connector--hidden"):this._connections[t].graphic.addClass("connector--hidden")}_deleteElement(e,t=!0){for(var s=0,i=this._elements.length;s<i;s++)if(this._elements[s]===e){if(t&&this._historyManager.save(),this._elements.splice(s,1),this._graph.removeNode(e.id),this._deleteAttachedConnectors(e),e.elementType===A.TASK)for(var a=0,n=e.boundaryEvents.length;a<n;a++){var r=He(e.boundaryEvents[a],this._elements);this._deleteElement(r,!1)}e.deleteEl(),e.elementType===A.CONNECTOR&&this._deleteFromConnectorsList(e)}}_deleteAttachedConnectors(e){for(var t=e.properties.id,s=this._connections.length;s--;)if(this._connections[s].properties.from===t||this._connections[s].properties.to===t){var i=this._connections[s];this._graph.removeEdge(this._connections[s].properties.from,this._connections[s].properties.to),this._connections.splice(s,1);for(var a=this._elements.length;a--;)this._elements[a]===i&&this._elements.splice(a,1);i.deleteEl()}}_deleteFromConnectorsList(e){for(var t=0,s=this._connections.length;t<s;t++)this._connections[t]===e&&this._connections.splice(t,1)}deleteMultipleSelectedElements(){this._historyManager.save();for(var e=this._elements.length;e--;)if(this._elements[e]&&this._elements[e].selected){var t=this._elements[e];this._deleteElement(t,!1),this._graph.removeNode(t.id)}}zoomIn(){this._panZoomManager.zoomIn()}zoomOut(){this._panZoomManager.zoomOut()}resetView(){this._panZoomManager.resetViewPort(),this._repositionCtxMenu()}undoAction(){this._historyManager.undo()}redoAction(){this._historyManager.redo()}alignSelectionLeft(){this._alignManager.alignLeft()}alignSelectionRight(){this._alignManager.alignRight()}alignSelectionTop(){this._alignManager.alignTop()}alignSelectionBottom(){this._alignManager.alignBottom()}alignSelectionHorizontal(){this._alignManager.alignHorizontalCenter(De(this.elements),!0)}alignSelectionVertical(){this._alignManager.alignVerticalCenter()}distSelectionHorizontal(){this._alignManager.distHorizontal()}distSelectionVertical(){this._alignManager.distVertical()}copyElements(){this._clipboardManager.copy()}pasteElements(){this._clipboardManager.paste()}showGrid(e){e?this._gridManager.show():this._gridManager.hide()}snapToGrid(e){this._isSnapToGridOn=e}_clearEditorElements(){for(var e=this._viewport.children(),t=0,s=e.length;t<s;t++){var i=e[t];i.hasClass("grid_bg")||i.remove()}this._ctxMenuLayer.clear(),this._elements=[],this._connections=[],this._graph=ve()(),this._workflow=null}doTabProcessElements(){var e=De(this.elements)[0]||this.elements[0],t=this._graph.topologicalSort(),s=t.findIndex(t=>parseInt(t,10)===parseInt(e.id,10));++s===t.length&&(s=0),He(e.id,this.elements).selected=!1,He(parseInt(t[s],10),this.elements).selected=!0,He(parseInt(t[s],10),this.elements).toFront()}loadLocalXPDL(e){var t=e.target.files;if(t[0]){var s=new FileReader;s.readAsText(t[0],"UTF-8"),s.onload=e=>{this.buildProcess(e.target.result)},s.onerror=()=>{}}}saveLocalXPDL(){this._docManager.generateXPDLFile()}saveToPDF(){this._docManager.generateProcessDocumentation()}getPDF(){return this._docManager.generateProcessDocumentation()}saveToImage(){this._docManager.generateProcessPNG()}getPNGData(){var e,t=this;return(e=function*(){return yield t._docManager.getPNGDataURL()},function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function r(e){Qi(n,i,a,r,o,"next",e)}function o(e){Qi(n,i,a,r,o,"throw",e)}r(void 0)}))})()}_openSubprocess(e){this.emit("editor_on_open_subprocess",e.properties)}_openProcessInNewTab(e){if(e&&"Offline"!==A.ENV){var t=e.properties.activitySetId||e.properties.subprocessId;if(1!==t&&"default_process"!==e.name.toLowerCase()){var s=window.top.tabContainer,i=A.SUBPROCESS_OPEN_NEW_TAB_URL,a=$i(A.TAB_KEYS.split("&tokenId="),2)[1],n=Date.now(),r="".concat(i,"&tokenId=").concat(a,"&tabId=").concat(n,"&id=").concat(t,"_0");s.addNewTab(e.name,r,null)}}}}class ta extends me.a{constructor(e){super(),this._editor=e,document.getElementById("undo_btn").addEventListener("click",()=>{e.undoAction()},!1),document.getElementById("redo_btn").addEventListener("click",()=>{e.redoAction()},!1),document.getElementById("align_left_btn").addEventListener("click",()=>{e.alignSelectionLeft()},!1),document.getElementById("align_right_btn").addEventListener("click",()=>{e.alignSelectionRight()},!1),document.getElementById("align_top_btn").addEventListener("click",()=>{e.alignSelectionTop()},!1),document.getElementById("align_bottom_btn").addEventListener("click",()=>{e.alignSelectionBottom()},!1),document.getElementById("align_horizontal_btn").addEventListener("click",()=>{e.alignSelectionHorizontal()},!1),document.getElementById("align_vertical_btn").addEventListener("click",()=>{e.alignSelectionVertical()},!1),document.getElementById("dist_horizontal_btn").addEventListener("click",()=>{e.distSelectionHorizontal()},!1),document.getElementById("dist_vertical_btn").addEventListener("click",()=>{e.distSelectionVertical()},!1),document.getElementById("grid_btn").addEventListener("click",t=>{var s=t.currentTarget;s.setAttribute("data-state","on"===s.getAttribute("data-state")?"off":"on"),"on"===s.getAttribute("data-state")?e.showGrid(!0):e.showGrid(!1)})}}class sa{constructor(e){this._editor=e,this._isDraggingElement=!1,this._toolBarClone=null,this._onToolBarElMouseMove=this._onToolBarElMouseMove.bind(this),this._onToolBarElMouseUp=this._onToolBarElMouseUp.bind(this),this._onToolBarElMouseDown=this._onToolBarElMouseDown.bind(this),document.addEventListener("dragstart",e=>{this._onToolDragStart(e)},!1),document.addEventListener("drop",e=>{this._onToolDrop(e)}),document.addEventListener("dragover",e=>{e.preventDefault(),this._onToolDragOver(e)},!1),document.addEventListener("dragover",e=>{e.preventDefault()}),document.getElementById("task_btn").addEventListener("click",e=>{this._clickToolbarElement(e,A.TASK)},!1),document.getElementById("task_btn").draggable=!0,document.getElementById("start_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.START_EVENT)},!1),document.getElementById("start_btn").draggable=!0,document.getElementById("end_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.END_EVENT)},!1),document.getElementById("end_btn").draggable=!0,document.getElementById("intermediate_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.INTERMEDIATE_EVENT)},!1),document.getElementById("intermediate_btn").draggable=!0,document.getElementById("gateway_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.GATEWAY)},!1),document.getElementById("gateway_btn").draggable=!0,document.getElementById("subprocess_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.SUBPROCESS)},!1),document.getElementById("subprocess_btn").draggable=!0,document.getElementById("pool_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.POOL)},!1),document.getElementById("pool_btn").draggable=!0,document.getElementById("group_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.GROUP)},!1),document.getElementById("group_btn").draggable=!0,document.getElementById("data_obj_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.DATA_OBJECT)},!1),document.getElementById("data_obj_btn").draggable=!0,document.getElementById("data_store_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.DATA_STORE)},!1),document.getElementById("data_store_btn").draggable=!0,document.getElementById("data_input_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.DATA_INPUT)},!1),document.getElementById("data_input_btn").draggable=!0,document.getElementById("data_output_btn").addEventListener("click",()=>{this._clickToolbarElement(event,A.DATA_OUTPUT)},!1),document.getElementById("data_output_btn").draggable=!0,document.getElementById("hand_btn").addEventListener("click",t=>{var s=t.currentTarget,i=document.querySelector("#connector_btn");document.querySelector("#lasso_btn").setAttribute("data-state","off"),i.setAttribute("data-state","off"),s.setAttribute("data-state","on"),e.mode=A.HAND_MODE},!1),document.getElementById("lasso_btn").addEventListener("click",t=>{var s=t.currentTarget,i=document.querySelector("#hand_btn"),a=document.querySelector("#connector_btn");i.setAttribute("data-state","off"),a.setAttribute("data-state","off"),s.setAttribute("data-state","on"),e.mode=A.LASSO_MODE},!1),document.getElementById("connector_btn").addEventListener("click",t=>{var s=t.currentTarget,i=document.querySelector("#hand_btn");document.querySelector("#lasso_btn").setAttribute("data-state","off"),i.setAttribute("data-state","off"),s.setAttribute("data-state","on"),e.mode=A.CONNECTOR_MODE},!1),document.getElementById("zoom_in").addEventListener("click",()=>{e.zoomIn()},!1),document.getElementById("zoom_out").addEventListener("click",()=>{e.zoomOut()},!1),document.getElementById("reset_view").addEventListener("click",()=>{e.resetView()},!1)}_clickToolbarElement(e,t){this._isDraggingElement||(this._isDraggingElement=!0,e.target.blur(),e.target.style="opacity: 0.7",this._toolBarClone=document.body.appendChild(this._cloneWithStyles(e.target)),this._toolBarClone.style.position="absolute",this._toolBarClone.style.left="".concat(e.clientX-e.target.offsetWidth/2,"px"),this._toolBarClone.style.top="".concat(e.clientY-e.target.offsetHeight/2,"px"),document.elementType=t,e.target.style="opacity: 1",this._giveVisualClueIfDropNotOK(t),document.addEventListener("mouseup",this._onToolBarElMouseUp),document.addEventListener("mousedown",this._onToolBarElMouseDown),document.addEventListener("mousemove",this._onToolBarElMouseMove),ut.a.bind("esc",e=>{"BODY"!==e.target.tagName&&"A"!==e.target.tagName||(this._toolbarDraggingDone(),e.preventDefault())}))}_onToolDragStart(e){var t=null;switch(e.target.style="opacity: 0.7;",e.target.id){case"task_btn":t=A.TASK;break;case"end_btn":t=A.END_EVENT;break;case"start_btn":t=A.START_EVENT;break;case"intermediate_btn":t=A.INTERMEDIATE_EVENT;break;case"gateway_btn":t=A.GATEWAY;break;case"subprocess_btn":t=A.SUBPROCESS;break;case"pool_btn":t=A.POOL;break;case"group_btn":t=A.GROUP;break;case"data_obj_btn":t=A.DATA_OBJECT;break;case"data_store_btn":t=A.DATA_STORE;break;case"data_input_btn":t=A.DATA_INPUT;break;case"data_output_btn":t=A.DATA_OUTPUT}this._dataType=t,this._dragBtnId=e.target.id}_onToolDragOver(){this._giveVisualClueIfDropNotOK(this._dataType)}_onToolDrop(e){e.preventDefault(),document.getElementById(this._dragBtnId).style="opacity: 1;";var t=this._editor._viewport.getInverseScreenPoint(e.clientX,e.clientY),s=this._getElementPosition(t,this._dataType);this._validateCreate(this._dataType)&&this._isDropZoneOk(document.elementFromPoint(e.clientX,e.clientY),e.currentTarget.elementType)&&this._editor.createElement(this._dataType,s.x,s.y,null,!0,!0),this._editor._paper.removeClass("dragging_element"),this._editor._paper.removeClass("dragging_element_not_allowed")}_onToolBarElMouseDown(){}_onToolBarElMouseMove(e){this._toolBarClone.style.left="".concat(e.clientX-parseInt(this._toolBarClone.style.width,10)/2,"px"),this._toolBarClone.style.top="".concat(e.clientY-parseInt(this._toolBarClone.style.height,10)/2,"px")}_onToolBarElMouseUp(){var e=this._editor._viewport.getInverseScreenPoint(event.clientX,event.clientY),t=this._getElementPosition(e,event.currentTarget.elementType);this._toolbarDraggingDone(),this._validateCreate(event.currentTarget.elementType)&&this._isDropZoneOk(document.elementFromPoint(event.clientX,event.clientY),event.currentTarget.elementType)&&this._editor.createElement(event.currentTarget.elementType,t.x,t.y,null,!0,!0)}_toolbarDraggingDone(){this._isDraggingElement=!1,this._toolBarClone.remove(),document.removeEventListener("mousemove",this._onToolBarElMouseMove),document.removeEventListener("mouseup",this._onToolBarElMouseUp),document.removeEventListener("mousedown",this._onToolBarElMouseDown),ut.a.unbind("esc"),this._editor._paper.removeClass("dragging_element"),this._editor._paper.removeClass("dragging_element_not_allowed")}_giveVisualClueIfDropNotOK(e){switch(e){case A.START_EVENT:ze(A.START_EVENT,this._editor.elements).length>0?this._editor._paper.addClass("dragging_element_not_allowed"):this._editor._paper.addClass("dragging_element");break;case A.POOL:ze(A.POOL,this._editor.elements).length>0?this._editor._paper.addClass("dragging_element_not_allowed"):this._editor._paper.addClass("dragging_element");break;default:this._editor._paper.addClass("dragging_element")}}_getElementPosition(e,t){var s,i;switch(t){case A.TASK:case A.SUBPROCESS:s=e.x-A.TASK_SIZE.width/2,i=e.y-A.TASK_SIZE.height/2;break;case A.GATEWAY:s=e.x-A.GATEWAY_SIZE.width/2,i=e.y-A.GATEWAY_SIZE.height/2;break;case A.START_EVENT:case A.INTERMEDIATE_EVENT:case A.END_EVENT:s=e.x-A.EVENT_SIZE.radius,i=e.y-A.EVENT_SIZE.radius;break;case A.DATA_OBJECT:case A.DATA_INPUT:case A.DATA_OUTPUT:case A.DATA_STORE:s=e.x-A.DATA_SIZE.width/2,i=e.y-A.DATA_SIZE.height/2;break;case A.POOL:var a=Ke(this._editor._viewport);a.x===Number.POSITIVE_INFINITY?(s=200,i=200):(s=a.x-80,i=a.y-40);break;case A.GROUP:s=e.x-A.GROUP_SIZE.width/2,i=e.y-A.GROUP_SIZE.height/2;break;case A.TEXT:s=e.x-A.TEXT_SIZE.width/2,i=e.y-A.TEXT_SIZE.height/2}return{x:s,y:i}}_cloneWithStyles(e){var t=e.cloneNode(!0),s=window.getComputedStyle(e);if(""!==s.cssText)t.style.cssText=s.cssText;else{var i=Object.values(s).reduce((e,t)=>"".concat(e).concat(t,":").concat(s.getPropertyValue(t),";"));t.style.cssText=i}return t}_isDropZoneOk(e,t){return"app"===e.id||!(t!==A.INTERMEDIATE_EVENT||!e.closest(".task"))}_validateCreate(e){var t=!1;switch(e){case A.START_EVENT:t=!(ze(A.START_EVENT,this._editor.elements).length>0);break;case A.POOL:t=!(ze(A.POOL,this._editor.elements).length>0);break;default:t=!0}return t}}var ia=s("sYyW"),aa=s.n(ia);w.b.add(O.faUndo,D.faRedo,R.faTh,B.faVectorSquare,oe.faHandPointer,V.faSearchPlus,F.faSearchMinus,U.faSearch,W.faPlus,H.faArrowUp,z.faArrowDown,J.faTasks,j.faTimes,te.faCheckSquare,se.faSquare,q.faQuestion,ie.faKeyboard,Y.faPen,G.faInfoCircle,K.faCheckCircle,Z.faExclamationTriangle,X.faExclamationCircle,Q.faGripLinesVertical,ae.faTrashAlt,re.faCalendarAlt,ne.faClock,$.faSave,ee.faCrosshairs),w.a.watch(),document.addEventListener("DOMContentLoaded",()=>{var e,t=x.a.init(M.a);M.a.use(N.a).init({backend:{loadPath:A.LOCALIZATION_URL,crossDomain:!0},lng:"en",fallbackLng:"en",debug:A.LOCALIZATION_DEBUG},s=>{if(t("[data-i18n]"),(e=new ea).on("editor_on_open_subprocess",e=>{}),new sa(e),new ta(e),k.a.init(),"Development"===A.ENV){he.a.get("http://".concat("127.0.0.1",":3000/").concat("gestion-cambios-doc/xpdl")).then(t=>{e.buildProcess(t.data)})}else{var i=window.parent.document.getElementById("txtMap").innerText;if(""===i){var a=window.parent.document.getElementById("cmbAction"),n=a?a.value:"C";e.buildEmptyProcess(null,null,n)}else e.buildProcess(i)}});var s={loadXPDL(t){e.buildProcess(t)},newXPDL(){e.buildEmptyProcess()},getXPDL:()=>e.buildXMLProcess(),getPDF(){e.saveToPDF()},getPNG(){e.saveToImage()},getElements:()=>e.elements,getElementsProperties:()=>e.elements.map(e=>e.properties),getSelectedElement(){for(var t=0,s=e.elements.length;t<s;t++){var i=e.elements[t];if(i.selected)return i}return!1},getSelectedElementProperties(){for(var t=0,s=e.elements.length;t<s;t++){var i=e.elements[t];if(i.selected)return i.properties}return!1},getVersion:()=>({version:"ONLINE_STABLE_2021_02_05-16-ge7439c56",commit:"e7439c56c7eb5afde5a50195928786e4dff9afad",branch:"master",env:"production",app_target:"online",timestamp:"Thu Apr 08 2021 15:03:16 GMT-0300 (GMT-03:00)",package:"1.4.20"})};window.top.map=s;var i=window.parent.document.querySelector("#btnConf button"),a=window.parent.document.querySelector("#btnGenDoc button");if(i&&"Production"===A.ENV){var n=window.parent.document.getElementById("txtMap");i.addEventListener("click",()=>{n.value=s.getXPDL()}),a.addEventListener("click",()=>{s.getPDF()})}document.querySelector(".modal__footer").innerText="Build: ".concat("ONLINE_STABLE_2021_02_05-16-ge7439c56".substr(-8))}),window.addEventListener("load",()=>{var e=document.querySelector(".main");document.querySelector(".spinner").style.display="none",aa.a.test(navigator.userAgent)?e.setAttribute("data-state","on"):alert(M.a.t("messages.proDesBrowserNotSupportedMsg"))})}},[["tjUo",1,2]]]);
//# sourceMappingURL=index.js.map